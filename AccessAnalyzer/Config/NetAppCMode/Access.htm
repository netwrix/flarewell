<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>NetApp Data ONTAP Cluster-Mode Access &amp; Sensitive Data Auditing Configuration</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../EnterpriseAuditor/Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>NetApp Data ONTAP Cluster-Mode Access &amp; Sensitive Data Auditing Configuration</h1>
                                        <p>This topic provides instructions for configuring  NetApp Data ONTAP Cluster-Mode devices. </p>
                                        <h2><a name="CIFS2"></a>CIFS Method 1 Credential Configuration</h2>
                                        <p>Configuring access to CIFS&#160;shares using FPolicy and ONTAP&#160;API&#160;for <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> requires the following:</p>
                                        <ul>
                                            <li>
                                                <p>Configure Data LIF&#160;to Allow HTTPS&#160;Traffic</p>
                                            </li>
                                            <li>
                                                <p><a href="ConfigureEmptyFPolicy.htm" title="Configure Empty FPolicy" alt="Configure Empty FPolicy" target="_parent" class="MCXref xref">Configure Empty FPolicy</a>
                                                </p>
                                            </li>
                                        </ul>
                                        <p>See the <a href="#CIFS" target="_parent" title="CIFS Method 2 Credential Configuration" alt="CIFS Method 2 Credential Configuration" class="MCXref xref">CIFS Method 2 Credential Configuration</a> topic for an alternative method.</p>
                                        <h3>Configure Data LIF&#160;to Allow HTTPS&#160;Traffic</h3>
                                        <p>As of NetApp Clustered ONTAP 9.6, users can assign service policies (instead of LIF roles) to LIFs that determine the kind of traffic that is supported for the LIFs.</p>
                                        <ul>
                                            <li>
                                                <p>Starting with ONTAP 9.5, ONTAP supports service policies</p>
                                            </li>
                                            <li>
                                                <p>Starting with ONTAP 9.6, LIF roles are deprecated and service policies are supported for all types of services</p>
                                            </li>
                                        </ul>
                                        <p>For users running ONTAP 9.6+, data LIFs used for HTTPS communication with <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> are required to use a LIF service policy that includes the <code style="font-family: 'Courier New';">management-https</code> service. Without this service applied to a data LIF’s service policy, HTTPS communication will not be possible.</p>
                                        <p>The following examples offer guidance for managing service policies, but may vary depending on the NetApp environment’s specific configuration and needs.</p>
                                        <p>Use the following command to display available services:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>network interface service show</code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following command to create a service policy (example includes NFS, CIFS, and HTTPS traffic):</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>network interface service<span style="color: #000000; ">-</span>policy create <span style="color: #000000; ">-</span>vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> <span style="color: #000000; ">-</span>policy <span style="color: #000000; ">[</span>SERVICE_POLICY_NAME<span style="color: #000000; ">]</span> <span style="color: #000000; ">-</span>services <span style="color: #000000; ">[</span>LIST_OF_SERVICES_COMMA<span style="color: #000000; ">-</span>SEPARARTED<span style="color: #000000; ">]</span> <span style="color: #000000; ">-</span>allowed<span style="color: #000000; ">-</span>addresses <span style="color: #000000; ">[</span>IP_CIDR_NOTATION<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p class="Bold_Subheading">Example with the NFS, CIFS, and HTTPS protocols being allowed:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>network interface service<span style="color: #000000; ">-</span>policy create <span style="color: #000000; ">-</span>vserver testserver <span style="color: #000000; ">-</span>policy new_service_policy <span style="color: #000000; ">-</span>services data<span style="color: #000000; ">-</span>nfx<span style="color: #000000; ">,</span>data<span style="color: #000000; ">-</span>cifs<span style="color: #000000; ">,</span>management<span style="color: #000000; ">-</span>https<span style="color: #000000; ">,</span>data<span style="color: #000000; ">-</span>core <span style="color: #000000; ">-</span>allowed<span style="color: #000000; ">-</span>addresses <span style="color: #df5000; ">0.0</span><span style="color: #000000; ">.</span><span style="color: #df5000; ">0.0</span><span style="color: #000000; ">/</span><span style="color: #df5000; ">0</span></code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following command to verify if the service policy was properly created:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>network interface service<span style="color: #000000; ">-</span>policy show</code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following command to add the created service policy to an existing data LIF:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>network interface modify <span style="color: #000000; ">-</span>vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> <span style="color: #000000; ">-</span>lif <span style="color: #000000; ">[</span>LIF_NAME<span style="color: #000000; ">]</span> <span style="color: #000000; ">-</span>service<span style="color: #000000; ">-</span>policy <span style="color: #000000; ">[</span>SERVICE_POLICY_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p class="Bold_Subheading">Example:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>network interface modify <span style="color: #000000; ">-</span>vserver testserver <span style="color: #000000; ">-</span>lif lif_1 <span style="color: #000000; ">-</span>service<span style="color: #000000; ">-</span>policy new_service_policy</code></pre>
                                            </div>
                                        </div>
                                        <p>A service policy can only be used by LIFs in the same SVM that is specified when creating the service policy.</p>
                                        <h2><a name="CIFS"></a>CIFS Method 2 Credential Configuration</h2>
                                        <p>Configuring access to CIFS shares using the special C$ share is an alternative least privileged access option for NetApp Data ONTAP Cluster-Mode devices v9.0+. See the <a href="#CIFS2" target="_parent" title="CIFS Method 1 Credential Configuration" alt="CIFS Method 1 Credential Configuration" class="MCXref xref">CIFS Method 1 Credential Configuration</a> topic for an alternative method.</p>
                                        <p>The following permissions are required:</p>
                                        <ul>
                                            <li>
                                                <p>Group membership in the Backup Operators group on either the file system proxy server for Proxy Mode scans or the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> server for Local Mode scans (to get a high integrity token)</p>
                                            </li>
                                            <li>
                                                <p>Group membership in the NetApp SVM's Power Users group (to enumerate shares)</p>
                                                <ul>
                                                    <li>
                                                        <p>Use the following command to add the Service Account to BUILTIN\Power Users:</p>
                                                        <div class="codeSnippet">
                                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs users<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">and</span><span style="color: #000000; ">-</span>groups local<span style="color: #000000; ">-</span>group add<span style="color: #000000; ">-</span>members &#8209;group<span style="color: #000000; ">-</span>name <span style="color: #df5000; ">"BUILTIN\Power Users"</span> &#8209;member<span style="color: #000000; ">-</span>names <span style="color: #000000; ">[</span>DOMAIN_USER<span style="color: #000000; ">]</span> &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span></code></pre>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>Group membership in the NetApp SVM's Backup Operators group (to bypass NTFS permissions)</p>
                                                <ul>
                                                    <li>
                                                        <p>NetApp SVM's SeBackupPrivilege needs to be applied to this group</p>
                                                    </li>
                                                    <li>
                                                        <p>This group must have read-only access to the SVM's C$ share</p>
                                                    </li>
                                                    <li>
                                                        <p>Use the following command to add the Service Account to BUILTIN\Backup Operators:</p>
                                                        <div class="codeSnippet">
                                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs users<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">and</span><span style="color: #000000; ">-</span>groups local<span style="color: #000000; ">-</span>group add<span style="color: #000000; ">-</span>members &#8209;group<span style="color: #000000; ">-</span>name <span style="color: #df5000; ">"BUILTIN\Backup Operators"</span> &#8209;member<span style="color: #000000; ">-</span>names <span style="color: #000000; ">[</span>DOMAIN_USER<span style="color: #000000; ">]</span> &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span></code></pre>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p>If an ACE does not already exist for a specific user/group on an SVM's c$ share, then it needs to be added with the desired rights (No_access, Read, Change, or Full_Control). To check the current ACE for a user or group on each SVM's c$ share, the following ONTAP CLI command should be used at the cluster management level.</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver cifs share access<span style="color: #000000; ">-</span>control show <span style="color: #000000; ">-</span>share c$</code></pre>
                                            </div>
                                        </div>
                                        <p>The output will list each SVM's ACL for its c$ share. For example:&#160;</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/Config/NetAppCMode/AccessCIFSMethod2.png" title="ONTAP CLI Command Output Example" alt="ONTAP CLI Command Output Example" />
                                        </p>
                                        <p>If the desired ACE does not exist on an SVM's c$ share, then one can be created with the following command:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver cifs share access<span style="color: #000000; ">-</span>control create <span style="color: #000000; ">-</span>share c$ <span style="color: #000000; ">-</span>user<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">or</span><span style="color: #000000; ">-</span>group <span style="color: #000000; ">[</span>USER_OR_GROUP_NAME<span style="color: #000000; ">]</span> <span style="color: #000000; ">-</span>permission Read <span style="color: #000000; ">-</span>vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p>If an existing ACE needs to be modified, the following command should be used:</p>
                                        <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>The following command will overwrite an existing ACE. For example, it is possible to downgrade a user with Full_Control to Read, or vice versa.</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver cifs share access<span style="color: #000000; ">-</span>control modify <span style="color: #000000; ">-</span>share c$ <span style="color: #000000; ">-</span>user<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">or</span><span style="color: #000000; ">-</span>group <span style="color: #000000; ">[</span>USER_OR_GROUP_NAME<span style="color: #000000; ">]</span> <span style="color: #000000; ">-</span>permission Read <span style="color: #000000; ">-</span>vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>If users would prefer to avoid permissioning C$, then there is an alternative. Users can instead give the SVM's Backup Operators group read-only access to each share to be scanned.</p>
                                        <p>In order to utilize <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span>’s LAT Preservation (Last Access Time) feature during sensitive data scans and metadata tag collection, applying ONTAP’s SeRestorePrivilege to the service account is also required.</p>
                                        <p>As an alternative to membership in BUILTIN\Backup Operators, SeBackupPrivilege can be directly applied to a user via the NetApp command line. </p>
                                        <p>The following commands can be used to grant these permissions to the service account to be used for scanning by <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span>.</p>
                                        <p>Use the following commands to add SeBackupPrivilege to the Service Account (or a BUILTIN Group):</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs users<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">and</span><span style="color: #000000; ">-</span>groups privilege add<span style="color: #000000; ">-</span>privilege &#8209;user<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">or</span><span style="color: #000000; ">-</span>group<span style="color: #000000; ">-</span>name <span style="color: #000000; ">[</span>USER_OR_GROUP_NAME<span style="color: #000000; ">]</span> &#8209;privileges SeBackupPrivilege &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following commands to add the Service Account to BUILTIN\Power Users:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs users<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">and</span><span style="color: #000000; ">-</span>groups local<span style="color: #000000; ">-</span>group add<span style="color: #000000; ">-</span>members &#8209;group<span style="color: #000000; ">-</span>name <span style="color: #df5000; ">"BUILTIN\Power Users"</span> &#8209;member<span style="color: #000000; ">-</span>names <span style="color: #000000; ">[</span>DOMAIN_USER<span style="color: #000000; ">]</span> &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following commands to add the Service Account to BUILTIN\Backup Operators:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs users<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">and</span><span style="color: #000000; ">-</span>groups local<span style="color: #000000; ">-</span>group add<span style="color: #000000; ">-</span>members &#8209;group<span style="color: #000000; ">-</span>name <span style="color: #df5000; ">"BUILTIN\Backup Operators"</span> &#8209;member<span style="color: #000000; ">-</span>names <span style="color: #000000; ">[</span>DOMAIN_USER<span style="color: #000000; ">]</span> &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following commands to verify the results from the previous commands:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs users<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">and</span><span style="color: #000000; ">-</span>groups privilege show &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;user<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">or</span><span style="color: #000000; ">-</span>group<span style="color: #000000; ">-</span>name <span style="color: #000000; ">[</span>USER_OR_GROUP_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following commands to give the Service Account Read-only Access to NetApp SVM's c$ Share:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs share access<span style="color: #000000; ">-</span>control create &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;share c$ &#8209;user<span style="color: #000000; ">-</span><span style="color: #a71d5d; font-weight: bold; ">or</span><span style="color: #000000; ">-</span>group <span style="color: #000000; ">[</span>USER_OR_GROUP_NAME<span style="color: #000000; ">]</span> &#8209;permission Read</code></pre>
                                            </div>
                                        </div>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>In the previous command, "create" needs to be replaced with "modify" if the CIFS share ACE already exists for the share/user combination.</p>
                                        <p>Use the following commands to verify the results from the previous command:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>cifs share access<span style="color: #000000; ">-</span>control show &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;share c$</code></pre>
                                            </div>
                                        </div>
                                        <h2>NFSv3 Credential Configuration</h2>
                                        <p>The following is a list of example commands that can be used to configure a NetApp export policy to scan a volume via NFSv3 using the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> File System Solution.</p>
                                        <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>The export policy for a volume's parent (ex. the SVM's root volume), or the export policy for a qtree's parent, must have access rights that are equal or wider in scope to the export policy for the target volume/qtree. If <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> cannot access all segments of a target volume/qtree's junction path, then NFS access will be denied.</p>
                                        <p>Use the following command to create an export policy:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver <span style="color: #a71d5d; font-weight: bold; ">export</span><span style="color: #000000; ">-</span>policy create &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;policyname <span style="color: #000000; ">[</span>EXPORT_POLICY_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p class="Bold_Subheading">Example:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver <span style="color: #a71d5d; font-weight: bold; ">export</span><span style="color: #000000; ">-</span>policy create &#8209;vserver testserver &#8209;policyname testNFS</code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following command to add a rule to the previous export policy, using the nfsv3, auth_sys (aka auth_unix), and superuser properties:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver <span style="color: #a71d5d; font-weight: bold; ">export</span><span style="color: #000000; ">-</span>policy rule create &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;policyname <span style="color: #000000; ">[</span>EXPORT_POLICY_NAME<span style="color: #000000; ">]</span> &#8209;clientmatch <span style="color: #000000; ">[</span>IP_CIDR_NOTATION<span style="color: #000000; ">]</span> &#8209;rorule sys &#8209;rwrule sys &#8209;superuser sys <span style="color: #000000; ">-</span>protocol nfs3</code></pre>
                                            </div>
                                        </div>
                                        <p class="Bold_Subheading">Example:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver <span style="color: #a71d5d; font-weight: bold; ">export</span><span style="color: #000000; ">-</span>policy rule create &#8209;vserver testserver &#8209;policyname testNFS &#8209;clientmatch <span style="color: #df5000; ">0.0</span><span style="color: #000000; ">.</span><span style="color: #df5000; ">0.0</span><span style="color: #000000; ">/</span><span style="color: #df5000; ">0</span> &#8209;rorule sys &#8209;rwrule sys &#8209;superuser sys <span style="color: #000000; ">-</span>protocol nfs3</code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following command to show each volume’s export policy:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>volume show &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;fields policy</code></pre>
                                            </div>
                                        </div>
                                        <p class="Bold_Subheading">Example:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>volume show &#8209;vserver testserver &#8209;fields policy</code></pre>
                                            </div>
                                        </div>
                                        <p>Use the following command to change a volume’s export policy:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>volume modify &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;volume <span style="color: #000000; ">[</span>VOLUME_NAME<span style="color: #000000; ">]</span> &#8209;policy <span style="color: #000000; ">[</span>EXPORT_POLICY_NAME<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p class="Bold_Subheading">Example:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>volume modify &#8209;vserver testserver &#8209;volume testVolume &#8209;policy testNFS</code></pre>
                                            </div>
                                        </div>
                                        <h3>Troubleshooting NFSv3 Export Access</h3>
                                        <p>If <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span>is not discovering the expected NFS export, it is possible that the export policy is not properly configured to allow the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> server or proxy server IP Address to mount the NFS export. One step in troubleshooting this issue is to confirm a Unix client (or WSL for Windows) in the same IP range as the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> server or proxy server can mount the NFS export.</p>
                                        <p>Run the following command from a Unix host to verify the NFS mount is available:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>showmount &#8209;e <span style="color: #000000; ">[</span>NFS_HOSTNAME_OR_IP<span style="color: #000000; ">]</span></code></pre>
                                            </div>
                                        </div>
                                        <p>If the NFS export is returned as a result of the previous command, then <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> should also be able to mount it. If not, it may be necessary to run the following command on the NetApp SVM to get the NFS export to be returned by the <code style="font-family: 'Courier New';">showmount</code> command:</p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: CPP;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>vserver nfs modify &#8209;vserver <span style="color: #000000; ">[</span>SVM_NAME<span style="color: #000000; ">]</span> &#8209;showmount enabled</code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
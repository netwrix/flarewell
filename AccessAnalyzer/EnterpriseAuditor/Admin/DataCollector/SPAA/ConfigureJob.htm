<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" /><title>SharePoint Custom Connection Profile &amp; Host List</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>SharePoint Custom Connection Profile &amp; Host List</h1>
                                        <p>The SPAA Data Collector requires a custom Connection Profile and a custom host list to be created and assigned to the job conducting the data collection. The host inventory option during host list creation makes it necessary to configure the Connection Profile first. While SharePoint on-premises uses the Active Directory account type for the credential within a Connection Profile, it is necessary for online credentials to be listed first in the credentials list within a Connection Profile housing credentials to both environments.&#160;</p>
                                        <h2>SharePoint Farm</h2>
                                        <p>This section describes the process to configure the Connection Profile and custom host list for scanning SharePoint On-Premises.</p>
                                        <h3>SharePoint Farm Credential for a Connection Profile</h3>
                                        <p class="p_8">The provisioned credential used should be an Active Directory account. </p>
                                        <p class="p_8">Create a Connection Profile and set the following information on the User Credentials window:</p>
                                        <ul>
                                            <li>Select Account Type – Active Directory Account</li>
                                            <li>Domain – Drop-down menu with available trusted domains displays. Either type the short domain name in the textbox or select a domain from the menu.</li>
                                            <li>User name – Type the user name</li>
                                            <li>Password Storage – Choose the for credential password storage:<ul><li>Application – Uses <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span>’s configured Profile Security setting as selected at the <b>Settings</b> &gt; <b>Application</b> node</li><li>CyberArk – Uses the CyberArk Enterprise Password Vault</li></ul></li>
                                            <li>Password – Type the password</li>
                                            <li>Confirm – Re-type the password</li>
                                        </ul>
                                        <p>Once the Connection Profile is created, it is time to create the custom host list. See the <a href="../../Settings/Connection/Overview.htm" title="Connection" alt="Connection" target="_parent" class="MCXref xref">Connection</a> topic for additional information. </p>
                                        <h3>SharePoint Farm Host in a Custom Host List</h3>
                                        <p>The custom host list should include:</p>
                                        <ul>
                                            <li>One application server per farm</li>
                                            <li>Host name without a domain suffix, this means the host name should not contain a period character</li>
                                        </ul>
                                        <p>See the <a href="../../HostManagement/Actions/Add.htm" target="_parent" title="Add Hosts" alt="Add Hosts" class="MCXref xref">Add Hosts</a> section  for instruction on creating a custom static host list. &#160;</p>
                                        <h2>SharePoint Online</h2>
                                        <p>This section describes the process to configure the Connection Profile and custom host list for scanning SharePoint Online using Modern Authentication.</p>
                                        <h3><a name="SharePoi"></a>SharePoint Online Credential for a Connection Profile using Modern Authentication</h3>
                                        <p>The provisioned credential should be an Microsoft Entra ID Application. See the <a href="../../../../Config/SharePointOnline/Access.htm" target="_parent" title="SharePoint Online Access &amp; Sensitive Data Auditing Configuration" alt="SharePoint Online Access &amp; Sensitive Data Auditing Configuration" class="MCXref xref">SharePoint Online Access &amp; Sensitive Data Auditing Configuration</a> topic for instructions on registering and provisioning the Microsoft Entra ID Application manually or via the SP_RegisterAzureAppAuth Instant Job. </p>
                                        <p>Create a Connection Profile and set the following information on the User Credentials window:</p>
                                        <ul>
                                            <li>
                                                <p>Select Account Type – Azure Active Directory</p>
                                            </li>
                                            <li>
                                                <p>Client ID – Application (client) ID of the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> application registered with Microsoft Entra ID</p>
                                            </li>
                                            <li>
                                                <p>Password Storage  – Application (Uses the configured Profile Security setting as selected at the <b>Settings</b> &gt; <b>Application</b> node. See the <a href="../../Settings/Application/Overview.htm" target="_parent" title="Application" alt="Application" class="MCXref xref">Application</a> topic for additional information.)</p>
                                            </li>
                                            <li>
                                                <p>Key – The comma delimited string containing the path to the certificate PFX file, certificate password, and the Microsoft Entra ID environment identifier ( <code>CertPath,CertPassword,AzureEnvironment</code>)</p>
                                                <p>The <code>AzureEnvironment</code> is typically 0 for the default Azure Production Environment. Other possible values are:</p>
                                                <ul>
                                                    <li>
                                                        <p>1 – PPE</p>
                                                    </li>
                                                    <li>
                                                        <p> 2 – China</p>
                                                    </li>
                                                    <li>
                                                        <p>3 – Germany</p>
                                                    </li>
                                                    <li>
                                                        <p>4 – US Government</p>
                                                    </li>
                                                    <li>
                                                        <p>5 – US Government-High</p>
                                                    </li>
                                                    <li>
                                                        <p>6 – US Government-DoD</p>
                                                    </li>
                                                </ul>
                                                <p>An example  string matching the configuration from above is:</p>
                                                <p class="Command-Line">C:\Program Files (x86)\STEALTHbits\StealthAUDIT\PrivateAssemblies\spaa_cert_myorg.pfx,PasswordGoesHere,0</p>
                                                <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span><code>PasswordGoesHere</code> should be replaced with the password used when generating the self-signed X.509 certificate if the Microsoft Entra ID Application was Registered and Provisioned manually or the $appPassword parameter used in the SP_RegisterAzureAppAuth Instant Job if that method was used.</p>
                                            </li>
                                        </ul>
                                        <p>Once the Connection Profile is created, it is time to create the custom host list. See the <a href="../../Settings/Connection/Overview.htm" title="Connection" alt="Connection" target="_parent" class="MCXref xref">Connection</a> topic for additional information. </p>
                                        <h3>SharePoint Online Host in a Custom Host List</h3>
                                        <p>The custom host list should include:</p>
                                        <ul>
                                            <li>Web or cloud hosts should be specified using the full web DNS part of the site URL, for example an Office 365 site with the URL http://TestSite.sharepoint.com should be added as a host with name TestSite.sharepoint.com</li>
                                            <li>Do not use the admin site, for example TestSite-admin.sharepoint.com</li>
                                            <li>Do not use IP Addresses</li>
                                            <li>Host name must be in DNS format</li>
                                        </ul>
                                        <p>See the <a href="../../HostManagement/Actions/Add.htm" target="_parent" title="Add Hosts" alt="Add Hosts" class="MCXref xref">Add Hosts</a> topic for instructions on creating a custom static host list.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
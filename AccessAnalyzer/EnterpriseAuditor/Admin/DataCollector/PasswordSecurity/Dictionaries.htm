<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" /><title>PasswordSecurity:&#160;Dictionaries</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>PasswordSecurity:&#160;Dictionaries</h1>
                                        <p>The Dictionaries page provides configuration settings for storing passwords to be used as a reference for the scan.</p>
                                        <p style="text-align: center;">
                                            <img src="../../../../Resources/Images/EnterpriseAuditor/Admin/DataCollector/PasswordSecurity/Dictionaries.png" title="Password Security Data Collection Wizard Dictionary options page" alt="Password Security Data Collection Wizard Dictionary options page" />
                                        </p>
                                        <p>The configurable dictionary options are:</p>
                                        <ul>
                                            <li>
                                                <p>Use Stealthbits dictionary (&gt; 100,000 passwords) – If enabled, compares passwords against out-of-the-box dictionary comprised of commonly used password hashes</p>
                                            </li>
                                            <li>
                                                <p>Automatically update the Stealthbits dictionary – Checks for the latest version of the <span class="mc-variable Netwrix.Company variable">Netwrix</span> weak password dictionary file when the job is executed, and downloads the latest version from the <a href="https://www.netwrix.com/" target="_blank" title="Netwrix website" alt="Netwrix website">Netwrix website</a></p>
                                                <ul>
                                                    <li>
                                                        <p>If the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> server does not have an internet connection, the weak password dictionary can be downloaded directly from the <a href="https://www.netwrix.com/my_products.html" target="_blank" title="My Products" alt="My Products">My Products</a> page of the <span class="mc-variable Netwrix.Company variable">Netwrix</span> website. See the <a href="#Download" target="_parent" title="Download the Netwrix Weak Password Dictionary" alt="Download the Netwrix Weak Password Dictionary" class="MCXref xref">Download the Netwrix Weak Password  Dictionary</a> topic for additional information.</p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>Update Dictionary – Checks for the latest version of the dictionary file, and updates if necessary</p>
                                            </li>
                                            <li>
                                                <p>Add – Add a custom dictionary file in one of the following formats:</p>
                                                <ul>
                                                    <li>
                                                        <p>Plaintext – Line separated in a text file</p>
                                                    </li>
                                                    <li>
                                                        <p>NLTM Hashes – Can be added with hashes or sorted hashes. The haveibeenpwned dictionary can be used. See the <a href="#Download2" target="_parent" title="Download and Configure the Have I Been Pwnd (HIBP) Hash List" alt="Download and Configure the Have I Been Pwnd (HIBP) Hash List" class="MCXref xref">Download and Configure the Have I Been Pwnd (HIBP) Hash List</a> topic&#160;for additional information.</p>
                                                        <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>Use the sorted hash dictionary if adding an NLTM format</p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>Remove – Removes a custom dictionary file from the query scope</p>
                                            </li>
                                        </ul>
                                        <h2><a name="Download"></a>Download the Netwrix Weak Password  Dictionary</h2>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>If the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> server does not have an internet connection, the weak passwords dictionary can be downloaded directly from the <a href="https://www.netwrix.com/my_products.html" target="_blank" title="My Products" alt="My Products">My Products</a> page of the <span class="mc-variable Netwrix.Company variable">Netwrix</span> website.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>After downloading the dictionary file manually do one the following:</p>
                                        <ul>
                                            <li>
                                                <p>If an internet connection exists on the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> server:</p>
                                                <ul>
                                                    <li>
                                                        <p>Place the <code>dictionary.dat</code> file in the following location: <code>%sainstalldir%\Jobs\SA_CommonData\PasswordSecurity\Dictionaries</code></p>
                                                    </li>
                                                    <li>
                                                        <p>Rename the file to <code>sadictionary_hashed_sorted.dat</code></p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>If no internet connection exists on the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> server:</p>
                                                <ul>
                                                    <li>
                                                        <p>Copy the file to the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> server and put it in a location of your choosing. The default location is <code>%sainstalldir%\Jobs\SA_CommonData\PasswordSecurity\Dictionaries</code></p>
                                                    </li>
                                                    <li>
                                                        <p>Open the PasswordSecurity data collector configuration for the <b>AD_WeakPasswords</b> job</p>
                                                    </li>
                                                    <li>
                                                        <p>On the Dictionaries page, deselect the <b>Use STEALTHbits dictionary</b> checkbox</p>
                                                    </li>
                                                    <li>
                                                        <p>On the Dictionaries page, click <b>Add...</b> and select the previously downloaded <code>dictionary.dat</code> file</p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <h2><a name="Download2"></a>Download and Configure the Have I Been Pwnd (HIBP) Hash List</h2>
                                        <p>If you don't have internet access on the <span class="mc-variable SA.Product_Long_Name variable">Netwrix Access Analyzer (formerly Enterprise Auditor)</span> server or want to download the files  from another location that has internet access, you can do so by using the Pwnd Passwords Downloader.</p>
                                        <p>The Pwnd Passwords Downloader is a Dotnet tool used to download all Pwned Passwords hash ranges and save them offline so they can be used without a dependency on the k-anonymity API. Use this tool to get the latest breached hashes from the Have I Been Pwnd (HIBP) database.</p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The <a href="https://github.com/HaveIBeenPwned/PwnedPasswordsDownloader" target="_blank" title="haveibeenpwned-downloader" alt="haveibeenpwned-downloader"><a href="https://github.com/HaveIBeenPwned/PwnedPasswordsDownloader" target="_blank" title="Pwnd Passwords Downloader GitHub page" alt="Pwnd Passwords Downloader GitHub page">Pwnd Passwords Downloader</a></a> is a third party, open source tool, created by the HaveIBeenPwned team and distributed under a BSD 3-Clause License. You might experience issues during the hash download process, depending on your threading settings or the load on the CloudFlare backend. The Pwnd Passwords Downloader tool will automatically retry to continue downloading the hashes until it fully completes the download process.</p>
                                        <h3>Prerequisites</h3>
                                        <p>The Pwnd Passwords Downloader has the following prerequisite: </p>
                                        <ul>
                                            <li>
                                                <p>Install .NET 6 before installing the <a href="https://github.com/HaveIBeenPwned/PwnedPasswordsDownloader" target="_blank" title="Pwnd Passwords Downloader" alt="Pwnd Passwords Downloader">Pwnd Passwords Downloader </a>tool. You can download .NET 6 from Microsoft: <a href="https://dotnet.microsoft.com/en-us/download/dotnet/6.0">https://dotnet.microsoft.com/en-us/download/dotnet/6.0</a></p>
                                            </li>
                                        </ul>
                                        <p>The HIBP database takes up additional space on the machine where it is copied (approximately 13 GB, but subject to change). The Have I&#160;Been Pwnd database (HIBP) hashes can take up to 30 GB. Make sure that you have enough free space on your disk in your <span class="mc-variable SA.Product_Long_Name variable">Netwrix Access Analyzer (formerly Enterprise Auditor)</span> install directory (<code>%sainstalldir%</code>).</p>
                                        <h3>Install the Pwnd Passwords Downloader</h3>
                                        <p>Follow the steps to install the Pwnd Passwords Downloader.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Open command prompt, and navigate to your .NET install folder (for example, <code>C:\Program Files (x86)\dotnet</code>).</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Run the following command: </p>
                                        <div class="codeSnippet">
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>dotnet tool install --global haveibeenpwned-downloader</code></pre>
                                            </div>
                                        </div>
                                        <p style="text-align: center;">
                                            <img src="../../../../Resources/Images/PPE Admin Guide/HIBP_Installation_0.png" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Close the command prompt.</p>
                                        <h3>Update an Installed Pwnd Passwords Downloader</h3>
                                        <p>Follow the steps to update an installed Pwnd Passwords Downloader.</p>
                                        <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Open the command prompt.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Run the following command:</p>
                                        <div class="codeSnippet">
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>dotnet tool update --global haveibeenpwned-downloader</code></pre>
                                            </div>
                                        </div>
                                        <p style="text-align: center;">
                                            <img src="../../../../Resources/Images/PPE Admin Guide/HIBP_Installation_1.png" />
                                        </p>
                                        <h3>Download NTML Hashes with the Pwnd Passwords Downloader</h3>
                                        <p>Follow the steps to download NTLM hashes.</p>
                                        <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Navigate to the folder where you want to download the hashes.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Download all NTLM hashes to a single txt file, called for example <code>pwnedpasswords_ntlm.txt</code>.</p>
                                        <p>Run:</p>
                                        <div class="codeSnippet">
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>haveibeenpwned-downloader.exe -n pwnedpasswords_ntlm</code></pre>
                                            </div>
                                        </div>
                                        <p style="text-align: center;">
                                            <img src="../../../../Resources/Images/PPE Admin Guide/HIBP_Installation_3.png" />
                                        </p>
                                        <p>This screenshot shows the completed download.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>To overwrite an existing hash list, run:</p>
                                        <div class="codeSnippet">
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>haveibeenpwned-downloader.exe -n pwnedpasswords_ntlm -o</code></pre>
                                            </div>
                                        </div>
                                        <p>For a complete list of available parameters, please check the <a href="https://github.com/HaveIBeenPwned/PwnedPasswordsDownloader" target="_blank" title="Pwnd Passwords Downloader GitHub page" alt="Pwnd Passwords Downloader GitHub page">Pwnd Passwords Downloader GitHub page</a>.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
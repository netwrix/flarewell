<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Non-English Language Environments</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>Non-English Language Environments</h1>
                                        <p>There are specific SQL Server requirements when installing <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> in a non-English Language environment, specifically when the environment uses a non-Latin alphabet.</p>
                                        <h2>Requirements</h2>
                                        <p>The following collation requirements need to be met prior to the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> installation. </p>
                                        <h3>Database &amp; Server Collation Settings</h3>
                                        <p>The collation settings at the database level must match what is set at the server level. </p>
                                        <p class="Bold_Subheading">Symptoms</p>
                                        <p>Common errors that occur are:</p>
                                        <ul>
                                            <li>Implicit conversion of VARCHAR value to VARCHAR cannot be performed because the collation of the value is unresolved due to a collation conflict.<ul><li>Could not find stored procedure <code>#SA_ImportObject</code></li><li>Cannot drop the procedure <code>#SA_ImportObject</code>, because it does not exist or lack of permission</li></ul></li>
                                            <li>Cannot resolve the collation conflict between <b>SQL_Latin1_General_CP1_CI_AS</b> and <b>French_CI_AS</b> in the equal to operation.</li>
                                        </ul>
                                        <p class="Bold_Subheading">Cause</p>
                                        <p>These errors occur because the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> solutions use many temporary functions and procedures which in turn use the collation at the server level. Temporary tables created within a stored procedure use the TEMPDB database’s collation instead of the current user database’s collation. Therefore, there will be issues in analysis due to the mismatch.</p>
                                        <p class="Bold_Subheading">Resolution</p>
                                        <p>The following is a work-around which we use to avoid collation errors. However, when making changes at the SQL Server level, use caution as it actually rebuilds all user/system database objects. If there are schema bound objects (i.e. Constraints), the whole operation will fail. Make sure to have all of the information or scripts needed to recreate the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> user’s databases and all of the objects in them. Customers should use a localized version of the SQL Server, and this should not be done in production environments. </p>
                                        <h4>Change Collation at the Database Level</h4>
                                        <p>Follow the steps to change the collation at the database level.</p>
                                        <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Access the Database Properties in SQL Server Management Studio.</p>
                                        <p style="text-align: center;">
                                            <img src="../../../Resources/Images/EnterpriseAuditor/Install/Database/DatabasePropertiesCollation.png" title="SQL Server Management Studio Database Properties window" alt="SQL Server Management Studio Database Properties window" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Select <b>Options</b> and set the collation.</p>
                                        <p>Now that the collations match, proceed with <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> installation.</p>
                                        <h4>Change Collation at the SQL Server Level</h4>
                                        <p>Follow the steps to change the collation at the SQL Server level.</p>
                                        <p style="text-align: center;">
                                            <img src="../../../Resources/Images/EnterpriseAuditor/Install/Database/SQLServerConfigurationManager.png" title="SQL Server Configuration Manager" alt="SQL Server Configuration Manager" />
                                        </p>
                                        <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Stop the SQL Server service from the Configuration Manager.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Open CMD console as Administrator, and go to the following path (or the path where the binary files are): </p>
                                        <div class="codeSnippet">
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>…\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Binn&#160;&#160;</code></pre>
                                            </div>
                                        </div>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Execute the following command (or whichever collation is needed):</p>
                                        <div class="codeSnippet">
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>sqlservr.exe&#160;&#160;-m -T4022 -T3659 -q "French _CS_AS"</code></pre>
                                            </div>
                                        </div>
                                        <p>See the Microsoft <a href="https://learn.microsoft.com/en-us/sql/relational-databases/collations/collation-and-unicode-support" target="_blank" title="Collation and Unicode support" alt="Collation and Unicode support">Collation and Unicode support</a> article for collation matches.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Wait until it finishes and start the SQL Server service again.</p>
                                        <p>Now that the collations match, proceed with <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> installation.</p>
                                        <h3>Case Sensitive Collation</h3>
                                        <p><span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> does not support case sensitive collation settings. Case insensitive collations are notated by having <b>CI</b> in the collation, for example <b>Latin1_General_CI_AS</b>.</p>
                                        <p class="Bold_Subheading">Cause</p>
                                        <p>For example, <code>SYS.INDEXES</code> will be unable to be found if there was an English install of SQL Server but a Turkish collation which is case sensitive. So <code>'SYS.INDEXES != 'sys.indexes' </code>in the environment.</p>
                                        <p class="Bold_Subheading">Resolution</p>
                                        <p>All collation settings must be case insensitive.</p>
                                        <h2>Troubleshooting</h2>
                                        <p>The following are possible problems for future consideration.</p>
                                        <p>During comparison or joining of columns, collation conflict error occurs in two cases if collation of one column does not match with collation of another column:</p>
                                        <p>This can be generated by the following script:</p>
                                        <div class="codeSnippet">
                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>CREATE TABLE TestTab<br />(PrimaryKey int PRIMARY KEY,<br />CharCol char(10) COLLATE French_CI_AS,<br />CharCol2 char(10) COLLATE greek_ci_as<br />)<br />INSERT INTO TestTab VALUES (1, 'abc', 'abc')<br />&#160;<br />SELECT * FROM TestTab WHERE CharCol = CharCol2</code></pre>
                                            </div>
                                        </div>
                                        <ul>
                                            <li>Error Returned – Cannot resolve the collation conflict between <b>Greek_CI_AS</b> and <b>French_CI_AS</b> in the equal to operation.</li>
                                            <li>
                                                <p>Resolution – If the select statement is changed as below, then it would run successfully. </p>
                                                <div class="codeSnippet">
                                                    <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>SELECT * FROM TestTab WHERE CharCol = CharCol2 COLLATE Albanian_CI_AI</code></pre>
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>Explicit collation (Albanian_CI_AI) is not one of any column, but after that it will complete successfully. The collation of two columns have not been matched, instead the third rule of collation precedence was implemented. See the Microsoft <a href="https://learn.microsoft.com/en-us/sql/t-sql/statements/collation-precedence-transact-sql" title="Collation Precedence" alt="Collation Precedence" target="_blank">Collation Precedence</a> article for additional information.</p>
                                        <h3>Resources</h3>
                                        <p>The following articles may be of assistance:</p>
                                        <ul>
                                            <li>Microsoft <a href="https://learn.microsoft.com/en-us/sql/relational-databases/collations/collation-and-unicode-support" target="_blank" title="Collation and Unicode support" alt="Collation and Unicode support">Collation and Unicode support</a> article</li>
                                            <li>Microsoft <a href="https://learn.microsoft.com/en-us/sql/t-sql/statements/collation-precedence-transact-sql" target="_blank" title="Collation Precedence" alt="Collation Precedence">Collation Precedence</a> article</li>
                                            <li>Microsoft <a href="https://learn.microsoft.com/en-us/sql/relational-databases/collations/set-or-change-the-server-collation" target="_blank" title="Set or change the server collation" alt="Set or change the server collation">Set or change the server collation</a> article&#160;</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
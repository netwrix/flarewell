<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|Agent-Based Scans" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" /><title>SharePoint Agent Permissions</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>SharePoint Agent Permissions</h1>
                                        <p>When <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint scans are run in agent-based mode, the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> SharePoint Agent must be installed on the SharePoint Application server which hosts the Central Administration component prior to executing the scans. This is typically the first server stood up during the SharePoint farm installation process in this mode. The data collection processing is conducted by the SharePoint Agent for the target environment. The final step in data collection is to transfer the data collected in the SQLite databases, or Tier 2 databases, on the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> SharePoint Agent server back to the <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> Console server.</p>
                                        <p>The <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint Agent needs to be installed on the:</p>
                                        <ul>
                                            <li>
                                                <p>SharePoint Application server hosting the Central Administration component</p>
                                                <ul>
                                                    <li>
                                                        <p>SharePoint® 2013 through SharePoint® 2019</p>
                                                    </li>
                                                    <li>
                                                        <p>Windows® Server 2016 through Windows® Server 2022</p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p class="Bold_Subheading">Additional Server Requirements</p>
                                        <p>The following are additional requirements for the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint Agent server:</p>
                                        <ul>
                                            <li>
                                                <p>.NET Framework 4.8 installed</p>
                                            </li>
                                            <li>
                                                <p>Port Sharing network feature</p>
                                            </li>
                                        </ul>
                                        <p class="Bold_Subheading">Sensitive Data Discovery Auditing Requirement</p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The appropriate JDK (Java) version for Sensitive Data Discovery is installed on the server. The JDK deployed is prepackaged and does not require any configuration; it has been preconfigured to work with <span class="mc-variable SA._Product_Short_Name variable">Access Analyzer</span> and should never be customized through Java. It will not conflict with other JDKs or Java Runtimes in the same environment.</p>
                                        <p>If running Sensitive Data Discovery (SDD) scans, it will be necessary to increase the minimum amount of RAM. Each thread requires a minimum of 2 additional GB of RAM per host. For example, if the job is configured to scan 8 hosts at a time , then an extra 16 GB of RAM are required (8x2=16).</p>
                                        <h2>Permissions Explained</h2>
                                        <p>If limited provisioning of the service account is not required by the organization, then the following permissions are sufficient for successful agent-based scans:</p>
                                        <ul>
                                            <li>
                                                <p>Membership in the local Administrator group on the on server where the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint Agent is installed</p>
                                                <ul>
                                                    <li>
                                                        <p>Only needed for agent installation</p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>SharePoint Application Server permissions:</p>
                                                <ul>
                                                    <li>
                                                        <p>Membership in the local Backup Operators group </p>
                                                        <ul>
                                                            <li>
                                                                <p>This is required so <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> can read remote registry to identify if the server is part of the farm, what the server’s role is, and to identify the location of the SharePoint configuration database</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>Membership in the local WSS_WPG group</p>
                                                        <ul>
                                                            <li>
                                                                <p>This is required to gain read access to system resources used by Microsoft SharePoint Foundation</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>Log on as a Service in the Local Security Policy</p>
                                                    </li>
                                                    <li>
                                                        <p>Full Control on the agent install directory, default path is: </p>
                                                        <p><code>C:\Program Files\STEALTHbits\StealthAUDIT\SPAA</code>
                                                        </p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>SharePoint Farm permissions:</p>
                                                <ul>
                                                    <li>
                                                        <p>Membership in the Farm Read  group at the farm level</p>
                                                        <ul>
                                                            <li>
                                                                <p>This is required so the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> auditing account can make calls against the SharePoint web services to remotely gather information around permissions, site hierarchy, content and more</p>
                                                            </li>
                                                            <li>
                                                                <p>If the group does not exist already, then you need to create a new group at that level and grant it Read access. Specifically, it is a group that exists within Central Administration at the farm administrator level. This group only requires Read access and is not giving farm admin access. Once the group is created, add the service account that <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> will be leveraging to scan SharePoint.</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p class="ListContinue">Web Application permissions:</p>
                                                <ul>
                                                    <li>
                                                        <p>Custom Role with Site Collection Auditor  at the web application level with the Open Items  permission</p>
                                                        <ul>
                                                            <li>
                                                                <p>This is needed for <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> to execute web service calls against Central Administration</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>SharePoint Database Server permissions:</p>
                                                <ul>
                                                    <li>
                                                        <p>SPDataAccess on the SharePoint Content database and all Configuration databases</p>
                                                        <ul>
                                                            <li>
                                                                <p>This permission should be applied on the desired Configuration database and all Content databases for the SharePoint version</p>
                                                            </li>
                                                            <li>
                                                                <p>This version-specific permission is required for <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> to execute read operations directly against the SharePoint databases, gather information from the configuration database regarding the names and locations of the web applications and content databases, and give read access around sites, roles, and users</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>DB_Owner on <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> database if using Windows Authentication for the Storage Profile</p>
                                            </li>
                                            <li>
                                                <p>MySites permissions are based on the SharePointAccess  Data Collector configuration option: </p>
                                                <ul>
                                                    <li>
                                                        <p>Forcing the service account to become a temporary admin of the personal sites either as the service account or as a member of the Company Administrators group requires SharePoint Farm Administrator role or Site Collection Auditor at the web application housing MySites</p>
                                                    </li>
                                                    <li>
                                                        <p>The skipping inaccessible personal sites option only scans sites where the service account has administrative access</p>
                                                    </li>
                                                    <li>
                                                        <p>This grants <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> rights to scan MySites</p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p>Additional permission models are explained for a less and least permission model.</p>
                                        <h2>SharePoint Agent-Based Less Privilege Permission Model</h2>
                                        <p>If restricted permissions are desired by the organization, then the following permissions are needed for the service account to successfully run SharePoint Agent-based scans.</p>
                                        <p>Prior to installation of the SharePoint Agent, the service account to be supplied during installation and later used to run the Access Auditing (SPAA)  and Sensitive Data Discovery Auditing scans against the targeted SharePoint environment needs the following permissions:</p>
                                        <ul>
                                            <li>
                                                <p>Log on as a Service in the Local Security Policy</p>
                                            </li>
                                            <li>
                                                <p>Membership in the local IIS_IUSRS group</p>
                                            </li>
                                            <li>
                                                <p>Performance Log Users (for Sensitive Data Discovery only)</p>
                                            </li>
                                        </ul>
                                        <p>After the SharePoint Agent installation, this service account needs the following additional permissions to run the Access Auditing (SPAA)  and Sensitive Data Discovery Auditing scans:</p>
                                        <ul>
                                            <li>
                                                <p>Site Collection Administrator on all Site Collections to be scanned</p>
                                            </li>
                                            <li>
                                                <p>Membership in the local Users group on the server where the SharePoint Agent is installed</p>
                                            </li>
                                            <li>
                                                <p>DB_Owner on <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> database if using Windows Authentication for the Storage Profile</p>
                                            </li>
                                        </ul>
                                        <p>If the scans include Web Application scoping, then the following permissions are needed (can be skipped if running full farm scans):</p>
                                        <ul>
                                            <li>
                                                <p>Membership in the local Backup Operators group</p>
                                            </li>
                                            <li>
                                                <p>Membership in the local WSS_WPG group</p>
                                            </li>
                                            <li>
                                                <p>WSS_CONTENT_APPLICATION_POOLS on the SharePoint Configuration database</p>
                                            </li>
                                        </ul>
                                        <p>After the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint Agent is installed, ensure that the service account has the following permissions:</p>
                                        <ul>
                                            <li>
                                                <p>Full Control on the agent install directory, default path is: </p>
                                                <p><code>C:\Program Files\STEALTHbits\StealthAUDIT\SPAA</code>
                                                </p>
                                            </li>
                                        </ul>
                                        <p>The <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint Agent utilizes Microsoft APIs. The Microsoft APIs require an account with the following permissions in order to collect all of the data:</p>
                                        <ul>
                                            <li>
                                                <p>WSS_CONTENT_APPLICATION_POOLS on the SharePoint Content databases</p>
                                            </li>
                                            <li>
                                                <p>WSS_CONTENT_APPLICATION_POOLS on the SharePoint Configuration database</p>
                                            </li>
                                        </ul>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>If scans include Web Application scoping, this last permission requirement is already met.</p>
                                        <h2>SharePoint Agent-Based Least Privilege Permission Model</h2>
                                        <p>If a least privilege model is required by the organization, then the following permissions are needed for the service account to successfully run SharePoint Agent-based scans.</p>
                                        <p>Prior to installation of the SharePoint Agent, the service account to be supplied during installation and later used to run the Access Auditing (SPAA)  and Sensitive Data Discovery Auditing scans the targeted SharePoint environment needs the following permissions:</p>
                                        <ul>
                                            <li>
                                                <p>Log on as a Service in the Local Security Policy</p>
                                            </li>
                                            <li>
                                                <p>Service Account SID added to the <code>SMSvcHost.exe.config</code> file</p>
                                            </li>
                                            <li>
                                                <p>Performance Log Users (for Sensitive Data Discovery only)</p>
                                            </li>
                                        </ul>
                                        <p>After the SharePoint Agent installation, this service account needs the following additional permissions to run the Access Auditing (SPAA)  scans:</p>
                                        <ul>
                                            <li>
                                                <p>Site Collection Administrator on all Site Collections to be scanned</p>
                                            </li>
                                            <li>
                                                <p>Membership in the local Users group on the server where the SharePoint Agent is installed</p>
                                            </li>
                                            <li>
                                                <p>DB_Owner on <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> database if using Windows Authentication for the Storage Profile</p>
                                            </li>
                                        </ul>
                                        <p>If the scans include Web Application scoping, then the following permissions are needed (can be skipped if running full farm scans):</p>
                                        <ul>
                                            <li>
                                                <p>READ Access on the following registry keys:</p>
                                                <ul>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowPaths</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg\AllowExactPaths</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p>For SharePoint 2013:</p>
                                                        <ul>
                                                            <li>
                                                                <p><code style="font-family: 'Courier New';">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Web Server Extensions\15.0\Secure</code>
                                                                </p>
                                                            </li>
                                                            <li>
                                                                <p><code style="font-family: 'Courier New';">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Web Server Extensions\15.0\Secure\ConfigDB</code>
                                                                </p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>DB_DataReader on the SharePoint Configuration database </p>
                                            </li>
                                            <li>
                                                <p><code style="font-family: 'Courier New';">'GRANT EXECUTE'</code> permissions on the following stored procedures in the SharePoint Configuration database:</p>
                                                <ul>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getObject</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getObjectsByClass</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getObjectsByBaseClass</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getDependentObjectsByBaseClass</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_ReturnWebFeatures</code>
                                                        </p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p>After the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint Agent is installed, ensure that the service account has the following permissions:</p>
                                        <ul>
                                            <li>
                                                <p>Full Control on the agent install directory, default path is: </p>
                                                <p><code>C:\Program Files\STEALTHbits\StealthAUDIT\SPAA</code>
                                                </p>
                                            </li>
                                        </ul>
                                        <p>The <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> SharePoint Agent utilizes Microsoft APIs. The Microsoft APIs require an account with the following permissions in order to collect all of the data:</p>
                                        <ul>
                                            <li>
                                                <p><code style="font-family: 'Courier New';">'GRANT EXECUTE'</code> permissions on the following stored procedures in the SharePoint Configuration database:</p>
                                                <ul>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getObject</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getObjectsByClass</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getObjectsByBaseClass</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_getDependentObjectsByBaseClass</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">proc_ReturnWebFeatures</code> </p>
                                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The above four stored procedures would already have the correct permissions if Web Application scoping is desired.</p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_getSiteName</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_getSiteMap</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_getSiteMapById</code>
                                                        </p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>DB_DataReader on the SharePoint Content databases and SharePoint AdminContent database, if applicable</p>
                                            </li>
                                            <li>
                                                <p><code style="font-family: 'Courier New';">'GRANT EXECUTE'</code> permissions on the following stored procedures in the SharePoint Content databases and SharePoint AdminContent database (if applicable):</p>
                                                <ul>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_EnumLists</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetTpWebMetaDataAndListMetaData</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetListMetaDataAndEventReceivers</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetSiteProps</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetListWebParts</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetWebFeatureList</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetListFields</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetDocsMetaInfo</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_GetDocIdUrl</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_ListChildWebs</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_ListChildWebs</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_ListUrls</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_ListChildWebs</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecListAllSiteMembers</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecRefreshToken</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecListSiteGroups</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecListSiteGroupMembership</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecGetRoleDefs</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecListSiteGroups</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecListScopeUsers</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecListScopeGroups</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecAddWebMembership</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecGetSecurityInfo</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecGetPrincipalByLogin</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecGetPrincipalDisplayInformation20</code>
                                                        </p>
                                                    </li>
                                                    <li>
                                                        <p><code style="font-family: 'Courier New';">[dbo].proc_SecGetRoleBindingsForAllPrincipals</code>
                                                        </p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
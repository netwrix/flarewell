<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Recommended Configuration for the SharePoint Solution</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>Recommended Configuration for the SharePoint Solution</h1>
                                        <p>The SharePoint Solution has been configured to inherit down from the <b>SharePoint</b> &gt; <b>Settings</b> node. However, it is a best practice to assign the host list and the Connection Profile at the data collection level, 0.Collection Job Group. Once these are assigned to the job group, it can be run directly or scheduled. </p>
                                        <p class="Bold_Subheading">Dependencies</p>
                                        <ul>
                                            <li>
                                                <p>The <b>.Active Directory Inventory</b> Job Group needs to be executed prior to running the SharePoint Solution against a SharePoint on-premises environment</p>
                                            </li>
                                            <li>
                                                <p>The <b>.Entra ID Inventory</b> Job Group needs to be executed prior to running the SharePoint Solution against a SharePoint Online environment</p>
                                            </li>
                                            <li>
                                                <p>For Agent-based scans, the SharePoint Agent must be installed on the application server (for Access Auditing &amp; Sensitive Data Discovery Auditing only)</p>
                                            </li>
                                        </ul>
                                        <p class="Bold_Subheading">Targeted Host(s)</p>
                                        <p>For the 0.Collection Job Group:</p>
                                        <ul>
                                            <li>
                                                <p>Single SharePoint Application server hosting Central Administration per SharePoint farm</p>
                                            </li>
                                        </ul>
                                        <p>The host list assignment should be assigned under the <b>SharePoint</b> &gt; <b>0.Collection</b> &gt; <b>Settings</b> &gt; <b>Host List Assignment</b> node. The list should be a custom-created list for the SharePoint environments to be targeted. Select the checkbox for the custom-created host list. </p>
                                        <p>Since SharePoint Online environments can only be targeted for Access Auditing and Sensitive Data Discovery Auditing, it is best practice to set the host list at the job level. </p>
                                        <p>See the <a href="../../Admin/HostManagement/Actions/Add.htm" target="_parent" title="Add Hosts" alt="Add Hosts" class="MCXref xref">Add Hosts</a> topic for additional information.</p>
                                        <p class="Bold_Subheading">Connection Profile</p>
                                        <p>The SPAA Data Collector requires a specific set of permissions. See the <a href="../../Requirements/Solutions/SharePoint/ScanOptions.htm" target="_parent" title="SharePoint Scan Options" alt="SharePoint Scan Options" class="MCXref xref">SharePoint Scan Options</a> and <a href="../../Requirements/Target/SharePoint.htm" target="_parent" title="SharePoint Support" alt="SharePoint Support" class="MCXref xref">SharePoint Support</a> topics for the necessary permissions for both on-premises and online target environments. Then create a custom Connection Profile containing the appropriate credentials for the targeted environment. If a single Connection Profile contains both on-premises and online credentials, it is necessary for the online credentials to be above the on-premises credentials in the Connection Profile credentials list.</p>
                                        <p>The Connection Profile should be assigned under the <b>SharePoint</b> &gt; <b>0.Collection</b> &gt; <b>Settings</b> &gt; <b>Connection</b> node. It is set to <b>Use the Default Profile</b>, as configured at the global settings level. However, since this may not be the Connection Profile with the necessary permissions for the assigned hosts, select the  <b>Select one of the following user defined profiles</b> option and select the appropriate Connection Profile from the drop-down menu. </p>
                                        <p>The jobs within the 5.Effective Access Audits Job Group import CSV files from the jobs’ directories using the TextSearch Data Collector. Therefore, it is necessary to assign a Connection Profile with rights on the <span class="mc-variable SA.Product_Short_Name variable">Access Analyzer</span> Console server to access the CSV file saved in the job’s directory. The Connection Profile can be set at either the <b>Effective Access Audits</b> &gt; <b>Settings</b> &gt; <b>Connection</b> node (applies to both jobs) or in the job’s Properties window on the Connection tab.</p>
                                        <p style="margin-bottom: 0pt;">See the <a href="../../Admin/Settings/Connection/Overview.htm" target="_parent" title="Connection" alt="Connection" class="MCXref xref">Connection</a> topic for additional information.</p>
                                        <p class="Bold_Subheading">Schedule Frequency</p>
                                        <p>The jobs in this job group can be scheduled to run as desired.</p>
                                        <p class="Bold_Subheading">Run Order</p>
                                        <p>The 0.Collection Jobs must be run first and in order. RunSystem Scans jobs and then the Bulk Import jobs according to the desired workflow. The other SharePoint Solution sub-job groups can be run in any order, together or individually, after running the 0.Collection Job Group. It is recommended to run at the sub-job group level. The SP_Overview Job pulls information from both the 0.Collection Job Group and the other sub-job groups, and the report may contain blank sections if only select sub-job groups are run.</p>
                                        <p>The <span class="mc-variable AIC.Product_Short_Name variable">Access Information Center</span> requires the execution of the 2-SPAA_BulkImport Job default analysis tasks in order for permission/access reports to be accessible. For activity reports, the <span class="mc-variable AIC.Product_Short_Name variable">Access Information Center</span> requires the execution of both the 2-SPAA Bulk Import Job default analysis tasks and the 2-SPAC Bulk Import Job default analysis tasks.</p>
                                        <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>If only conducting one or two types of auditing, scope the solution by disabling the undesired collection jobs. Disabling them allows the solution to run more efficiently. It is not recommended to delete any jobs. See the <a href="../../Admin/Jobs/Job/DisableEnable.htm" target="_parent" title="Disable or Enable a Job" alt="Disable or Enable a Job" class="MCXref xref">Disable or Enable a Job</a> topic for additional information.</p>
                                        <p class="Bold_Subheading">Query Configuration</p>
                                        <p>This solution can be run with the default query configuration. However, the most common customizations include:</p>
                                        <ul>
                                            <li>
                                                <p>If using agent-based scanning, it is necessary to enable the agent services on the SharePoint Access Auditor Data Collector Wizard pages:</p>
                                                <ul>
                                                    <li>
                                                        <p>Agent Settings page, enable agent service scans:</p>
                                                        <ul>
                                                            <li>
                                                                <p>Set on the <b>0.Collection</b> &gt; <b>1-SPAA_SystemScans</b> Job for Access Auditing</p>
                                                            </li>
                                                            <li>
                                                                <p>Set on the <b>0.Collection</b> &gt; <b>1-SPSEEK_SystemScans</b> Job for Sensitive Data Discovery Auditing</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>SharePoint Access Auditor Data Collector Wizard pages:</p>
                                                <ul>
                                                    <li>
                                                        <p>SharePoint Data Collection Settings page, configure probable owner scanning:</p>
                                                        <ul>
                                                            <li>
                                                                <p>Enable <b>Scan for Document Metadata</b> for probable owners calculations</p>
                                                            </li>
                                                            <li>
                                                                <p>Set on the:</p>
                                                                <ul>
                                                                    <li>
                                                                        <p><b>0.Collection</b> &gt; <b>1-SPAA_SystemScans</b> Job for Access Auditing</p>
                                                                    </li>
                                                                    <li>
                                                                        <p><b>0.Collection</b> &gt; <b>1-SPSEEK_SystemScans</b> Job for Sensitive Data Discovery Auditing</p>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>Scan Scoping Options page (optional):</p>
                                                        <ul>
                                                            <li>
                                                                <p>Limit scans to specific Web Applications and site collections</p>
                                                            </li>
                                                            <li>
                                                                <p>Set on the:</p>
                                                                <ul>
                                                                    <li>
                                                                        <p><b>0.Collection</b> &gt; <b>1-SPAA_SystemScans</b> Job for Access Auditing</p>
                                                                    </li>
                                                                    <li>
                                                                        <p><b>0.Collection</b> &gt; <b>1-SPSEEK_SystemScans</b> Job for Sensitive Data Discovery Auditing</p>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>Additional Scoping page (optional): </p>
                                                        <ul>
                                                            <li>
                                                                <p>Limit scan depth</p>
                                                            </li>
                                                            <li>
                                                                <p>Set on the:</p>
                                                                <ul>
                                                                    <li>
                                                                        <p><b>0.Collection</b> &gt; <b>1-SPAA_SystemScans</b> Job for Access Auditing</p>
                                                                    </li>
                                                                    <li>
                                                                        <p><b>0.Collection</b> &gt; <b>1-SPSEEK_SystemScans</b> Job for Sensitive Data Discovery Auditing</p>
                                                                    </li>
                                                                </ul>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>DLP Audit Settings page, scope to not scan files larger than a specific size for Sensitive Data Discovery Auditing:</p>
                                                        <ul>
                                                            <li>
                                                                <p>Set on the <b>0.Collection</b> &gt; <b>1-SPSEEK_SystemScans</b> Job</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>Select DLP Criteria page, scope to scan for specific criteria or customizing criteria for Sensitive Data Discovery Auditing:</p>
                                                        <ul>
                                                            <li>
                                                                <p>Set on the <b>0.Collection</b> &gt; <b>1-SPSEEK_SystemScans</b> Job</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>Activity Data Scope page:</p>
                                                        <ul>
                                                            <li>
                                                                <p>Customize date ranges for activity to be collected</p>
                                                            </li>
                                                            <li>
                                                                <p>Set on the <b>0.Collection</b> &gt; <b>1-SPAC_SystemScans</b> Job for Activity Auditing</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <li>
                                                        <p>Activity Log Locations page (optional):</p>
                                                        <ul>
                                                            <li>
                                                                <p>Specify the log locations to avoid requiring remote registry access to locate the activity event log files</p>
                                                            </li>
                                                            <li>
                                                                <p>Set on the <b>0.Collection</b> &gt; <b>1-SPAC_SystemScans</b> Job for Activity Auditing</p>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p class="Bold_Subheading">Analysis Configuration</p>
                                        <p>This solution should be run with the default analysis configuration. Most of these analysis tasks are preconfigured. There are a few which are deselected by default, as they are for troubleshooting purposes. </p>
                                        <p>Though the analysis tasks should not be deselected, the following parameters can be modified: </p>
                                        <ul>
                                            <li>
                                                <p>Stale File is defined by default to 365 days</p>
                                                <ul>
                                                    <li>
                                                        <p>Customize within the <b>4.Content</b> &gt; <b>SP_StaleFiles</b> Job</p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>Stale Teams is defined by default to 30 days</p>
                                                <ul>
                                                    <li>
                                                        <p>Customize within the <b>8.M365</b> &gt; <b>SP_StaleTeamSites</b> Job</p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p class="ListContinue">The .Active Directory Inventory Solution defines large groups, deeply nested groups, stale users, and users with large tokens. These parameters can be customized and are applicable to any solution, including SharePoint, which incorporate this analyzed data into further analysis.</p>
                                        <ul>
                                            <li>
                                                <p>Customize within <span style="font-weight: bold;">.Active Directory Inventory</span> &gt; <span style="font-weight: bold;">3-AD_Exceptions</span> Job analysis tasks</p>
                                            </li>
                                        </ul>
                                        <p class="Bold_Subheading">Additional Considerations </p>
                                        <p>The Effective Access Audits Job Group is designed to work independently of the rest of the solution, but it is dependent upon the 0.Collection Job Group and the user-modified CSV files. </p>
                                        <p class="Bold_Subheading">Additional Notes</p>
                                        <p>The jobs contained in the group use custom SQL scripts to render views on collected data. SQL views are used to populate report element tables and graphs. Changing or modifying the group, job, or table names results in no data displayed within the reports or the <span class="mc-variable AIC.Product_Short_Name variable">Access Information Center</span>.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
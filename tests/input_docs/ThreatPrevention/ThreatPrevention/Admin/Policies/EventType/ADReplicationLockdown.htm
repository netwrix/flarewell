<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" /><title>AD Replication Lockdown Event Type</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>AD Replication Lockdown Event Type</h1>
                                        <p>The primary use case of the AD Replication Lockdown event type is to prevent non-domain controllers from using replication APIs.  Each blocked replication attempt results in an event with details.  Make sure the policy has a  ‘white list’ of ‘allowed/known good’ domain controllers  so that legitimate replication is not blocked.</p>
                                        <p>The event filters for the AD Replication Lockdown event type are: </p>
                                        <ul>
                                            <li>
                                                <p>AD Perpetrator</p>
                                            </li>
                                            <li>
                                                <p>Permissions</p>
                                            </li>
                                            <li>
                                                <p>Domains/Servers</p>
                                            </li>
                                            <li>
                                                <p>Hosts (from)</p>
                                            </li>
                                        </ul>
                                        <p style="text-align: center;">
                                            <img src="../../../../Resources/Images/ThreatPrevention/Policies/EventType/ADReplicationLockdown.png" style="width: 914px;height: 547px;" title="Policy window - AD Replication Lockdown Event Type" alt="Policy window - AD Replication Lockdown Event Type" />
                                        </p>
                                        <p>Each filter tab acts like an "AND" statement for the filter. Any filter tab left blank is treated like an "ALL" for that filter set.</p>
                                        <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>Lockdown/blocking policies with blank filters result in everything being locked down or blocked. </p>
                                        <p>Since Windows cannot detect if a sync request is coming from a legitimate domain controller, this event type is designed to block requests from computers that are not ‘allowed’ by the policy. </p>
                                        <p>Legitimate domain controllers must be identified in the event filters. This can be done through one of the following methods:</p>
                                        <ul>
                                            <li>
                                                <p>AD Perpetrator filter</p>
                                                <ul>
                                                    <li>
                                                        <p>Use this filter for a dynamic list of domain controllers </p>
                                                    </li>
                                                    <li>
                                                        <p>Set the filter to "Allow"</p>
                                                    </li>
                                                    <li>
                                                        <p>Add the Users OU &gt; Domain Controllers group</p>
                                                    </li>
                                                    <li>
                                                        <p>Add any other groups containing domain controllers. It triggers an error message reminding the user that only domain controllers should be allowed. </p>
                                                    </li>
                                                    <li>
                                                        <p>Any domain controller not included in these groups are blocked from syncing/replication</p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>Domains/Servers filter</p>
                                                <ul>
                                                    <li>
                                                        <p>Use this filter for a static list of domain controllers</p>
                                                    </li>
                                                    <li>
                                                        <p>Add domain controllers to the Exclude list</p>
                                                    </li>
                                                    <li>
                                                        <p>Any domain controller not excluded is blocked from syncing/replication</p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>Not allowing ALL domain controllers to sync has negative impacts on Active Directory. </p>
                                        <p>If no filters are applied, saving the policy configuration displays a warning message. </p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The AD Replication Lockdown event type internally looks for use of the GetNCChanges() API and blocks the API call when it is invoked by a machine outside the scope of the policy filters. </p>
                                        <h2>AD Perpetrator Filter</h2>
                                        <p>Use the AD Perpetrator filter for lockdown to set the scope of the policy to lockdown specific security principals committing changes or to exclude specific security principals committing changes from being locked down. </p>
                                        <p class="p_5" style="text-align: center;">
                                            <img src="../../../../Resources/Images/ThreatPrevention/Policies/Filters/ADPerpetratorProtect.png" style="width: 816px;height: 353px;" title="AD Perpetrator Protect filter" alt="AD Perpetrator Protect filter" />
                                        </p>
                                        <p>Select the <b>Block</b> or <b>Allow</b> option button and then edit the list. </p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>For the <a href="PasswordEnforcement.htm" target="_parent" title="Password Enforcement Event Type" alt="Password Enforcement Event Type" class="MCXref xref">Password Enforcement Event Type</a>, selecting <b>Allow</b> means that this policy will not validate the new passwords for the accounts listed here. Selecting <b>Block</b> means that this policy will validate the new passwords for the accounts listed here.</p>
                                        <p>Use the buttons in the Perpetrators and Collections of Perpetrators areas to edit the lists. </p>
                                        <ul>
                                            <li>
                                                <p>Perpetrators area – The Add (+) button opens the <a href="Window/SelectActiveDirectory/Perpetrators.htm" title="Navigates to the Select Active Directory Perpetrators selection window. " alt="Navigates to the Select Active Directory Perpetrators selection window. " class="MCXref xref">Select Active Directory Perpetrators Window</a>.</p>
                                            </li>
                                            <li>
                                                <p>Collections of Perpetrators area - The Collection button opens the <a href="../../Configuration/CollectionManager/ListCollections.htm" title="Navigates to the List of Collections section of the Collection Manager menu window. " alt="Navigates to the List of Collections section of the Collection Manager menu window. " class="MCXref xref">List of Collections Window</a> to the appropriate Collection category.</p>
                                            </li>
                                            <li>
                                                <p>The Remove (x) button deletes the selected item(s) from that box.</p>
                                            </li>
                                        </ul>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>To enable a Dynamic Policy, use the Collection button to select the desired Dynamic Collection. See the <a href="../../Configuration/CollectionManager/Dynamic.htm" title="Navigates to the Dynamic Collections section of the Collection Manager menu window. " alt="Navigates to the Dynamic Collections section of the Collection Manager menu window. " class="MCXref xref">Dynamic Collections</a> topic for additional information.</p>
                                        <h2>Permissions Filter</h2>
                                        <p>Use the Permissions  filter to set the scope of the policy for specific replication permissions within Active Directory  that are used to dump password hashes as a fake domain controller in a DCSync/Replication attack.</p>
                                        <p style="text-align: center;">
                                            <img src="../../../../Resources/Images/ThreatPrevention/Policies/Filters/Permissions.png" style="width: 846px;height: 345px;" title="Policy window - Permissions  filter" alt="Policy window - Permissions  filter" />
                                        </p>
                                        <p>The Permissions filter has two sections: </p>
                                        <ul>
                                            <li>
                                                <p>Match condition – Capture the event if the replication request has either the exact permissions specified or has any of the permissions specified. </p>
                                            </li>
                                            <li>
                                                <p>Permissions – Permission level associated with the replication request: </p>
                                                <ul>
                                                    <li>
                                                        <p>Replicate Directory Changes – Base permission and is required to use RPC and LDAP DIRSYNC replication mechanisms </p>
                                                    </li>
                                                    <li>
                                                        <p>Replicate Directory Changes All – Permission required for replication of credentials and secret data </p>
                                                    </li>
                                                    <li>
                                                        <p>Replicate Directory Changes in Filtered Set – Replicates attributes protected by filtered attribute sets (FAS). Read-only Domain Controllers (RODCs) should not have this permission. </p>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                        <h2>Domains/Servers Filter</h2>
                                        <p>Use the Domains/Servers filter to set the scope of the policy  to  specific domains and/or servers or to exclude specific domains and/or servers.</p>
                                        <p class="p_5" style="text-align: center;">
                                            <img src="../../../../Resources/Images/ThreatPrevention/Policies/Filters/DomainsServersMonitoring.png" title="Event Type - Domains/Servers Monitoring filter" alt="Event Type - Domains/Servers Monitoring filter" style="width: 726px;height: 228px;" />
                                        </p>
                                        <p>Use the buttons in the Include and Exclude areas to edit the lists.</p>
                                        <ul>
                                            <li>
                                                <p>The Add (+) buttons open the <a href="Window/SelectDomainsServers.htm" title="Navigates to the Select Domains and Servers selection window. " alt="Navigates to the Select Domains and Servers selection window. " class="MCXref xref">Select Domains and Servers Window</a>. </p>
                                            </li>
                                            <li>
                                                <p>The Collection button opens the <a href="../../Configuration/CollectionManager/ListCollections.htm" title="Navigates to the List of Collections section of the Collection Manager menu window. " alt="Navigates to the List of Collections section of the Collection Manager menu window. " class="MCXref xref">List of Collections Window</a> to the appropriate Collection category.</p>
                                            </li>
                                            <li>
                                                <p>The Remove (x) button deletes the selected item(s) from that box.</p>
                                            </li>
                                        </ul>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>To enable a Dynamic Policy, use the Collection button to select the desired Dynamic Collection. See the <a href="../../Configuration/CollectionManager/Dynamic.htm" title="Navigates to the Dynamic Collections section of the Collection Manager menu window. " alt="Navigates to the Dynamic Collections section of the Collection Manager menu window. " class="MCXref xref">Dynamic Collections</a> topic for additional information.</p>
                                        <h2>Hosts (from) Filter</h2>
                                        <p>Use the Hosts (from) filter for the AD Replication Lockdown event type to set the scope of the policy to only lockdown specific hosts as originators of an event.</p>
                                        <p style="text-align: center;">
                                            <img src="../../../../Resources/Images/ThreatPrevention/Policies/Filters/ADReplicationHostsFrom.png" style="width: 820px;height: 409px;" title="Policy window - Hosts (from) filter for the AD Replication Lockdown event type" alt="Policy window - Hosts (from) filter for the AD Replication Lockdown event type" />
                                        </p>
                                        <p>Select the <b>Block</b> or <b>Allow</b> option button and then edit the list.</p>
                                        <p>Use the buttons in the Include Hosts and Include Collections areas to edit the lists.</p>
                                        <ul>
                                            <li>
                                                <p>The Hosts Add (+) button opens the <a href="Window/SelectComputers.htm" title="Navigates to the Select Computer Window section" alt="Navigates to the Select Computer Window section" class="MCXref xref">Select Computer Window</a>. </p>
                                            </li>
                                            <li>
                                                <p>The Collection button opens the <a href="../../Configuration/CollectionManager/ListCollections.htm" title="Navigates to the List of Collections section of the Collection Manager menu window. " alt="Navigates to the List of Collections section of the Collection Manager menu window. " class="MCXref xref">List of Collections Window</a> to the appropriate Collection category. </p>
                                            </li>
                                            <li>
                                                <p>The Remove (x) button deletes the selected item(s) from that box.</p>
                                            </li>
                                        </ul>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>To enable a Dynamic Policy, use the Collection button to select the desired Dynamic Collection. See the <a href="../../Configuration/CollectionManager/Dynamic.htm" title="Navigates to the Dynamic Collections section of the Collection Manager menu window. " alt="Navigates to the Dynamic Collections section of the Collection Manager menu window. " class="MCXref xref">Dynamic Collections</a> topic for additional information.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
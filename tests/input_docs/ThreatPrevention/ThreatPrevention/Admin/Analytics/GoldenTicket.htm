<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Golden Ticket Analytic Type</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link href="../../../Resources/TableStyles/Sb Table 1.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>Golden Ticket Analytic Type</h1>
                                        <p>The <b>Golden Tickets</b> analytic type identifies Kerberos tickets that exceed the specified maximum lifetimes for a user ticket or maximum lifetimes for a user ticket renewal. Every time an account authenticates, the ticket is checked against the maximum ticket lifetime and maximum renewals configured within this analytic type. Any ticket that exceeds either ‘maximum’ will trigger an incident.</p>
                                        <table align="center" style="margin-left: auto;margin-right: auto;border-collapse: collapse;mc-table-style: url('../../../Resources/TableStyles/Sb Table 1.css');" class="TableStyle-Sb_Table_1" cellspacing="21">
                                            <col style="width: 153pt;" class="TableStyle-Sb_Table_1-Column-Column1" />
                                            <col style="width: 315pt;" class="TableStyle-Sb_Table_1-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Sb_Table_1-Head-Header1">
                                                    <th class="TableStyle-Sb_Table_1-HeadE-Column1-Header1">
                                                        <p class="p_10">Golden Tickets</p>
                                                    </th>
                                                    <th class="TableStyle-Sb_Table_1-HeadD-Column1-Header1">
                                                        <p class="p_9">&#160;</p>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                    <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                        <p class="p_11">Definition</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                        <p class="p_4">Kerberos tickets with modified maximum lifetimes for a user ticket and maximum lifetimes for a user ticket renewal</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                    <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body2">
                                                        <p class="p_11">Example</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body2">
                                                        <p>Kerberos tickets are used as a sort of “pass card” to obtain access to resources. Once a domain controller authenticates a user, a TGT (ticket granting ticket) is granted with a limited lifespan. This is then used to obtain TGS (ticket granting service) and the TGS is what identifies a user to a resource on the network. </p>
                                                        <p class="p_4">On TGT expiry, the user account is checked for validity (password, enabled/disabled, group memberships, etc.) and a new TGT is granted. A known vulnerability exists where a domain admin could forge the TGT renewal time, creating an indefinite “golden” ticket. This could be accomplished, and then the underlying account removed, allowing the user to obtain admin access forever with an account that no longer exists. If a user on the network were to attempt to use such a ticket, this analytic would detect the altered ticket and generate an alert.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                    <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                        <p class="p_11">Trigger</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                        <p class="p_4">Maximum lifetime for a user ticket &gt; than X hours</p>
                                                        <p class="p_4">OR</p>
                                                        <p class="p_4">Maximum lifetime for a user ticket renewal &gt; Y days</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                    <td class="TableStyle-Sb_Table_1-BodyB-Column1-Body2">
                                                        <p class="p_11">Recommended Settings</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyA-Column1-Body2">
                                                        <p class="p_4"><span class="mc-variable Netwrix.Company variable">Netwrix</span> recommends configuring this analytic to trigger a hit if the maximum lifetime for a user ticket is greater than 24 hours or the maximum lifetime for a user ticket renewal is greater than 30 days.</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p class="Bold_Subheading">Analytic Workflow</p>
                                        <ol>
                                            <li value="1">
                                                <p>Configure the analytic policy</p>
                                            </li>
                                            <li value="2">
                                                <p>Enable the analytic policy</p>
                                            </li>
                                            <li value="3">
                                                <p>Enable alerting on incidents through the <a href="../Configuration/SystemAlerting/Overview.htm" title="System Alerting Window" alt="System Alerting Window" target="_parent" class="MCXref xref">System Alerting Window</a>.</p>
                                            </li>
                                        </ol>
                                        <p>See the <a href="#_Golden_Tickets_Analytic" title="Golden Tickets Analytic Data Grid" alt="Golden Tickets Analytic Data Grid" class="MCXref xref">Golden Tickets Analytic Data Grid</a> topic for information on event data collected per incident.</p>
                                        <h2>Configure Golden Tickets Analytic Policy</h2>
                                        <p>Open the Golden Tickets Analytic Policy in any of the following ways:</p>
                                        <ul>
                                            <li>
                                                <p>Click Analytics in the left pane to launch the Analytics interface. Then click the gear icon for the analytic.</p>
                                            </li>
                                            <li>
                                                <p>Expand the Analytics node and click the desired analytic. On the analytic window, click the gear icon available in the top right corner.</p>
                                            </li>
                                        </ul>
                                        <p>The Configure Analytics window has two tabs:</p>
                                        <ul>
                                            <li>
                                                <p>Settings – Where the analytic trigger is defined</p>
                                            </li>
                                            <li>
                                                <p>Policy – Where filters can be added, additional actions configured, a custom schedule set, and the policy enabled</p>
                                            </li>
                                        </ul>
                                        <p class="Bold_Subheading">Settings Tab</p>
                                        <p style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Analytics/GoldenTicketSettings.png" title="Golden Ticket Analytic Type - Settings tab" alt="Golden Ticket Analytic Type - Settings tab" />
                                        </p>
                                        <p>Set the <i>Maximum Lifetime for User Ticket [value] Hours</i> and the <i>Maximum Lifetime for User Ticket Renewal [value] Days</i> to trigger the incident. The default Microsoft Windows lifetime for user tickets is ten hours, and the renewal period is seven days. This analytic policy will check each ticket that requests authentication against the values set in this analytic policy. Any time a ticket exceeds either of these values, an incident is triggered.</p>
                                        <p class="Bold_Subheading">Policy Tab</p>
                                        <p class="p_5" style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Analytics/PolicyTab.png" style="width: 684px;height: 667px;" title="Golden Ticket Analytic Type - Policy tab" alt="Golden Ticket Analytic Type - Policy tab" />
                                        </p>
                                        <p>The <b>Policy</b> tab for configuring analytics consists of three sub-tabs:</p>
                                        <ul>
                                            <li>
                                                <p>General tab – Configured the same way a regular policy’s <a href="../Policies/General.htm" title="General Tab" alt="General Tab" target="_parent" class="MCXref xref">General Tab</a> is configured. The only exception is that the Name and Description are hard coded, and cannot be modified. The Tags field is disabled for analytics.</p>
                                            </li>
                                            <li>
                                                <p>Event Type tab – Configured the same way a regular policy’s <a href="../Policies/EventType/Overview.htm" target="_parent" title="Event Type Tab" alt="Event Type Tab" class="MCXref xref">Event Type Tab</a> is configured. The only exception is that the <a href="../Policies/EventType/AuthenticationMonitoring.htm" title="Authentication Monitoring Event Type" alt="Authentication Monitoring Event Type" target="_parent" class="MCXref xref">Authentication Monitoring Event Type</a> is hard coded, and the Success filter cannot be modified.</p>
                                                <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>Do not configure any filters for this analytic type.</p>
                                                <ul>
                                                    <li>
                                                        <p><i>Optional:</i> Scope the protocol to be monitored on the Authentication Protocol filter. If enabling the analytic on a domain controller, also scope the login type.</p>
                                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The <span class="span_1">Exclude failed authentications with ‘N-2’ passwords</span> option requires a GPO within the organization be configured to ‘Enforce password history’ with a setting of a minimum of ‘3 passwords remembered’ or it will not have an effect.</p>
                                                    </li>
                                                    <li>
                                                        <p><i>Optional:</i><![CDATA[  ]]>Scope the domains to be included in or excluded from monitoring on the Domains/Servers filter.</p>
                                                    </li>
                                                    <li>
                                                        <p><i>Optional:</i><![CDATA[  ]]>Scope the accounts to include in or exclude from being monitored on the AD Perpetrator filter.</p>
                                                    </li>
                                                    <li>
                                                        <p><i>Optional:</i><![CDATA[  ]]>Scope the servers to be included in or excluded from monitoring on the IP Addresses (from) filter, the IP Addresses (to) filter, the Hosts (from) filter, or the Hosts (to) filter.</p>
                                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>Some authentication events may return only a host name (NetBIOS or FQDN), others may return only an IP address. It is recommended to take this into account when entering filter values.</p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>Actions tab – Configured the same way a regular policy’s <a href="../Policies/Actions/Overview.htm" title="Navigates to the Actions Tab section" alt="Navigates to the Actions Tab section" class="MCXref xref">Actions Tab</a> is configured. The only exceptions are that the “Send to Event DB” and “Email Notifications” options are disabled. The event data collected by analytic policies are stored in memory until an incident is triggered. For the “Send Raw Data to SIEM” option, use <i>caution</i>, as this will send all event data not the triggered incident, which could be a large volume of data. To send notifications on incidents, use the <a href="../Configuration/SystemAlerting/Overview.htm" title="System Alerting Window" alt="System Alerting Window" target="_parent" class="MCXref xref">System Alerting Window</a> to configure Email and SIEM alerts. </p>
                                            </li>
                                        </ul>
                                        <h2><a name="_Golden_Tickets_Analytic"></a>Golden Tickets Analytic Data Grid</h2>
                                        <p>The data grid on the <b>Golden Tickets</b> node lists one row per incident identified.</p>
                                        <p class="p_5" style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Analytics/GoldenTicket.png" title="Golden Ticket Analytic Type  window" style="width: 870px;height: 372px;" alt="Golden Ticket Analytic Type  window" />
                                        </p>
                                        <p>The data grid can be filtered according to the Event Tracker status: All, New, or Reviewed. See the <a href="../Policies/RecentEvents/EventTracker.htm" title="Event Tracker Window" alt="Event Tracker Window" target="_parent" class="MCXref xref">Event Tracker Window</a> topic  for additional information.</p>
                                        <p>The top data grid includes the following information for each incident:</p>
                                        <ul>
                                            <li>
                                                <p>From Host – Name of the originating host</p>
                                            </li>
                                            <li>
                                                <p>From Host IP Address – IP address of the originating host</p>
                                            </li>
                                            <li>
                                                <p>To Host – Name of the target host</p>
                                            </li>
                                            <li>
                                                <p>To Host IP Address – IP address of the target host</p>
                                            </li>
                                            <li>
                                                <p>Account Name – Security principal of the account that triggered the incident</p>
                                            </li>
                                            <li>
                                                <p>Account SID – Security Identifier of the account used in the event that triggered the incident</p>
                                            </li>
                                            <li>
                                                <p>Access Type – Type of authentication, e.g. RDP, CIFS, etc.</p>
                                            </li>
                                            <li>
                                                <p>Status – Indication of whether the authentication was successful</p>
                                            </li>
                                            <li>
                                                <p>Date/Time – Date timestamp of the monitored event. Hover over the data in this column to view the local time (of the Enterprise Manager) and UTC time simultaneously.</p>
                                            </li>
                                            <li>
                                                <p>Detected on DC – Fully-qualified name of the domain controller that detected the event</p>
                                            </li>
                                            <li>
                                                <p>TGT StartTime – Date timestamp for the start time of the ticket; the specified time is the local time for the server where the  Agent is deployed</p>
                                            </li>
                                            <li>
                                                <p>TGT EndTime – Date timestamp for the expiration time of the ticket; the specified time is the local time for the server where the  Agent is deployed</p>
                                            </li>
                                            <li>
                                                <p>TGT MaxRenew – Date timestamp for the maximum renewal date of the ticket; the specified time is the local time for the server where the  Agent is deployed</p>
                                            </li>
                                            <li>
                                                <p>Agent Time Logged – Timestamp for when the Agent detected the event. This can be different from the Enterprise Manager time (displayed in the Date/Time column) due to latency.</p>
                                            </li>
                                        </ul>
                                        <p>This data grid employs features for sorting, filtering, searching, and more. See the <a href="../Navigation/DataGrid.htm" target="_parent" title="Data Grid Functionality" alt="Data Grid Functionality" class="MCXref xref"> Data Grid Functionality</a> topic for additional information.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
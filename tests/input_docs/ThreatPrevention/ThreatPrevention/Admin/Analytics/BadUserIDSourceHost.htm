<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Bad User ID (by Source Host) Analytic Type</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link href="../../../Resources/TableStyles/Sb Table 1.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>Bad User ID (by Source Host) Analytic Type</h1>
                                        <p>The <b>Bad User ID (by source host)</b> analytic type identifies pre-authentication failures due to using account names that cannot be found in Active Directory. These incidents are grouped per source host. Every time a previously unseen machine is the source of a failed login due to bad user name, an incident is stored in the database. The count for the number of attempts is incremented each time that same machine attempts to authenticate with a bad user name until the specified day limit expires. After the time expires, any additional attempt will generate a new incident. This allows for a report on the number of times a particular host used bad user accounts to try to login during the time frame. </p>
                                        <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>Configure the day limit to 30 days.</p>
                                        <table align="center" style="margin-left: auto;margin-right: auto;border-collapse: collapse;mc-table-style: url('../../../Resources/TableStyles/Sb Table 1.css');" class="TableStyle-Sb_Table_1" cellspacing="21">
                                            <col style="width: 153pt;" class="TableStyle-Sb_Table_1-Column-Column1" />
                                            <col style="width: 315pt;" class="TableStyle-Sb_Table_1-Column-Column1" />
                                            <thead>
                                                <tr class="TableStyle-Sb_Table_1-Head-Header1">
                                                    <th class="TableStyle-Sb_Table_1-HeadE-Column1-Header1">
                                                        <p class="p_10">Bad User ID (by source host)</p>
                                                    </th>
                                                    <th class="TableStyle-Sb_Table_1-HeadD-Column1-Header1">
                                                        <p class="p_9">&#160;</p>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                    <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                        <p class="p_11">Definition</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                        <p class="p_4">Pre-authentication failures using one or more non-existing user IDs</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                    <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body2">
                                                        <p class="p_11">Example</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body2">
                                                        <p class="p_4">Similar to the “Bad User ID (by User)” analytic type, this analytic looks for multiple failed authentications against non-existing accounts, but from a single source host. This analytic identifies a perpetrator that hunts for accounts from a single source computer.</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                    <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                        <p class="p_11">Trigger</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                        <p class="p_4">Any number of failed authentication attempts using non-existing accounts made from a specific host</p>
                                                    </td>
                                                </tr>
                                                <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                    <td class="TableStyle-Sb_Table_1-BodyB-Column1-Body2">
                                                        <p class="p_11">Recommended Settings</p>
                                                    </td>
                                                    <td class="TableStyle-Sb_Table_1-BodyA-Column1-Body2">
                                                        <p class="p_4">Bad User ID (by source host) groups attacks by where failed authentication attempts by non-existing accounts are coming from to trigger analytic hits. The user-configurable parameter is based on time, where time is used to visualize how often an attempt is made to authenticate using a non-existing account from an individual system.</p>
                                                        <p class="p_4"><span class="mc-variable Netwrix.Company variable">Netwrix</span> recommends setting the default value to 30 days. If a failed authentication attempt using a non-existing account  occurs from the same host after the 30 day time period, a new analytic hit will be produced rather than incrementing the previous hit count.</p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p class="Bold_Subheading">Analytic Workflow</p>
                                        <ol>
                                            <li value="1">
                                                <p>Configure the analytic policy</p>
                                            </li>
                                            <li value="2">
                                                <p>Enable the analytic policy</p>
                                            </li>
                                            <li value="3">
                                                <p>Enable alerting on incidents through the <a href="../Configuration/SystemAlerting/Overview.htm" title="System Alerting Window" alt="System Alerting Window" target="_parent" class="MCXref xref">System Alerting Window</a>.</p>
                                            </li>
                                        </ol>
                                        <p>See the <a href="#_Bad_User_ID_1" title="Bad User ID (by Source Host) Analytic Data Grid" alt="Bad User ID (by Source Host) Analytic Data Grid" class="MCXref xref">Bad User ID (by Source Host) Analytic Data Grid</a> topic for information on event data collected per incident.</p>
                                        <h2>Configure Bad User ID (by Source Host) Analytic Policy</h2>
                                        <p>Open the Bad User ID (by source host) Analytic Policy in any of the following ways:</p>
                                        <ul>
                                            <li>
                                                <p>Click Analytics in the left pane to launch the Analytics interface. Then click the gear icon for the analytic.</p>
                                            </li>
                                            <li>
                                                <p>Expand the Analytics node and click the desired analytic. On the analytic window, click the gear icon available in the top right corner.</p>
                                            </li>
                                        </ul>
                                        <p>The Configure Analytics window has two tabs:</p>
                                        <ul>
                                            <li>
                                                <p>Settings – Where the analytic trigger is defined</p>
                                            </li>
                                            <li>
                                                <p>Policy – Where filters can be added, additional actions configured, a custom schedule set, and the policy enabled</p>
                                            </li>
                                        </ul>
                                        <p class="Bold_Subheading">Settings Tab</p>
                                        <p class="Bold_Subheading" style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Analytics/BadUserIDSettings.png" title="Bad User ID (by Source Host) Analytic Type - Settings tab" alt="Bad User ID (by Source Host) Analytic Type - Settings tab" style="width: 641px;height: 190px;" />
                                        </p>
                                        <p>Set the <span class="span_3" style="font-weight: bold;">Number of Days</span> for which repeated authentication attempts by a machine using a bad user account will be tallied. An incident will be triggered for every previously unseen host that has a bad user account attempt login. Each additional attempt for the same host will be added to the total number of attempts through the limit of days set here, e.g. 30 days. After this number of days has elapsed from the first attempt, a new incident will be triggered for any additional attempt with a new count.</p>
                                        <p class="Bold_Subheading">Policy Tab</p>
                                        <p class="Bold_Subheading" style="font-weight: normal;text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Analytics/PolicyTab.png" style="width: 686px;height: 669px;" title="Bad User ID (by Source Host) Analytic Type - Policy tab" alt="Bad User ID (by Source Host) Analytic Type - Policy tab" />
                                        </p>
                                        <p>The <span class="span_1" style="font-weight: bold;">Policy</span> tab for configuring analytics consists of three sub-tabs:</p>
                                        <ul>
                                            <li>
                                                <p>General tab –  Configured the same way a regular policy’s <a href="../Policies/General.htm" title="General Tab" alt="General Tab" target="_parent" class="MCXref xref">General Tab</a> is configured. The only exception is that the Name and Description are hard coded, and cannot be modified. The Tags field is disabled for analytics.</p>
                                            </li>
                                            <li>
                                                <p>Event Type tab – Configured the same way a regular policy’s <a href="../Policies/EventType/Overview.htm" target="_parent" title="Event Type Tab" alt="Event Type Tab" class="MCXref xref">Event Type Tab</a> is configured. The only exception is that the <a href="../Policies/EventType/AuthenticationMonitoring.htm" title="Authentication Monitoring Event Type" alt="Authentication Monitoring Event Type" target="_parent" class="MCXref xref">Authentication Monitoring Event Type</a> is hard coded, and the Success filter cannot be modified. Additionally, there is no AD Perpetrator filter.</p>
                                                <ul>
                                                    <li>
                                                        <p><i>Optional:</i> Scope the protocol to be monitored on the Authentication Protocol filter. If enabling the analytic on a domain controller, also scope the login type.</p>
                                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The <span class="span_1">Exclude failed authentications with ‘N-2’ passwords</span> option requires a GPO within the organization be configured to ‘Enforce password history’ with a setting of a minimum of ‘3 passwords remembered’ or it will not have an effect.</p>
                                                    </li>
                                                    <li>
                                                        <p><i>Optional:</i> Scope the domains to be included in or excluded from monitoring on the Domains/Servers filter.</p>
                                                    </li>
                                                    <li>
                                                        <p><i>Optional:</i> Scope the servers to be included in or excluded from monitoring on the IP Addresses (from) filter, the IP Addresses (to) filter, the Hosts (from) filter, or the Hosts (to) filter.</p>
                                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>Some authentication events may return only a host name (NetBIOS or FQDN), others may return only an IP address. It is recommended to take this into account when entering filter values.</p>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li>
                                                <p>Actions tab – Configured the same way a regular policy’s <a href="../Policies/Actions/Overview.htm" title="Navigates to the Actions Tab section" alt="Navigates to the Actions Tab section" class="MCXref xref">Actions Tab</a> is configured. The only exceptions are that the “Send to Event DB” and “Email Notifications” options are disabled. The event data collected by analytic policies are stored in memory until an incident is triggered. For the “Send Raw Data to SIEM” option, use <i>caution</i>, as this will send all event data not the triggered incident, which could be a large volume of data. To send notifications on incidents, use the <a href="../Configuration/SystemAlerting/Overview.htm" title="System Alerting Window" alt="System Alerting Window" target="_parent" class="MCXref xref">System Alerting Window</a> to configure Email and SIEM alerts. </p>
                                            </li>
                                        </ul>
                                        <h2><a name="_Bad_User_ID_1"></a>Bad User ID (by Source Host) Analytic Data Grid</h2>
                                        <p>The data grid on the <b>Bad User ID (by source host)</b> node lists one row per incident identified. These incidences are grouped per unique source machine.</p>
                                        <p class="p_24" style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Analytics/BadUserIDSourceHost.png" title="Bad User ID by Source Host window" style="width: 905px;height: 632px;" alt="Bad User ID by Source Host window" />
                                        </p>
                                        <p>The data grid can be filtered according to the Event Tracker status: All, New, or Reviewed. See the <a href="../Policies/RecentEvents/EventTracker.htm" title="Event Tracker Window" alt="Event Tracker Window" target="_parent" class="MCXref xref">Event Tracker Window</a> topic  for additional information.</p>
                                        <p>The top data grid includes the following information for each incident:</p>
                                        <ul>
                                            <li>
                                                <p>Attacking Host – Name of the originating host</p>
                                            </li>
                                            <li>
                                                <p>Attacking Host IP Address – IP address of the originating host</p>
                                            </li>
                                            <li>
                                                <p>Last Attempt –  Date timestamp of the last event that triggered the incident. Hover over the data in this column to view the local time (of the Enterprise Manager) and UTC time simultaneously.</p>
                                            </li>
                                            <li>
                                                <p>Number of Accounts –  Number of unique accounts that attempted to login from this host</p>
                                            </li>
                                            <li>
                                                <p>Protocols – Protocol(s) used for the monitored operation</p>
                                            </li>
                                            <li>
                                                <p>Number of Attempts – Number of attempts monitored during the specified interval matching this rule</p>
                                            </li>
                                            <li>
                                                <p>Number of Hosts – Number of hosts accessed during the specified interval matching this rule </p>
                                            </li>
                                        </ul>
                                        <p>Select an incident in the top data grid to view information on the events that triggered the incident:</p>
                                        <ul>
                                            <li>
                                                <p>Account Name – Name of the bad user account that attempted to login</p>
                                            </li>
                                            <li>
                                                <p>To Host – Name of the target host</p>
                                            </li>
                                            <li>
                                                <p>To Host IP Address – IP address of the target host</p>
                                            </li>
                                            <li>
                                                <p>Protocol – Protocol(s) used for the monitored operation</p>
                                            </li>
                                            <li>
                                                <p>Access Type – Type of authentication, e.g. RDP, CIFS, etc.</p>
                                            </li>
                                            <li>
                                                <p>Status – Detailed information on the error generated by the event</p>
                                            </li>
                                            <li>
                                                <p>Detected on DC – Fully-qualified name of the domain controller that detected the event</p>
                                            </li>
                                            <li>
                                                <p>Events Count – Number of identical events that occurred in one minute</p>
                                            </li>
                                            <li>
                                                <p>Date/Time – Date timestamp of the monitored event. Hover over the data in this column to view the local time (of the Enterprise Manager) and UTC time simultaneously.</p>
                                            </li>
                                            <li>
                                                <p>Agent Time Logged – Timestamp for when the Agent detected the event. This can be different from the Enterprise Manager time (displayed in the Date/Time column) due to latency.</p>
                                            </li>
                                        </ul>
                                        <p>This data grid employs features for sorting, filtering, searching, and more. See the <a href="../Navigation/DataGrid.htm" target="_parent" title="Data Grid Functionality" alt="Data Grid Functionality" class="MCXref xref"> Data Grid Functionality</a> topic for additional information.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|Configuration" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Event Filtering Configuration Window</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>Event Filtering Configuration Window</h1>
                                        <p>The Event Filtering Configuration window enables you to exclude specific Active Directory and Authentication events from being monitored. A latency threshold can be set to generate alerts for AD events. </p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>This window is only available to <span class="mc-variable SI.Product variable">Threat Prevention</span> administrators.</p>
                                        <p>Follow the steps to enable event filtering.</p>
                                        <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Click <b>Configuration</b> &gt; <b>Event Filtering</b> on the menu to open the Event Filtering Configuration window.</p>
                                        <p class="p_5" style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Configuration/EventFiltering/EventFiltering.png" alt="Event Filtering Configuration Window" title="Event Filtering Configuration Window" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>The filter options are grouped by AD Global Pre Filters, Authentication Global Pre Filters, and Alerts. Check the checkboxes to activate the filters and click <b>Save</b>. </p>
                                        <p>To disable a filter for diagnostic purposes, simply uncheck  its checkbox and click <b>Save</b>. </p>
                                        <p>Click the Help icon (?) for an option in the  AD Global Pre Filters area to view the  type of “noise” events being filtered.</p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>All Authentication Global Pre Filters options require configuration before they can be enabled.</p>
                                        <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>Enable all the AD Global Pre Filters options as well as the Exclude Logins from Machine Accounts option in the Authentication Global Pre Filters section.</p>
                                        <p>When activated, the Agent filters out the event data according to configurations defined in the <span class="span_6">filters.json</span> file located in the installation directory of the Enterprise Manager. </p>
                                        <h2>Exclude ‘Noise’ Events Option</h2>
                                        <p>The Exclude ‘Noise’ Events option is enabled by default to filter out login and internal low level attributes that can be considered ‘noise’ events, resulting in a bloating of the database. This option can be scoped to include any combination of the following ‘noise’ events:</p>
                                        <ul>
                                            <li>Successful AD User Logins – Excludes events with the following attributes where ‘objectClass’ does not equal computer:<ul><li>logonCount</li><li>lastLogon</li><li>badPwdCount</li><li>lastLogonTimestamp</li></ul></li>
                                            <li>AD User Logins with Bad Password – Excludes events with the following set of attributes where ‘objectClass’ does not equal computer:<ul><li>badPwdCount</li><li>badPasswordTime</li></ul></li>
                                            <li>AD Computer Logins – Excludes events with the following set of attributes where ‘objectClass’ equals computer:<ul><li>logonCount</li><li>lastLogon</li><li>badPwdCount</li><li>lastLogonTimestamp</li><li>badPasswordTime</li><li>badPwdCount</li></ul></li>
                                            <li>Low Level Attributes – Excludes the following attributes from event:<ul><li>ImPwdHistory</li><li>dBCSPwd</li><li>ntPwdHistory</li></ul></li>
                                        </ul>
                                        <h2>Exclude AD DNS Events Option</h2>
                                        <p>The Exclude AD DNS Events option is enabled by default to filter out DNS events. These events can result in a bloating of the database. They must meet both of the following conditions to be excluded:</p>
                                        <ul>
                                            <li>objectClass = ‘dnsNode’ or ‘dnsZone’</li>
                                            <li>Contains the ‘dnsRecord’ or ‘dNSTombstoned’ attribute</li>
                                        </ul>
                                        <p>When the Exclude AD DNS Events checkbox is unchecked, DNS record events are displayed in a human-readable format on the Recent Events tab of the Active Directory policy. In order to search these results, the Affected Object: Class can be set to equals <span class="span_1">dnsNode</span> for the dnsRecord attribute to display. </p>
                                        <h2>Exclude Logins from Machine Accounts Option</h2>
                                        <p>The Exclude Logins from Machine Accounts option is enabled by default to filter out machine logins. These events can result in a bloating of the database. Click the <b>configure</b> link to open the Edit Collection window. </p>
                                        <p style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Configuration/EventFiltering/EditCollectionMachineAccounts.png" alt="Edit Collection window - For Machine Accounts" style="width: 752px;height: 412px;" title="Edit Collection window - For Machine Accounts" />
                                        </p>
                                        <p>The Exclude Logins from Machine Accounts collection is only accessible  through the Event Filtering Configuration window. Either use the <b>Add</b> (+) button to open the <a href="../Policies/EventType/Window/SelectActiveDirectory/Perpetrators.htm" title="Navigates to the Select Active Directory Perpetrators window section of the Event Filter selection windows. " alt="Navigates to the Select Active Directory Perpetrators window section of the Event Filter selection windows. " class="MCXref xref">Select Active Directory Perpetrators Window</a> to browse for machine accounts or type the account name in the textbox. </p>
                                        <p>Only perpetrators with accounts ending in “$” are considered for this filter. Wild cards (*) can be used for partial matches to account names.</p>
                                        <p>All machine accounts in the textbox are either included or excluded from event data monitoring by the Agent. Machine accounts not in the list have the unselected property applied. </p>
                                        <p>Select one of the following radio buttons to apply to the list of account names:</p>
                                        <ul>
                                            <li>Pass to agent on match – Included and passed to the Agent for event data monitoring. Machine accounts not in the list are excluded and ignored by the Agent. </li>
                                            <li>Remove on match – Excluded and ignored by the Agent. Machine accounts not in the list are included and sent to the Agent for event data monitoring. </li>
                                        </ul>
                                        <p>Repeat the process until all machine accounts to be included or excluded from Authentication event data have been entered in the list. Then click <b>OK</b>.</p>
                                        <p class="Bold_Subheading">Usage Tip</p>
                                        <p>Windows Server 2012 introduced gMSA (Group Managed Service Accounts). gMSA accounts include “$” in their names, so by default <span class="mc-variable SI.Product variable">Threat Prevention</span> filters out authentication traffic generated by these accounts because they ‘look’ like machine accounts which prior to Server 2012 were the only account names ending in “$”. The ability in <span class="mc-variable SI.Product variable">Threat Prevention</span> to add a list of filter strings to the “Exclude Logins from Machine Accounts” global filter enables you to capture activity by gMSA type accounts as this activity is typically of interest whereas true ‘machine accounts’ is not. By supplying either an explicit list of gMSA account names, or if a naming convention has been adopted, a set of wild card strings such as “gMSA*” or “svc*”, allows capturing authentication activity from such accounts while ignoring the noisy ‘machine accounts’.</p>
                                        <h2>Exclude Authentication Events from Selected Hosts Option</h2>
                                        <p>The Exclude Authentication Events from Selected Hosts option is disabled by default as it requires configuration before it can be enabled. Click the <b>selected hosts</b> link to open the Edit Collection window. </p>
                                        <p style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Configuration/EventFiltering/EditCollectionHosts.png" alt="Edit Collection window - For Hosts" style="width: 752px;height: 413px;" title="Edit Collection window - For Hosts" />
                                        </p>
                                        <p>The Exclude Authentication Events from Hosts collection is only accessible through the Event Filtering Configuration window. All three methods of identification for a host (IP address, NETBIOS host name, or DNS host name) must be known in order to effectively exclude authentication from the host. Identify the host to be excluded in the textbox under the IP Address column and hit <b>Enter</b> or select the next row in the grid. <span class="mc-variable SI.Product variable">Threat Prevention</span> attempts to discover the NETBIOS host name and the DNS host name associated with the supplied IP address. If the host identification is not resolved or is inaccurate, manually type the information. </p>
                                        <p>Repeat the process until all hosts for which authentication event data will not be collected have been entered in the list. Then click <b>OK</b>. The Edit Collection window closes, and the Exclude Authentication Events from selected hosts option can be enabled.</p>
                                        <h2>Exclude Authentication Events from Selected Accounts Option</h2>
                                        <p>The Exclude Authentication Events from Selected Accounts option is disabled by default as it requires configuration before it can be enabled. Click the <span class="span_1">selected accounts</span> link to open the Edit Collection window. </p>
                                        <p style="text-align: center;">
                                            <img src="../../../Resources/Images/ThreatPrevention/Configuration/EventFiltering/EditCollectionAccounts.png" style="width: 775px;height: 424px;" title="Edit Collection window - For Selected Accounts" alt="Edit Collection window - For Selected Accounts" />
                                        </p>
                                        <p>The Exclude Authentication Events from Selected Accounts collection is only accessible through the Event Filtering Configuration window. Use the <b>Add</b> (+) button to open the <a href="../Policies/EventType/Window/SelectActiveDirectory/Perpetrators.htm" title="Navigates to the Select Active Directory Perpetrators window section of the Event Filter selection windows. " alt="Navigates to the Select Active Directory Perpetrators window section of the Event Filter selection windows. " class="MCXref xref">Select Active Directory Perpetrators Window</a>  to browse for the desired accounts. Account names [domain name\account] can also be typed in the textbox. Wild cards (*) can be used as part of either the domain name or account. An asterisk (*) appearing anywhere other than as the first character or the last character are treated as a literal character instead of as a wild card. For example: *\Service1 would exclude all Service1 accounts whether it is a domain or local account, and Example\Service* would exclude all accounts that start with “Service” for the Example domain. </p>
                                        <p>Repeat the process until all accounts to be excluded from Authentication event data have been entered in the list. Then click OK. The Edit Collection window closes, and the Exclude Authentication Events from selected accounts option can be enabled.</p>
                                        <h2>AD Events Latency Threshold Option</h2>
                                        <p>The Send Latency Alerts option is disabled by default. It is used to generate alerts if the time delay between when the Agent detects an AD event and the time the Enterprise Manager receives it exceeds the specified latency threshold. This option is helpful for troubleshooting when experiencing slow connection in the environment. These events can result in a bloating of the database especially if the latency threshold is set too low.</p>
                                        <p>Select the Send Latency Alerts checkbox to enable this option. Use the arrows, or type into the textbox, to set the latency threshold in minutes for the time when the Agent detects the event and the Enterprise Manager receives it. When events exceed the timeframe, alerts are displayed in the <a href="../Alerts/Overview.htm" title="Navigates to the Alerts Interface topic. " alt="Navigates to the Alerts Interface topic. " class="MCXref xref">Alerts Interface</a>. Email or SIEM alerts can be generated by selecting the Agent Latency checkbox in the Operations tab of the <a href="SystemAlerting/Overview.htm" title="System Alerting Window" alt="System Alerting Window" target="_parent" class="MCXref xref">System Alerting Window</a>. </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Certificate Management Wizard</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>Certificate Management Wizard</h1>
                                        <p>The Certificate Management Wizard is a standalone component used to configure <span class="mc-variable SI.Product variable">Threat Prevention</span> Enterprise Manager to use custom managed certificates that are created and signed by an external certificate authority. This provides customers with the option to use certificates signed by their certificate authority instead of the default certificate authority in <span class="mc-variable SI.Product variable">Threat Prevention</span> Enterprise Manager. </p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>As a requirement for using custom managed certificates, you must provide the Enterprise Manager server DNS name, hostname, or FQDN (instead of the IP address) when installing the following:</p>
                                        <ul>
                                            <li>
                                                <p><span class="mc-variable SI.Product variable">Threat Prevention</span> server</p>
                                            </li>
                                            <li>
                                                <p>Remote instance of the <span class="mc-variable SI.Product_2 variable">Administration Console</span></p>
                                            </li>
                                            <li>
                                                <p>Agent</p>
                                            </li>
                                        </ul>
                                        <p>See the  <a href="../Troubleshooting/EnterpriseManagerCommunication.htm" target="_parent" title="Administration Console and Agent Not Communicating with the Enterprise Manager" alt="Administration Console and Agent Not Communicating with the Enterprise Manager" class="MCXref xref">Administration Console and Agent Not Communicating with the Enterprise Manager </a>topics for additional information.</p>
                                        <p class="Bold_Subheading">How to use the Certificate Management Wizard</p>
                                        <p>The Certificate Management Wizard must be run twice to perform two actions. </p>
                                        <ul>
                                            <li>
                                                <p>The first action creates and exports certificate signing requests to a specified folder. </p>
                                            </li>
                                            <li>
                                                <p>The second action installs the signed certificate and configures <span class="mc-variable SI.Product variable">Threat Prevention</span> Enterprise Manager to trust client certificates signed by the customer's certificate authority. </p>
                                            </li>
                                        </ul>
                                        <p>The Certificate Manager Wizard application, <code>SICertMgr.exe</code>, is available in the following folder:</p>
                                        <p class="Command-Line-1">...\Netwrix\Netwrix Threat Prevention\SIEnterpriseManager</p>
                                        <p>The <span class="mc-variable SI.Product variable">Threat Prevention</span> installer generates default certificates, that are located in the following folder:</p>
                                        <p class="Command-Line-1">...\Netwrix\Netwrix Threat Prevention\SIEnterpriseManager\CertsInfo</p>
                                        <h2>Create a Certificate Signing Request</h2>
                                        <p>Follow the steps to create and export a certificate signing request to a specified folder.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Identify the certificate authority you will use to generate the signed certificates.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Open the Services explorer window (services.msc) and stop the Netwrix Threat Prevention  Enterprise Manager service.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Navigate to the directory containing <code>SICertMgr.exe</code>.  Right-click on the application and select <b>Run as Administrator</b>. The Certificate Management Wizard opens.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/SelectAction.png" title="Certificate Management Wizard on the Select Action page" alt="Certificate Management Wizard on the Select Action page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>On the Select Action page, select <b>Create Certificate Signing Request(s)</b>. This action creates and exports a certificate signing request to a designated folder. Click <b>Next</b>.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/SelectComponents.png" title="Certificate Management Wizard on the Select Components page" alt="Certificate Management Wizard on the Select Components page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>On the Select Components page, click <b>Next</b> to proceed with creating a certificate signing request for the Enterprise Manager.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/ExportCertificate.png" title="Certificate Management Wizard on the Export Certificate Signing Request(s) to page" alt="Certificate Management Wizard on the Export Certificate Signing Request(s) to page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 6 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 6 – </b></span></span>On the Export Certificate Signing Request(s) to page, select the folder to place the certificate request file. Click <b>Next</b> to generate the file.</p>
                                        <p>The following file is created and placed in the specified folder:</p>
                                        <ul>
                                            <li>
                                                <p>em-csr.pem</p>
                                            </li>
                                        </ul>
                                        <p>The following files are placed in the <code>...\Netwrix\Netwrix Threat Prevention\SIEnterpriseManager\CertsInfo</code> folder:</p>
                                        <ul>
                                            <li>
                                                <p>Secret.dpapi</p>
                                            </li>
                                            <li>
                                                <p>Ca-crt.pem</p>
                                            </li>
                                            <li>
                                                <p>Ca-key.pem 	(absent if custom signed)</p>
                                            </li>
                                            <li>
                                                <p>Em-crt.pem 	(private key)</p>
                                            </li>
                                            <li>
                                                <p>EM-key.pem 	(private key)</p>
                                            </li>
                                        </ul>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/CSRFilesCreated.png" title="Certificate Management Wizard on the Certificate Signing Requests Created page" alt="Certificate Management Wizard on the Certificate Signing Requests Created page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 7 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 7 – </b></span></span>The Certificate Signing Requests Created page is displayed when the certificate signing request has been created. Click <b>Finish</b>.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 8 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 8 – </b></span></span>Copy the signed certificates from the SI-CSR-Files folder to your certificate authority and generate the signed certificates. </p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The procedure to sign the certificates will vary based on the certificate authority used.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 9 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 9 – </b></span></span>Copy the signed certificates from your certificate authority and paste them to any folder on the <span class="mc-variable SI.Product variable">Threat Prevention</span> server. </p>
                                        <p> When copied, run the Certificate Management Wizard again to complete the certificate signing request(s).</p>
                                        <h2>Complete a Certificate Signing Request</h2>
                                        <p>Follow the steps to complete a certificate signing request.</p>
                                        <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Navigate to the directory containing <code>SICertMgr.exe</code>.  Right-click on the application and select <b>Run as Administrator</b>. The Certificate Management Wizard opens.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/SelectActionComplete.png" title="Certificate Management Wizard on the Select Action page" alt="Certificate Management Wizard on the Select Action page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>On the Select Action page, select <b>Complete Certificate Signing Request(s)</b>. This action  installs the signed certificate and configures <span class="mc-variable SI.Product variable">Threat Prevention</span> Enterprise Manager to trust the client certificate signed by the customer's certificate authority. Click <b>Next</b>.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/ImportSignedCertificates.png" title="Certificate Management Wizard on the Import Signed Certificate(s) page" alt="Certificate Management Wizard on the Import Signed Certificate(s) page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>On the Import Signed Certificate(s) page, select the folder containing the signed certificates. Then click <b>Next</b>.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/ImportCertificateAuthority.png" title="Certificate Management Wizard - Import Certificate Authority Certificate(s) page" alt="Certificate Management Wizard - Import Certificate Authority Certificate(s) page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>On the Import Certificate Authority Certificate(s) page, select the PEM file containing your certificate authority's root and intermediate certificates. Click <b>Next</b>.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/CertificateManagement/CertificatesImported.png" title="Certificate Management Wizard on the Certificates Import page" alt="Certificate Management Wizard on the Certificates Import page" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>The Certificates Import page displays the number of files imported. Click <b>Finish</b> to close the wizard.<br /></p>
                                        <p>The "*.pem" files are imported to the following folder:<br /><code>...\Netwrix\Netwrix Threat Prevention\SIEnterpriseManager\CertsInfo</code></p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 6 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 6 – </b></span></span>Restart the  <span class="mc-variable SI.Product variable">Threat Prevention</span> Enterprise Manager service.</p>
                                        <p><span class="mc-variable SI.Product variable">Threat Prevention</span> has been successfully configured to use certificates signed by the customer's certificate authority.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
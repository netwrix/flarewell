<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>LSASS Process Terminated</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="nocontent">
                                        <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                        </div>
                                    </div>
                                    <p>
                                        <script type="text/javascript" src="../../Resources/zzJavaScript/plugins.min.js">
                                        </script>
                                    </p>
                                    <div role="main" id="mc-main-content">
                                        <h1>LSASS Process Terminated</h1>
                                        <p>To collect real-time activity data, the Agent hooks into (intercepts) specific Microsoft APIs in the LSASS process. Note the following:</p>
                                        <ul>
                                            <li>
                                                <p>Occasionally Microsoft issues KBs (hot-fixes) that alter the LSASS components. Most of these hot-fixes do not alter the APIs in terms of the number or type parameters passed into them or values returned which are monitored by the Agent, and therefore do not impact operation of the Agent. </p>
                                            </li>
                                            <li>
                                                <p>Infrequently Microsoft issues a KB that changes one of these APIs in a way that can result in interfering with the Agent instrumentation. This in turn can result in an exception which causes the LSASS process to terminate. Historically, an update resulting in this type of exception is released less than once a year. When it does occur, such a conflict is typically manifested within a minute of boot up, often before the GINA allowing interactive login is initialized. When the Windows operating system (OS) detects such a situation, it will initiate a reboot of the OS. The end result can be an OS reboot loop which is resolved by either applying a ‘counter’ patch from <span class="mc-variable Netwrix.Company variable">Netwrix</span> to adapt to the Microsoft change or by setting the <span class="span_3"><span class="mc-variable SI.Product variable">Threat Prevention</span> Agent</span> service from its default ‘automatic start’ to ‘disabled’ or ‘manual start’ so that on the next reboot the <span class="mc-variable SI.Product variable">Threat Prevention</span> hooks are not deployed. </p>
                                            </li>
                                        </ul>
                                        <p>The Agent can detect if the LSASS process has terminated. If an LSASS termination is observed within the first five minutes from last reboot, then the Agent assumes it is due to the above situation and will take the following two actions well before the OS shuts down for the first time:</p>
                                        <ul>
                                            <li>
                                                <p>First, it sends an alert to the Enterprise Manager, “LSASS shutdown detected”</p>
                                            </li>
                                            <li>
                                                <p>Second, it sets itself to “manual start” so that the Agent instrumentation is not loaded on reboot</p>
                                            </li>
                                        </ul>
                                        <p>While this does result in a suspension of further <span class="mc-variable SI.Product variable">Threat Prevention</span> event monitoring and/or blocking on the affected domain controller, it ensures the domain controller continues to operate normally. Once the counter patch provided by <span class="mc-variable Netwrix.Company variable">Netwrix</span> is deployed, you can restart the Agent from the <span class="mc-variable SI.Product_2 variable">Administration Console</span>. In this case, the console will first check if the Agent is currently set to ‘manual start’ mode. If yes, then the  Agent service is set back to ‘automatic start’ mode and restarted, restoring normal operation. </p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>It is necessary to register a primary and a secondary technical contact for your orgaization with <span class="mc-variable Netwrix.Company variable">Netwrix</span> throughout the lifetime of <span class="mc-variable SI.Product variable">Threat Prevention</span> usage. <span class="mc-variable Netwrix.Company variable">Netwrix</span> will issue notifications to these registered technical contacts  related to Microsoft-issued KBs affecting LSASS and the counter patch (if one is needed). Contact the organization’s <span class="mc-variable Netwrix.Company variable">Netwrix</span> Sales Representative or <a href="mailto:support@stealthbits.com" target="_blank" title="Opens New Email to support@stealthbits.com" alt="Opens New Email to support@stealthbits.com"><a href="https://www.netwrix.com/support.html" target="_blank" title="Netwrix Support" alt="Netwrix Support">Netwrix Support</a></a> to ensure that these contacts have been registered.</p>
                                        <p>Prior to Microsoft releasing a KB that alters the LSASS components in a manner that causes a conflict with the Agent, <span class="mc-variable Netwrix.Company variable">Netwrix</span> will first send a notification informing the registered technical contact(s) of the release along with detailed instructions on how to obtain and apply the relevant Agent counter patch. Counter patches are typically made available via these notifications 24 hours or more prior to Microsoft issuing the incompatible KB. </p>
                                        <p>Since this requires the <span class="mc-variable SI.Product variable">Threat Prevention</span> administrator to take action, there is an Operations alert specific to this event.</p>
                                        <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>Enable the <i>LSASS process terminated</i> alert under Operations on the <a href="../Admin/Configuration/SystemAlerting/Overview.htm" title="System Alerting Window" alt="System Alerting Window" target="_parent" class="MCXref xref">System Alerting Window</a>.</p>
                                        <p>The Agent can be enabled with a safe mode, which would prevent the Active Directory monitoring module of the Agent from loading if any LSASS change is detected. See the <a href="../Admin/Agents/SafeMode.htm" title="Agent Safe Mode" alt="Agent Safe Mode" target="_parent" class="MCXref xref">Agent Safe Mode</a> topic for additional information.</p>
                                        <h2><a name="Enable"></a>Enable the 'LSASS Process Terminated' Email Alert</h2>
                                        <p>Follow the steps to enable email notifications for the <i>LSASS process terminated</i> alert under Operations.</p>
                                        <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>These steps require the <span class="mc-variable SI.Product variable">Threat Prevention</span> administrator user role. They also assume that the SMTP host information has been configured and email alerts have been enabled. See the <a href="../Admin/Configuration/SystemAlerting/Email.htm#_Configure_SMTP_Host" title="Configure SMTP Host Information" alt="Configure SMTP Host Information" target="_parent" class="MCXref xref">Configure SMTP Host Information</a> topic for additional information</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Click <b>Configuration</b> &gt; <b>Alerts</b> on the menu to open the <a href="../Admin/Configuration/SystemAlerting/Overview.htm" title="System Alerting Window" alt="System Alerting Window" target="_parent" class="MCXref xref">System Alerting Window</a>. </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>On the Email tab, click <b>Configure</b>.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Create a Message Profile for the LSASS notification with the recipient(s) to be notified when the LSASS process terminates. See the <a href="../Admin/Configuration/SystemAlerting/Email.htm#_Create_Message_Profiles" title="Create Message Profiles" alt="Create Message Profiles" target="_parent" class="MCXref xref">Create Message Profiles</a> topic for additional information.</p>
                                        <p style="text-align: center;">
                                            <img src="../../Resources/Images/ThreatPrevention/Troubleshoot/LSASSProcessTerminated.png" style="width: 844px;height: 698px;" title="System Alerting window - LSASS Process Terminated alert" alt="System Alerting window - LSASS Process Terminated alert" />
                                        </p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>On the Email tab, click <b>Events</b>, and then click <b>Operations</b> in the left pane. Check the <b>LSASS process terminated</b> event alert and select  the <span class="span_3">Message Profile</span> created in Step 3 from the drop-down menu. See the <a href="../Admin/Configuration/SystemAlerting/Email.htm" title="Email Tab" alt="Email Tab" target="_parent" class="MCXref xref">Email Tab</a> topic for additional information.</p>
                                        <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Ensure that the email alerts are enabled, as indicated by the Enabled toggle button,  and click <b>OK</b>.</p>
                                        <p>When the LSASS process terminated event alert is triggered, an email notification is sent to the assigned (step 3) recipient(s). </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
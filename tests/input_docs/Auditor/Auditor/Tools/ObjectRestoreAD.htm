<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_CSH_NPR_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="online">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Object Restore for Active Directory</title>
        <!-- Google Tag Manager -->
        <!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-NKJ33G');</script> -->
        <!-- End Google Tag Manager -->
        <link rel="shortcut icon" href="https://img.netwrix.com/fav.ico" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link href="../../Resources/TableStyles/Sb Table 1.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1260px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKJ33G" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-2538779-18">
                                    </script>
                                    <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-2538779-18');
		/* ]]> */</script>
                                    <div class="searchbar">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_Search mc-component">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search here" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="main">
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <div class="wrapper">
                                            <div class="toc">
                                                <ul class="nocontent menu _Skins_TOC mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Auditor__Auditor.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                </ul>
                                            </div>
                                            <div class="content">
                                                <div role="main" id="mc-main-content">
                                                    <h1>Object Restore for Active Directory</h1>
                                                    <p>With <span class="mc-variable Auditor.Product_Long_Name variable">Netwrix Auditor</span> you can quickly restore deleted and modified objects using the <span class="semibold">Netwrix Auditor Object Restore for Active Directory</span> tool shipped with the product. This tool enables AD object restore without rebooting a domain controller and affecting the rest of the AD structure, and goes beyond the standard tombstone capabilities. </p>
                                                    <p>The following Windows Server versions are supported:</p>
                                                    <ul>
                                                        <li>
                                                            <p>Windows Server 2025</p>
                                                        </li>
                                                        <li>
                                                            <p>Windows Server 2022</p>
                                                        </li>
                                                        <li>
                                                            <p>Windows Server 2019</p>
                                                        </li>
                                                        <li>
                                                            <p>Windows Server 2016</p>
                                                        </li>
                                                        <li>
                                                            <p>Windows Server 2012 R2</p>
                                                        </li>
                                                        <li>
                                                            <p>Windows Server 2012</p>
                                                        </li>
                                                    </ul>
                                                    <p>Perform the following procedures:</p>
                                                    <ul>
                                                        <li><a href="#Modify" target="_parent" title="Modify Schema Container Settings" alt="Modify Schema Container Settings" class="MCXref xref">Modify Schema Container Settings</a>
                                                        </li>
                                                        <li><a href="#Roll" target="_parent" title="Roll Back Unwanted Changes" alt="Roll Back Unwanted Changes" class="MCXref xref">Roll Back Unwanted Changes</a>
                                                        </li>
                                                    </ul>
                                                    <h2><a name="Modify"></a>Modify Schema Container Settings</h2>
                                                    <p style="text-align: justify;">By default, when a user or computer account is deleted from Active Directory, its password is discarded as well as a domain membership. When you restore deleted accounts with the <span class="semibold">Netwrix Auditor Object Restore for Active Directory</span> tool, it rolls back a membership in domain and sets random passwords which then have to be changed manually. If you want to be able to restore AD objects with their passwords preserved, you must modify the Schema container settings so that account passwords are retained when accounts are being deleted.</p>
                                                    <p class="Note">To perform this procedure, you will need the <a href="http://technet.microsoft.com/en-us/library/cc773354(v=ws.10).aspx">ADSI Edit</a> utility.utility.</p>
                                                    <p class="procedure">Follow the steps to modify schema container settings.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Navigate to Start &gt; Windows Administrative Tools <span class="semibold">&gt; ADSI Edit</span>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Right-click the <b>ADSI Edit</b> node and select <b>Connect To</b>. In the <b>Connection Settings</b> dialog, enable <b>Select a well-known Naming Context</b> and select <b>Schema</b> from the drop-down list.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Expand the <span class="semibold" style="font-weight: bold;">Schema your_Root_Domain_name</span> node. Right-click the <span class="semibold" style="font-weight: bold;">CN=Unicode-Pwd</span> attribute and select <span class="semibold" style="font-weight: bold;">Properties</span>.</p>
                                                    <p style="text-align: center;">
                                                        <img src="../../Resources/Images/Auditor/AD_Object_Restore_1.png" style="width: 601px;height: 312px;" />
                                                    </p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Double-click the <span class="semibold" style="font-weight: bold;">searchFlags</span> attribute and set its value to <i>"8"</i>.</p>
                                                    <p style="text-align: center;">
                                                        <img src="../../Resources/Images/Auditor/AD_Object_Restore_2.png" style="width: 351px;height: 379px;" />
                                                    </p>
                                                    <p>Now you will be able to restore deleted accounts with their passwords preserved.</p>
                                                    <h2><a name="Roll"></a>Roll Back Unwanted Changes</h2>
                                                    <p>Follow the steps to roll back unwanted changes.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Navigate to <span class="semibold">Start &gt;</span> <span class="semibold"><span class="mc-variable MyVariables.ProductName variable">Netwrix Auditor</span></span> &gt; <span class="semibold"><span class="mc-variable MyVariables.ProductName variable">Netwrix Auditor</span></span><span class="semibold"> Object Restore for Active Directory</span>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>On the <span class="semibold" style="font-weight: bold;">Select Rollback Period</span> step, specify the period of time when the changes that you want to revert occurred. You can either select a period between a specified date and the present date, or between two specified dates.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>On the <span class="semibold" style="font-weight: bold;">Select Rollback Source</span> step, specify the rollback source. The following restore options are available:</p>
                                                    <ul>
                                                        <li>
                                                            <p style="text-align: justify;">State-in-time snapshots — This option allows restoring objects from configuration snapshots made by <span class="mc-variable MyVariables.ProductName variable">Netwrix Auditor</span>. This option is more preferable since it allows to restore AD objects with all their attributes. </p>
                                                            <p>Complete the following fields:</p>
                                                            <table style="width: 100%;margin-left: auto;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/Sb Table 1.css');" class="TableStyle-Sb_Table_1" cellspacing="21">
                                                                <col class="TableStyle-Sb_Table_1-Column-Column1" style="width: 169px;" />
                                                                <col class="TableStyle-Sb_Table_1-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Sb_Table_1-Head-Header1">
                                                                        <th class="TableStyle-Sb_Table_1-HeadE-Column1-Header1">
                                                                            <p>Option</p>
                                                                        </th>
                                                                        <th class="TableStyle-Sb_Table_1-HeadD-Column1-Header1">
                                                                            <p>Description</p>
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                                        <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                                            <p>Audited domain
                                </p>
                                                                        </td>
                                                                        <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                                            <p>Select a domain where changes that you want to rollback occurred.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                                        <td class="TableStyle-Sb_Table_1-BodyB-Column1-Body2">
                                                                            <p>Select a state-in-time snapshot
                                </p>
                                                                        </td>
                                                                        <td class="TableStyle-Sb_Table_1-BodyA-Column1-Body2">
                                                                            <p>Select if you want to revert to a specific snapshot. Otherwise, the program will automatically search for the most recent snapshot that will cover the selected time period.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </li>
                                                    </ul>
                                                    <ul>
                                                        <li>
                                                            <p>Active Directory tombstones — This option is recommended when no snapshot is available. This is a last resort measure as the tombstone holds only the basic object attributes.</p>
                                                        </li>
                                                    </ul>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>On the <span class="semibold" style="font-weight: bold;">Analyzing Changes</span> step, the product analyzes the changes made during the specified time period. When reverting to a snapshot, the tool reviews the changes that occurred between the specified snapshots. When restoring from a tombstone, the tool reviews all AD objects put in the tombstone during the specified period of time.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>On the <span class="semibold" style="font-weight: bold;">Rollback Results</span> step, the analysis results are displayed. Select a change to see its rollback details in the bottom of the window. Select an attribute and click  <span class="semibold" style="font-weight: bold;">Details</span> to see what changes will be applied if this attribute is selected for rollback. Check the changes you want to roll back to their previous state.</p>
                                                    <p>Wait until the tool has finished restoring the selected objects. On the last step, review the results and click <span class="semibold" style="font-weight: bold;">Finish</span> to exit the wizard.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
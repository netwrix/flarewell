<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_CSH_NPR_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="online">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Adjusting Event Log Size and Retention Settings</title>
        <!-- Google Tag Manager -->
        <!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-NKJ33G');</script> -->
        <!-- End Google Tag Manager -->
        <link rel="shortcut icon" href="https://img.netwrix.com/fav.ico" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1260px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKJ33G" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-2538779-18">
                                    </script>
                                    <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-2538779-18');
		/* ]]> */</script>
                                    <div class="searchbar">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_Search mc-component">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search here" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="main">
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <div class="wrapper">
                                            <div class="toc">
                                                <ul class="nocontent menu _Skins_TOC mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Auditor__Auditor.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                </ul>
                                            </div>
                                            <div class="content">
                                                <div role="main" id="mc-main-content">
                                                    <h1><a name="kanchor108"></a>Adjusting Event Log Size and Retention Settings</h1>
                                                    <p>Consider that if the event log size is insufficient, overwrites may occur before data is written to the Long-Term Archive and the Audit Database, and some audit data may be lost. </p>
                                                    <p style="text-align: left;">To prevent overwrites, you can increase the maximum size of the event logs and set retention method for these logs to "<i>Overwrite events as needed</i>". This refers to the following event logs: </p>
                                                    <ul>
                                                        <li style="text-align: left;">Application</li>
                                                        <li style="text-align: left;">Security</li>
                                                        <li style="text-align: left;">Setup</li>
                                                        <li style="text-align: left;">System</li>
                                                        <li style="text-align: left;">Applications and Services logs &gt; Microsoft&gt;Windows &gt; TaskScheduler &gt; Operational</li>
                                                        <li style="text-align: left;">Applications and Services logs &gt; Microsoft &gt; Windows &gt; DNS-Server &gt; Audit (only for DCs running Windows Server 2012 R2 and above)</li>
                                                        <li>
                                                            <p> Applications and Services logs &gt; AD FS &gt; Admin log (for AD FS servers )</p>
                                                        </li>
                                                    </ul>
                                                    <p class="Note">Refer to the following Microsoft  <a href="https://support.microsoft.com/en-us/help/957662/recommended-settings-for-event-log-sizes-in-windows">article to read about the recommended event log settings</a>.</p>
                                                    <p>The procedure below provides a possible way to specify the event log settings manually. However, if you have multiple target computers, consider configuring these settings via Group Policy as also described in this section </p>
                                                    <h2>Configure the Event Log Size Manually</h2>
                                                    <p>Follow the steps to configure Event Log Size and Retention Settings.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>On a target server, navigate to Start &gt; Windows Administrative Tools &gt; Event Viewer.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Navigate to Event Viewer tree &gt; Windows Logs, right-click <b>Security</b> and select <b>Properties</b>.</p>
                                                    <p style="text-align: center;"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../Resources/Images/Auditor/ManualConfig/ManualConfig_WS_EventViewerPr2016.png" data-mc-popup-alt="Log Properties dialog box"><img class="MCPopupThumbnail img" data-mc-width="650" data-mc-height="578" src="../../../Resources/Images/Auditor/ManualConfig/ManualConfig_WS_EventViewerPr2016_thumb_0_0.png" style="width: 600px;height: auto;mc-thumbnail: popup;mc-thumbnail-max-height: auto;" alt="Log Properties dialog box" title="Log Properties dialog box" tabindex="" /></a>
                                                    </p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Make sure Enable logging is selected.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>In the Maximum log size field, specify the desired log size.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Make sure the Do not overwrite events (Clear logs manually) check box is cleared. If selected, change the retention method to <i>Overwrite events as needed (oldest events first)</i>.</p>
                                                    <p class="Note">Make sure the Maximum security log size group policy does not overwrite your log settings. To check this, start the Group Policy Management console, proceed to the GPO that affects your server, and navigate to Computer Configuration &gt; Policies &gt; Windows Settings &gt; Security Settings &gt; Event Log.</p>
                                                    <p>Repeat these steps for the following event logs: </p>
                                                    <ul>
                                                        <li style="text-align: left;"><b>Windows Logs</b> <b>&gt;</b> <b>Application</b> </li>
                                                        <li style="text-align: left;"><b>Windows Logs</b> <b>&gt;</b> <b>System</b></li>
                                                        <li style="text-align: left;">
                                                            <p><b>Applications and Services Logs &gt; Microsoft &gt; Windows &gt; TaskScheduler &gt; Operational</b>
                                                            </p>
                                                            <p class="Note" style="text-align: left;">Configure setting for TaskScheduler/Operational log only if you want to monitor scheduled tasks.</p>
                                                        </li>
                                                        <li style="text-align: left;"><b>Applications and Services Logs &gt; Microsoft &gt; Windows &gt; DNS-Server &gt; Audit</b>
                                                            <p class="Note">Configure setting for DNS log only if you want to monitor DNS changes. The log is available on Windows Server 2012 R2 and above and is not enabled by default. See Microsoft documentation for more information on how to enable this log.</p>
                                                        </li>
                                                        <li><b>Applications and Services Logs</b> <b>&gt;</b> <b>AD FS</b> <b>&gt;</b> <b>Admin</b><![CDATA[
					]]><p class="Note">Applies to the AD FS servers.</p></li>
                                                    </ul>
                                                    <h2>Configure the Event Log Size Using Group Policy</h2>
                                                    <p style="text-align: left;">Personnel with administrative rights can use Group Policy Objects to apply configuration settings to multiple servers in bulk.</p>
                                                    <p class="procedure">Follow the steps to configure settings for Application, System and Security event logs.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Open the Group Policy Management Editor on the domain controller and go to <b>Computer Configuration &gt; Policies &gt; Administrative Templates &gt; Windows Components &gt; Event Log Service</b>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Select the log you need.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Edit <span class="semibold" style="font-weight: bold;">Specify the maximum log file size</span> setting; the value is usually set to <i>4194240 KB</i>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Specify retention settings for the log; usually it is <span class="semibold" style="font-weight: bold;">Overwrite as needed</span>.</p>
                                                    <p class="procedure">Follow the steps to configure settings for other logs.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Open the registry editor and go to 
        
       <span class="semibold" style="font-style: italic;">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\&lt;log_name&gt;</span>. For example:<span class="semibold" style="font-style: italic;"> HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Directory Service</span></p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Set the <span class="semibold" style="font-weight: bold;">MaxSize</span> to the required decimal value (in bytes).</p>
                                                    <p style="text-align: center;"><a class="MCPopupThumbnailLink MCPopupThumbnailHover" href="../../../Resources/Images/Auditor/ConfigViaGPO/GPO_EventLog_RegEdit.png"><img class="MCPopupThumbnail img" data-mc-width="851" data-mc-height="368" src="../../../Resources/Images/Auditor/ConfigViaGPO/GPO_EventLog_RegEdit_thumb_0_0.png" style="width: 600px;height: auto;mc-thumbnail: hover;mc-thumbnail-max-height: auto;" tabindex="" /></a>
                                                    </p>
                                                    <p>You can configure Group Policy Preferences to push registry changes to the target domain computers. For the example above (Directory Service Log), perform the following steps.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>In Group Policy Management Console on the domain controller go to <b>Computer &gt; Preferences &gt; Windows Settings &gt; Registry</b>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Right-click <span class="semibold" style="font-weight: bold;">Registry</span> and select <b>New &gt; Registry Item</b>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>In the <span class="semibold" style="font-weight: bold;">Properties</span> window on the <span class="semibold" style="font-weight: bold;">General</span> tab select the following:
				</p>
                                                    <ul>
                                                        <li>Action &gt; Create</li>
                                                        <li>Hive &gt; HKEY_LOCAL_MACHINE</li>
                                                        <li>Key Path – browse to <span class="semibold" style="font-weight: bold;">MaxSize</span> value at the				
                     <span class="semibold" style="font-style: italic;">SYSTEM\CurrentControlSet\Services\EventLog\Directory Service</span><br /><a class="MCPopupThumbnailLink MCPopupThumbnailHover" href="../../../Resources/Images/Auditor/ConfigViaGPO/GPO_EventLog_GPMC.png"><img class="MCPopupThumbnail img" data-mc-width="908" data-mc-height="607" src="../../../Resources/Images/Auditor/ConfigViaGPO/GPO_EventLog_GPMC_thumb_0_0.png" style="height: auto;mc-thumbnail: hover;width: 575px;mc-thumbnail-max-height: auto;" tabindex="" /></a></li>
                                                    </ul>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Change the <span class="semibold" style="font-weight: bold;">MaxSize REG_DWORD</span> to the required decimal value (in bytes).</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Save the preferences and link them to the necessary servers (OUs).</p>
                                                    <p>When finished, run the <code>gpupdate /force</code> command to force group policy update.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_CSH_NPR_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="online">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" /><title>Export Activity Records </title>
        <!-- Google Tag Manager -->
        <!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-NKJ33G');</script> -->
        <!-- End Google Tag Manager -->
        <link rel="shortcut icon" href="https://img.netwrix.com/fav.ico" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link href="../../../Resources/TableStyles/Sb Table 1.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1260px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKJ33G" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-2538779-18">
                                    </script>
                                    <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-2538779-18');
		/* ]]> */</script>
                                    <div class="searchbar">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_Search mc-component">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search here" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="main">
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <div class="wrapper">
                                            <div class="toc">
                                                <ul class="nocontent menu _Skins_TOC mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Auditor__Auditor.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                </ul>
                                            </div>
                                            <div class="content">
                                                <div role="main" id="mc-main-content">
                                                    <h1>Export Activity Records </h1>
                                                    <h2>Export Activity Records Associated with the Alert</h2>
                                                    <p>To export only important audit data, that is, the Activity Records that led to the alert triggering, configure the alert response action, providing path to <b>Netwrix_Auditor_Alerts_to_Event_Log_Add-on.ps1</b>. See the <a href="Overview.htm" target="_parent" title="SIEM" alt="SIEM" class="MCXref xref">SIEM</a> topic for additional information.</p>
                                                    <h2>Export Activity Records in Bulk</h2>
                                                    <p>As said, <span class="mc-variable Netwrix.Company variable">Netwrix</span> recommends exporting the most important data, using the script described above. However, if you need to export all Activity Records in bulk, follow the recommendations below.</p>
                                                    <p>
                                                        <p>First, provide a path to your add-on  followed by script parameters with their values. Each parameter is preceded with a dash; a space separates a parameter name from its value. You can skip some parameters—the script uses a default value unless a parameter is explicitly defined. If necessary, modify the parameters as required.</p>
                                                    </p>
                                                    <p>Follow the steps to run add-on with PowerShell:</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>On computer where you want to execute the add-on, start Windows PowerShell.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Type a path to the add-on. Or simply drag and drop the add-on file in the console window.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Add script parameters. The console will look similar to the following:</p>
                                                    <p class="Command-Line">Windows PowerShell</p>
                                                    <p class="Command-Line">Copyright (C) 2014 Microsoft Corporation. All rights reserved.</p>
                                                    <p class="Command-Line">PS C:\Users\AddOnUser&gt; C:\Add-ons\Netwrix_Auditor_Activity_Records_to_Event_Log_Add-on.ps1.ps1</p>
                                                    <p>If the script path contains spaces (e.g., <code style="font-size: 9pt;">C:\<span class="mc-variable Netwrix.Company variable">Netwrix</span> Add-ons\</code>), embrace it in double quotes and insert the ampersand (<span class="semibold">&amp;</span>) symbol in front (e.g., <code style="font-size: 9pt;">&amp; "C:\Netwrix Add-ons\"</code>).</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Hit <b>Enter</b>.</p>
                                                    <p style="text-align: left;">Depending on the number of Activity Records stored in <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> <span class="mc-variable MyVariables.Audit_Database variable">Audit Database</span> execution may take a while. Ensure the script execution completed successfully. The <span class="semibold" style="font-weight: bold;"><span class="mc-variable Auditor.Product_Long_Name variable">Netwrix Auditor</span> Integration</span> event log will be created and filled with events. </p>
                                                    <p>By default, the <span class="semibold" style="font-weight: bold;"><span class="mc-variable Auditor.Product_Long_Name variable">Netwrix Auditor</span> Integration</span> event log size is set to <i>1GB</i>, and retention is set to <i>"Overwrite events as needed"</i>. See the <a href="IntegrationEventLog.htm" target="_parent" title="Appendix. Netwrix Auditor Integration Event Log Fields" alt="Appendix. Netwrix Auditor Integration Event Log Fields" class="MCXref xref">Integration Event Log Fields</a> topic for additional information.</p>
                                                    <p class="Note">Event records with more than 30,000 characters length will be trimmed.</p>
                                                    <p>At the end of each run, the script creates the <b>Netwrix_Auditor_Event_Log_Export_Add-on_EventIDs.txt</b> file. It defines mapping between the Activity Records and related Event IDs .</p>
                                                    <p>You can use this file to track possible duplicates of Event IDs created at each script execution. Duplicates, if any, are written to the <b>Netwrix_Auditor_Event_Log_Export_Add-on_EventIDsDuplicates.txt</b> file.</p>
                                                    <p>Similarly, the add-on also creates the <b>Netwrix_Auditor_Event_Log_Export_Add-on_CategoriesIDs.txt</b> file that defines mapping between the Data Source and related Category ID.</p>
                                                    <h3>Apply Filters</h3>
                                                    <p>Every time you run the script, <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> makes a timestamp. The next time you run the script, it will start retrieving new Activity Records. Consider the following:</p>
                                                    <ul>
                                                        <li>By default, the add-on does not apply any filters when exporting Activity Records. If you are running the add-on for the first time (there is no timestamp yet) with no filters, it will export Activity Records for the last month only. This helps to optimize solution performance during the first run. At the end of the first run, the timestamp will be created, and the next run will start export from that timestamp.</li>
                                                        <li>However, if you have specified a time period for Activity Records to be exported, then this filter will be applied at the add-on first run and the runs that follow. </li>
                                                    </ul>
                                                    <h3>Automate Add-On Execution</h3>
                                                    <p>To ensure you feed the most recent data to your SIEM solution, you can schedule a daily task for running the Activity Records to Event Log add-on.</p>
                                                    <p>To ensure you feed the most recent data to your SIEM solution, <span class="mc-variable Netwrix.Company variable">Netwrix</span> recommends scheduling a daily task for running the add-on.</p>
                                                    <p><b style="font-weight: normal; font-style: normal;">Perform the following steps to create a scheduled task:</b>
                                                    </p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>On the computer where you want to execute the add-on, navigate to <b>Task Scheduler</b>.<span class="semibold" style="font-weight: bold;">Task Scheduler</span>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>On the <b>General</b> tab, specify a task name. Make sure the account that runs the task has all necessary rights and permissions.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>On the <b>Triggers</b> tab, click <b>New</b> and define the schedule. This option controls how often audit data is exported from <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> and saved to event log. <span class="mc-variable Netwrix.Company variable">Netwrix</span>recommends scheduling a daily task.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>On the <b>Actions</b> tab, click <b>New</b> and specify action details. Review the following for additional information:</p>
                                                    <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/TableStyles/Sb Table 1.css');" class="TableStyle-Sb_Table_1" cellspacing="21">
                                                        <col class="TableStyle-Sb_Table_1-Column-Column1" style="width: 30%;" />
                                                        <col class="TableStyle-Sb_Table_1-Column-Column1" style="width: 70%;" />
                                                        <thead>
                                                            <tr class="TableStyle-Sb_Table_1-Head-Header1">
                                                                <th class="TableStyle-Sb_Table_1-HeadE-Column1-Header1">Option</th>
                                                                <th class="TableStyle-Sb_Table_1-HeadD-Column1-Header1">Value</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                                    <p>Action</p>
                                                                </td>
                                                                <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                                    <p>Set to <i>"Start a program"</i>.</p>
                                                                </td>
                                                            </tr>
                                                            <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body2">
                                                                    <p>Program/script</p>
                                                                </td>
                                                                <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body2">
                                                                    <p>Input <i>"Powershell.exe"</i>.</p>
                                                                </td>
                                                            </tr>
                                                            <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                                <td class="TableStyle-Sb_Table_1-BodyB-Column1-Body1">
                                                                    <p>Add arguments (optional)</p>
                                                                </td>
                                                                <td class="TableStyle-Sb_Table_1-BodyA-Column1-Body1">
                                                                    <p>Add a path to the add-on in double quotes and specify add-on parameters.  For example:</p>
                                                                    <p class="Command-Line">-file "C:\Add-ons\Netwrix_Auditor_Audit_Records_to_Event_Log_Add-on.ps1" <br /></p>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Save the task.</p>
                                                    <p>After creating a task, wait for the next scheduled run or navigate to <b>Task Scheduler</b> and run the task manually. To do this, right-click a task and click <b>Run</b>.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
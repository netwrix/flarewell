<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_CSH_NPR_Skin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="online">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" /><title>Use Group Managed Service Account (gMSA)</title>
        <!-- Google Tag Manager -->
        <!-- <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-NKJ33G');</script> -->
        <!-- End Google Tag Manager -->
        <link rel="shortcut icon" href="https://img.netwrix.com/fav.ico" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1260px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NKJ33G" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-2538779-18">
                                    </script>
                                    <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-2538779-18');
		/* ]]> */</script>
                                    <div class="searchbar">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_Search mc-component">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search here" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="main">
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <div class="wrapper">
                                            <div class="toc">
                                                <ul class="nocontent menu _Skins_TOC mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/Auditor__Auditor.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                </ul>
                                            </div>
                                            <div class="content">
                                                <div role="main" id="mc-main-content">
                                                    <h1>Use Group Managed Service Account (gMSA)</h1>
                                                    <p style="text-align: left;"><span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> supports using Group Managed Service Accounts (gMSA) for data collection and storage. This can help you to simplify product  administration, providing the following benefits:</p>
                                                    <ul>
                                                        <li> There is no password to manage for this account: Windows handles the password management for it. User interaction for password update on a regular basis is not required. </li>
                                                        <li>Using the gMSA also eliminates a need in service accounts with static passwords that are set upon creation and then never cycled. </li>
                                                        <li>The gMSA also helps to ensure that service account is only used to run a service (gMSA accounts cannot be used to log on interactively to domain computers).</li>
                                                        <li>
                                                            <p>The gMSA is allowed to audit trusted domains using configured and validated gMSA from the target domain. </p>
                                                        </li>
                                                    </ul>
                                                    <p>Currently, gMSA is supported:</p>
                                                    <ul>
                                                        <li>
                                                            <p>As a data collecting account for the following data sources: </p>
                                                            <ul style="list-style-type: circle;">
                                                                <li>
                                                                    <p>Active Directory (including Group Policy and Logon Activity)</p>
                                                                </li>
                                                                <li>
                                                                    <p>File Server (currently for Windows File Servers)</p>
                                                                </li>
                                                                <li>
                                                                    <p>SQL Server</p>
                                                                </li>
                                                                <li>
                                                                    <p>SharePoint</p>
                                                                </li>
                                                                <li>
                                                                    <p>User Activity (including User Activity Video Recording)</p>
                                                                </li>
                                                                <li>
                                                                    <p>Windows Server</p>
                                                                </li>
                                                            </ul>
                                                            <p>See the <a href="../Admin/MonitoringPlans/DataAccounts.htm" target="_parent" title="Data Collecting Account" alt="Data Collecting Account" class="MCXref xref">Data Collecting Account</a> topic for additional information about supported data sources.</p>
                                                            <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>If you are using a gMSA account for Active Directory collection consider that the Active Directory Object Restore tool will not work.</p>
                                                        </li>
                                                        <li>As an account for accessing Long-Term archive. See the <a href="LongTermArchive.htm" target="_parent" title="File-Based Repository for Long-Term Archive" alt="File-Based Repository for Long-Term Archive" class="MCXref xref">File-Based Repository for Long-Term Archive</a> topic for additional information.</li>
                                                        <li>
                                                            <p>As an account for accessing Audit Databases. See <a href="SQLServer.htm" title="Requirements for SQL Server to Store Audit Data" alt="Requirements for SQL Server to Store Audit Data" target="_parent" class="MCXref xref">Requirements for SQL Server to Store Audit Data</a> topic for additional information.</p>
                                                            <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>In case of accessing Audit Databases using gMSA account, SSRS-based reports will not work. </p>
                                                        </li>
                                                    </ul>
                                                    <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>Prepare  a dedicated gMSA  for these purposes. </p>
                                                    <p>The gMSA would work only within one domain, the parent domain and NA also should be joined within the same domain. The reason is that gMSAs are designed to be scoped within a single Active Directory domain or subdomain.</p>
                                                    <p>See the following Microsoft article for more information: <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/group-managed-service-accounts/group-managed-service-accounts/getting-started-with-group-managed-service-accounts" target="_blank" title="Get started with Group Managed Service Accounts" alt="Get started with Group Managed Service Accounts">Get started with Group Managed Service Accounts</a></p>
                                                    <p>By default, the gMSA account is not a member of any domain groups. After creating gMSA account, you need to add this account to one of the domain groups as required for the data source you are going to audit.</p>
                                                    <h2>Check for a KDS Root Key</h2>
                                                    <p>To generate password for gMSA accounts, domain controllers require a Key Distribution Services (KDS) root key. This key is created once, so if there are any gMSA accounts in your domain, this means the root key already exists. </p>
                                                    <p class="procedure">Follow the steps to check whether the root key exists in your domain.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span> Open the <b>Active Directory Sites and Services</b> Console and select <b>View</b> &gt; <b>Show Services Node</b>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Browse to <b>Services</b> &gt; <b>Group Key Distribution Services</b> &gt;&#160;<b>Master Root Keys</b>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Alternatively,  you can run the <code>Get-KdsRootKey</code> cmdlet. If the key does not exist, it will not return any output.</p>
                                                    <h2>Create a KDS Root Key</h2>
                                                    <p>If the KDS root key does not exist, then you can create a KDS root key as described below, or contact your Active Directory administrator.</p>
                                                    <p class="procedure">Follow the  steps to create a KDS key (on a domain controller running Windows Server 2012 or later).</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>On the domain controller, run <b>Windows PowerShell</b>.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>In the command prompt of  Windows PowerShell Active Directory module, run the following cmdlet:</p>
                                                    <p><code>Add-KdsRootKey -EffectiveImmediately</code>
                                                    </p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>A root key will be added to the target DC which will be used by the KDS service immediately. </p>
                                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>This requires waiting 10 hours, as other domain controllers will  be able to use the root key only after a successful replication. See the <a href="https://docs.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/create-the-key-distribution-services-kds-root-key" target="_blank" title="Create the Key Distribution Services KDS Root Key" alt="Create the Key Distribution Services KDS Root Key">Create the Key Distribution Services KDS Root Key</a> Microsoft article for additional information.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Alternatively, you can use the following cmdlet: </p>
                                                    <p class="Note_continue"><code>Add-KdsRootKey -EffectiveTime MM/DD/YYYY</code>
                                                    </p>
                                                    <p class="Note_continue" style="text-align: left;">This cmdlet generates a KDS root key that will take effect on the specified date. Use the <i>mm/dd/yyyy</i> format, for example: <code>Add-KdsRootKey -EffectiveTime 02/27/21</code></p>
                                                    <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>This approach, however, should be used with care. Waiting up to 10 hours is a safety measure to prevent password generation from occurring before all DCs in the environment are capable of answering gMSA requests. For more information, refer to the following microsoft article: <a href="https://learn.microsoft.com/en-us/windows-server/security/group-managed-service-accounts/create-the-key-distribution-services-kds-root-key" target="_blank" title="Create the Key Distribution Services KDS Root Key" alt="Create the Key Distribution Services KDS Root Key">Create the Key Distribution Services KDS Root Key</a>.</p>
                                                    <p>To make the KDS Root Key work immediately you can use the following powershell command:</p>
                                                    <p class="Command-Line">Add-KDSRootKey -Effectivetime ((get-date).addhours(-10))</p>
                                                    <p>This command will make the KDS Root Key work immediately.</p>
                                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>This is recommended only for small environments. In large environments, it is required  to wait 10 hours for replication.</p>
                                                    <h2>Create a gMSA</h2>
                                                    <p style="text-align: left;">To create a new  gMSA, you will need to specify:</p>
                                                    <ul>
                                                        <li style="text-align: left;"> New account name and FQDN</li>
                                                        <li style="text-align: left;">
                                                            <p>Computer account(s) that will be allowed to make use of that gMSA. Here it will be <span class="semibold">your <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> Server </span></p>
                                                            <ul>
                                                                <li style="text-align: left;">
                                                                    <p>The account must be a member of the <b>Administrators</b> group on the <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> Server.</p>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                    <p style="text-align: left;">For example, you can create a gMSA using the <code>New-ADServiceAccount</code> PowerShell cmdlet. If so, you should specify your <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span>&#160;Server account in the <code>-PrincipalsAllowedToRetrieveManagedPassword</code> attribute.</p>
                                                    <p class="Note" style="text-align: left;">Make sure you specify a valid computer object in this attribute.</p>
                                                    <p class="Note_continue" style="text-align: left;">If you have multiple <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> servers, you can specify the computer accounts using a comma separated list, or specify a security group and add the required computer accounts to that security group.</p>
                                                    <p class="procedure">To create a new gMSA in the root domain using PowerShell:</p>
                                                    <ul>
                                                        <li> If you are using a single Netwrix Auditor Server, run the command as follows:
        
        <p style="text-align: left;"><span style="white-space: nowrap;"><code>New-ADServiceAccount -name <b>nagmsa</b> -DNSHostName <b>nagmsa.mydomain.local</b> -PrincipalsAllowedToRetrieveManagedPassword <b>NASrv$</b></code></span></p><p>here:</p><ul style="list-style-type: circle;"><li><i>name</i> — new gMSA&#160;name, here <b>nagmsa</b>. Make sure the name refers to a valid computer objects.</li><li><i>DNSHostName</i> — FQDN of the new gMSA account, here <b>nagmsa.mydomain.local</b></li><li><i>PrincipalsAllowedToRetrieveManagedPassword</i> — your Netwrix Auditor Server NETBIOS name ended with $, here <b>NASrv$</b></li></ul></li>
                                                        <li>If you want to specify a security group that comprises multiple <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span>&#160; servers, run the command as follows:
        
        <p style="text-align: left;"><span style="white-space: nowrap;"><code>New-ADServiceAccount -Name <b>gmsagroup</b> -DNSHostName <b>gmsagroup.mydomain.local</b> -PrincipalsAllowedToRetrieveManagedPassword <b>NAServers</b></code></span></p><p>here <b>NAServers</b> — a security group with your <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span>&#160; servers.</p></li>
                                                    </ul>
                                                    <h2>Assign Required Roles and Permissions to a gMSA</h2>
                                                    <p>Once a new gMSA account has been prepared, assign the required roles and permissions to this account, depending on what purpose a gMSA account will be used for. </p>
                                                    <ul>
                                                        <li>
                                                            <p>If you are going to use a gMSA as a data collecting account in <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span>, add this account to the Local Admins group on the <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> Server and assign the following rights and permissions, depending on the data source you want to collect data from:</p>
                                                            <ul style="list-style-type: circle;">
                                                                <li>
                                                                    <p><a href="../Configuration/ActiveDirectory/Permissions.htm" target="_parent" title="Permissions for Active Directory Auditing" alt="Permissions for Active Directory Auditing" class="MCXref xref">Permissions for Active Directory Auditing</a>
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p><a href="../Configuration/GroupPolicy/Permissions.htm" target="_parent" title="Permissions for Group Policy Auditing" alt="Permissions for Group Policy Auditing" class="MCXref xref">Permissions for Group Policy Auditing
        </a>
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p><a href="../Configuration/LogonActivity/Permissions.htm" target="_parent" title="Permissions for Logon Activity Auditing" alt="Permissions for Logon Activity Auditing" class="MCXref xref">Permissions for Logon Activity Auditing
        </a>
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p><a href="../Configuration/FileServers/Windows/Permissions.htm" target="_parent" title="Permissions for Windows File Server Auditing" alt="Permissions for Windows File Server Auditing" class="MCXref xref">Permissions for Windows File Server Auditing</a>
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p><a href="../Configuration/SharePoint/Permissions.htm" target="_parent" title="Permissions for SharePoint Auditing" alt="Permissions for SharePoint Auditing" class="MCXref xref">Permissions for SharePoint Auditing</a>
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p><a href="../Configuration/SQLServer/Permissions.htm" target="_parent" title="Permissions for SQL Server Auditing" alt="Permissions for SQL Server Auditing" class="MCXref xref">Permissions for SQL Server Auditing
        </a>
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p><a href="../Configuration/WindowsServer/Permissions.htm" target="_parent" title="Permissions for Windows Server Auditing" alt="Permissions for Windows Server Auditing" class="MCXref xref">Permissions for Windows Server Auditing
        </a>
                                                                    </p>
                                                                    <p class="Remember" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;i&gt;Remember, &lt;/i&gt;&lt;/span&gt;"><span class="autonumber"><span class="Remember"><span style="color: #fb8000;" class="mcFormatColor"><i>Remember, </i></span></span></span><a href="../Configuration/WindowsServer/Permissions.htm" target="_parent" title="For Windows Server Auditing" alt="For Windows Server Auditing" class="MCXref xref">Permissions for Windows Server Auditing
        </a>
                                                                    </p>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li>
                                                            <p>If you are going to use a gMSA to access Long-Term archive, assign the roles and permissions required for a <u>custom</u> account: </p>
                                                            <ul style="list-style-type: circle;">
                                                                <li>
                                                                    <p><a href="LongTermArchive.htm" target="_parent" title="File-Based Repository for Long-Term Archive" alt="File-Based Repository for Long-Term Archive" class="MCXref xref">File-Based Repository for Long-Term Archive</a>
                                                                    </p>
                                                                    <p class="Remember" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;i&gt;Remember, &lt;/i&gt;&lt;/span&gt;"><span class="autonumber"><span class="Remember"><span style="color: #fb8000;" class="mcFormatColor"><i>Remember, </i></span></span></span>that you can use custom (gMSA) account only if your Long-Term archive stored on a file share.</p>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li>
                                                            <p> If you are going to use a gMSA to access Audit Database, assign the required roles:</p>
                                                            <ul style="list-style-type: circle;">
                                                                <li>
                                                                    <p><a href="SQLServer.htm" target="_parent" title="Requirements for SQL Server to Store Audit Data" alt="Requirements for SQL Server to Store Audit Data" class="MCXref xref">Requirements for SQL Server to Store Audit Data</a>
                                                                    </p>
                                                                    <p class="Remember" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;i&gt;Remember, &lt;/i&gt;&lt;/span&gt;"><span class="autonumber"><span class="Remember"><span style="color: #fb8000;" class="mcFormatColor"><i>Remember, </i></span></span></span>that a gMSA account cannot access SSRS due to Microsoft restrictions.</p>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li>
                                                            <p>If you are going to use a gMSA as a data collection accoun for User Activity or User Activity Video Recording, refer to the following topics:</p>
                                                            <ul style="list-style-type: circle;">
                                                                <li>
                                                                    <p><a href="../Configuration/UserActivity/Overview.htm" target="_parent" title="User Activity" alt="User Activity" class="MCXref xref">User Activity</a>
                                                                    </p>
                                                                </li>
                                                                <li>
                                                                    <p><a href="../Configuration/UserActivity/VideoRecordings.htm" target="_parent" title="Configure Video Recordings Playback Settings" alt="Configure Video Recordings Playback Settings" class="MCXref xref">Configure Video Recordings Playback Settings</a>
                                                                    </p>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                    </ul>
                                                    <p>Now you can use a gMSA account as one of the <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> Service Account.</p>
                                                    <h2>Apply a gMSA</h2>
                                                    <p>This topic contains instructions on how to apply a gMSA as one of the <span class="mc-variable Auditor.Product_Short_Name variable">Auditor</span> Service Accounts.</p>
                                                    <ul>
                                                        <li>
                                                            <p><a href="#Apply" title="Apply a gMSA as a Data Collecting Account" alt="Apply a gMSA as a Data Collecting Account" target="_parent" class="MCXref xref">Apply a gMSA as a Data Collecting Account</a>
                                                            </p>
                                                        </li>
                                                        <li>
                                                            <p><a href="#Apply2" target="_parent" title="Apply gMSA to Access Long-Term Archive" alt="Apply gMSA to Access Long-Term Archive" class="MCXref xref">Apply gMSA&#160;to Access Long-Term Archive</a>
                                                            </p>
                                                        </li>
                                                        <li>
                                                            <p><a href="#Apply3" target="_parent" title="Apply gMSA to Access Audit Database" alt="Apply gMSA to Access Audit Database" class="MCXref xref">Apply gMSA&#160;to Access Audit Database</a>
                                                            </p>
                                                        </li>
                                                    </ul>
                                                    <h3><a name="Apply"></a>Apply a gMSA as a Data Collecting Account</h3>
                                                    <p style="text-align: left;">To process the corresponding monitored items using gMSA, you can specify this account in the monitored plan properties. See the <a href="../Admin/MonitoringPlans/Create.htm" target="_parent" title="Settings for Data Collection" alt="Settings for Data Collection" class="MCXref xref">Create a New Monitoring Plan</a> topic for additional information.</p>
                                                    <p style="text-align: left;">Follow the steps to set  a custom account in the monitored item properties.</p>
                                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span> Open the monitored item properties for editing.</p>
                                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>On the <b>General</b> tab, under <b>Specify account for collecting data</b>, select <b>gMSA</b> option. </p>
                                                    <p style="text-align: center;">
                                                        <img src="../../Resources/Images/Auditor/MonitoringPlans/gMSA.png" title="Monitored Item Properties page" alt="Monitored Item Properties page" />
                                                    </p>
                                                    <p>See the <a href="../Admin/MonitoringPlans/DataSources.htm#Add" target="_parent" title="Add Items for Monitoring" alt="Add Items for Monitoring" class="MCXref xref">Add Items for Monitoring</a>&#160;topic for additional information.</p>
                                                    <h3><a name="Apply2"></a>Apply gMSA&#160;to Access Long-Term Archive</h3>
                                                    <p>To write data to the Long-Term Archive and upload report subscriptions to shared folders, you can specify this account as a custom account in the Long-Term Archive settings. See the <a href="../Admin/Settings/LongTermArchive.htm" target="_parent" title="Long-Term Archive" alt="Long-Term Archive" class="MCXref xref">Long-Term Archive</a> topic for additional information.</p>
                                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>For a custom account or a gMSA one, consider that you can use the account for the Long-Term Archive based on a file share</p>
                                                    <h3><a name="Apply3"></a>Apply gMSA&#160;to Access Audit Database</h3>
                                                    <p>To access Audit Database, generate reports and run interactive search queries, you can specify this account under the 'Specify custom connection parameters in your common database plan settings. See the <a href="../Admin/MonitoringPlans/FineTune.htm" target="_parent" title="Fine-Tune Your Plan and Edit Settings" alt="Fine-Tune Your Plan and Edit Settings" class="MCXref xref">Fine-Tune Your Plan and Edit Settings</a> topic for additional information.</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
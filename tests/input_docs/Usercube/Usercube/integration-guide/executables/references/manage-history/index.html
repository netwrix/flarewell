<!DOCTYPE html>
<html lang="en-us" class="js csstransforms3d _Skins_HTML5___Side_Navigation" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Home Page|Integration Guide|Executables|References: Executables">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Resources/TableStyles/Sb Table 1.css" rel="stylesheet" data-mc-stylesheet-type="table" /><title>Usercube-Manage-History</title>
        <link href="../../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body class="" data-url="../../../../integration-guide/executables/references/manage-history/">
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../../index.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Usercube-Manage-History</h1>
                                    <p>This tool optimizes the data history stored in the database, reducing its size and enhancing database performance.</p>
                                    <p>The inner workings of this executable are based on the <code>ValidFrom</code> and <code>ValidTo</code> attributes that specify the validity period of a given assignment. These attributes are inside the following tables which are the tables actually purged: <code>ur_resources</code>; <code>ur_resourcelinks</code>; <code>up_assignedcompositeroles</code>; <code>up_assignedsingleroles</code>; <code>up_assignedresourcenavigations</code>; <code>up_assignedresourcetypes</code>.</p>
                                    <h2 id="examples">Examples</h2>
                                    <p class="Bold_Subheading">Purge before a period</p>
                                    <p>To clean the database periodically, it can be purged of all the history older than a given period of time.</p>
                                    <p>The following example deletes all the history from the database that is more than 12-month old:</p>
                                    <p>Code attributes enclosed with &lt;&gt; need to be replaced with a custom value before entering the script in the command line.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: XML;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>./Usercube-Manage-History.exe --purge-before-months 12 --database-connection-string "data source=.;Database=Usercube;Integrated Security=SSPI;Min Pool Size=10;encrypt=false;"</code></pre>
                                        </div>
                                    </div>
                                    <p class="Bold_Subheading">Purge before a date</p>
                                    <p>The database can be purged of all history older than a given date.</p>
                                    <p>The following example deletes all the history from the database older than May 26th 1993:</p>
                                    <p>Code attributes enclosed with &lt;&gt; need to be replaced with a custom value before entering the script in the command line.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: XML;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>./Usercube-Manage-History.exe --purge-before-date 19930526 --database-connection-string "data source=.;Database=Usercube;Integrated Security=SSPI;Min Pool Size=10;encrypt=false;"</code></pre>
                                        </div>
                                    </div>
                                    <p class="Bold_Subheading">Optimize</p>
                                    <p>The database's history can be optimized by removing intermediate versions based on their age, for example keeping only one version the last week, one per month the last 6 months and then one per year for 3 years.</p>
                                    <p>The following example reduces the history from the database, keeping at most one history version per interval. Here we keep one version per day (1440 minutes) in the last 7 days, then one version per month (43920 minutes) in the last 6 months before the previously defined period, then one version per year (525960 minutes) in the last 2 years before the previously defined periods.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../../../Resources/Images/tools_manageHistory_schema.png" alt="Schema - Optimize" style="box-shadow: none;" />
                                    </p>
                                    <p>For each period, if there is more than one version (i.e. <code>ValidFrom</code> is inside the interval), the versions are merged in the following way:</p>
                                    <ul>
                                        <li>
                                            <p>The latest version is kept</p>
                                        </li>
                                        <li>
                                            <p>The oldest date is kept (that is, in the database, the <code>ValidFor</code> is equal to the one of the oldest version in the considered period).</p>
                                        </li>
                                    </ul>
                                    <p>Code attributes enclosed with &lt;&gt; need to be replaced with a custom value before entering the script in the command line.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: XML;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><br />./Usercube-Manage-History.exe --optimize "1440:7 43920:6 525960:2" --database-connection-string "data source=.;Database=Usercube;Integrated Security=SSPI;Min Pool Size=10;encrypt=false;"<br /></code></pre>
                                        </div>
                                    </div>
                                    <p>If you want to configure a time period when there is no purge and all history is kept as is, then you can specify a short duration that allows a single change, for example only one minute. The following example copies the previous one, in addition we want to keep all changes of the last 6 hours (360 minutes): <code>--optimize 1:360 1440:7 43920:6 525960:2</code>.</p>
                                    <p class="Bold_Subheading">Clean duplicates</p>
                                    <p>As given data can have several versions in the database, redundant rows can be deleted and replaced with one row that covers the consolidated time range.</p>
                                    <p>The following example remove all duplicates in the database.</p>
                                    <p>Code attributes enclosed with &lt;&gt; need to be replaced with a custom value before entering the script in the command line.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: XML;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><br />./Usercube-Manage-History.exe --clean-duplicates --database-connection-string "data source=.;Database=Usercube;Integrated Security=SSPI;Min Pool Size=10;encrypt=false;"<br /></code></pre>
                                        </div>
                                    </div>
                                    <p>The following example remove all duplicates induced by the <code>pwdLastSet</code> property.</p>
                                    <p>Code attributes enclosed with &lt;&gt; need to be replaced with a custom value before entering the script in the command line.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: XML;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><br />./Usercube-Manage-History.exe --clean-duplicates --excluded-resource-columns "pwdLastSet" --database-connection-string "data source=.;Database=Usercube;Integrated Security=SSPI;Min Pool Size=10;encrypt=false;"<br /></code></pre>
                                        </div>
                                    </div>
                                    <p class="Bold_Subheading">Solicit memory rather than the database</p>
                                    <p>To reduce the database load, the tool's optimizations can be made via the local device's memory.</p>
                                    <p>The following example deletes all the history from the database that is more than 12-month old, the optimizations being computed in memory instead of in the database:</p>
                                    <p>Code attributes enclosed with &lt;&gt; need to be replaced with a custom value before entering the script in the command line.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: XML;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><br />./Usercube-Manage-History.exe --purge-before-months 12 --in-memory --database-connection-string "data source=.;Database=Usercube;Integrated Security=SSPI;Min Pool Size=10;encrypt=false;"<br /></code></pre>
                                        </div>
                                    </div>
                                    <h2 id="arguments">Arguments</h2>
                                    <table style="mc-table-style: url('../../../../../Resources/TableStyles/Sb Table 1.css');margin-left: auto;margin-right: auto;" class="TableStyle-Sb_Table_1" cellspacing="21">
                                        <col class="TableStyle-Sb_Table_1-Column-Column1" />
                                        <col class="TableStyle-Sb_Table_1-Column-Column1" style="width: 88px;" />
                                        <col class="TableStyle-Sb_Table_1-Column-Column1" />
                                        <thead>
                                            <tr class="TableStyle-Sb_Table_1-Head-Header1">
                                                <th style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-HeadE-Column1-Header1">
                                                    <p>Argument Name</p>
                                                </th>
                                                <th class="TableStyle-Sb_Table_1-HeadE-Column1-Header1" style="font-size: 11pt;">
                                                    <p>Type</p>
                                                </th>
                                                <th style="font-size: 11pt;" class="TableStyle-Sb_Table_1-HeadD-Column1-Header1">
                                                    <p>Description</p>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                    <p style="text-align: left;">--clean-duplicates<br />optional</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1" style="font-size: 11pt;">
                                                    <p>No Value</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                    <p>Removes duplicate historical data.</p>
                                                </td>
                                            </tr>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyE-Column1-Body2">
                                                    <p style="text-align: left;">--entity-type<br />required if --excluded-resource-columns is set</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body2" style="font-size: 11pt;">
                                                    <p>String</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyD-Column1-Body2">
                                                    <p>When using <code>--clean-duplicates</code> option, defines the entity type (Id or Identifier) that should have its duplicates removed from the <code>UR_Resources</code> table.</p>
                                                </td>
                                            </tr>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                    <p style="text-align: left;">--excluded-resource-columns<br />required if --entity-type is set</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1" style="font-size: 11pt;">
                                                    <p>String list</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                    <p>When using <code>--clean-duplicates</code> option, defines the list of column names (the name of the columns in the <code>UR_Resources</code> table, or the Identifier of the corresponding um_entityproperty) to exclude when comparing rows of <code>UR_Resources</code> table.</p>
                                                </td>
                                            </tr>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyE-Column1-Body2">
                                                    <p style="text-align: left;">--in-memory<br />default value: False</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body2" style="font-size: 11pt;">
                                                    <p>No value</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyD-Column1-Body2">
                                                    <p>Performs optimizations in memory instead of the database.<br /></p>
                                                    <p>It implies heavy memory consumption but light SQL load.</p>
                                                </td>
                                            </tr>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                    <p style="text-align: left;">--optimize<br />optional</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1" style="font-size: 11pt;">
                                                    <p>String list</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                    <p>Reduces the history and optimizes the versions that are kept based on the precision given through ranges in the argument.</p>
                                                    <p>A range is specified by a duration in minutes followed by the number of occurrences. For example 60:10 defines a range of 60 minutes repeated 10 times, or 10 snapshots repeated at 60 minute intervals. For each interval, at most one version is kept in the history. </p>
                                                    <p>The intervals are evaluated in the given order from now, backwards. In the previous example, it means the more recent versions are kept with a high precision (one per day initially), then with lesser and lesser precision (one per month and then one per year). If the data has not changed over an interval, no optimization can be done.<br /></p>
                                                </td>
                                            </tr>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyE-Column1-Body2">
                                                    <p style="text-align: left;">--purge-before-date<br />optional</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body2" style="font-size: 11pt;">
                                                    <p>String</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyD-Column1-Body2">
                                                    <p>Deletes all the history older than the given date in the yyyyMMdd format.</p>
                                                </td>
                                            </tr>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                    <p style="text-align: left;">--purge-before-months<br />optional</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1" style="font-size: 11pt;">
                                                    <p>String</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyD-Column1-Body1">
                                                    <p> Deletes all the history older than the given number of months.</p>
                                                </td>
                                            </tr>
                                            <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                <td style="text-align: center;font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyB-Column1-Body2">
                                                    <p style="text-align: left;">--database-connection-string<br />required</p>
                                                </td>
                                                <td class="TableStyle-Sb_Table_1-BodyB-Column1-Body2" style="font-size: 11pt;">
                                                    <p>String</p>
                                                </td>
                                                <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyA-Column1-Body2">
                                                    <p>Connection string of the database.</p>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <p>The available actions (clean duplicates; purge; optimize) are all optional, but at least one must be used in the executable command.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
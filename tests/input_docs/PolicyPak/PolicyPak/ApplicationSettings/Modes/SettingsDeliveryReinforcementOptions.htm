<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" class="_Skins_Netwrix_Website" lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Apps, Browsers, &amp; Java Security Pak|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Settings Delivery and Reinforcement Options</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Settings Delivery and Reinforcement Options</h1>
                                    <p>When the client is online and able to make contact with a domain controller, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager will automatically utilize the Group Policy background refresh cycle and ensure that any changed settings are reapplied and up to date (if changed by a user). Additionally, users can manually run the built-in Windows command <code>gpupdate.exe</code> to kick off a background refresh and get updated settings. But what happens if the client is offline?</p>
                                    <p>As seen in Figure 41, a client machine can detect that there is no network connectivity. With no network connectivity, Microsoft's built-in <code>gpupdate.exe </code>will fail when it is run. </p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ApplicationSettings/PolicyPak Application Settings_1_20.png" />
                                    </p>
                                    <p>Figure 41. The error message that is received when <code>gpupdate.exe</code> is run while the client machine is offline.</p>
                                    <p>Because the network is disconnected, no updates can come from the server.</p>
                                    <p>Additionally, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager cannot use AppLock™ for every setting for every application. That is, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager cannot gray out or remove the UI from every application.</p>
                                    <p>In these cases, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager will do the next best thing: it will continually reapply your desired configuration settings to the User and Computer—regardless of whether the computer is online or offline.</p>
                                    <p><span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager will reapply an application's settings manually when </p>
                                    <ul>
                                        <li>
                                            <p>the computer is online and the Microsoft <code>GPupdate </code>command is run and</p>
                                        </li>
                                        <li>
                                            <p>the computer is online or offline and the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> <code>ppupdate</code> command is run.</p>
                                        </li>
                                    </ul>
                                    <p>It will reapply automatically when</p>
                                    <ul>
                                        <li>
                                            <p>the user logs out and logs back in,</p>
                                        </li>
                                        <li>
                                            <p>Group Policy refreshes and reapplies in the background,</p>
                                        </li>
                                        <li>
                                            <p>the application is re-launched, and </p>
                                        </li>
                                        <li>
                                            <p>the Reinforcement Timer kicks in (it must be turned on).</p>
                                        </li>
                                    </ul>
                                    <p>Let's explore the manual command <code>ppupdate</code> and the various automatic ways that <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager will reenforce application settings.</p>
                                    <h2>Manual Reapplication of Settings with PPupdate</h2>
                                    <p>Whether the computer is online or offline, PolicyPak Application Settings Manager can manually reapply settings using<code> ppupdate.exe</code>. In Figure 42, you can see <code>ppupdate.exe</code> being run to reinforce any changed settings.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ApplicationSettings/PolicyPak Application Settings_1_21.png" />
                                    </p>
                                    <p>Figure 42. <code>Ppupdate.exe</code> being run.</p>
                                    <p>This command will work when the computer is online or offline, if the settings that are locally cached on the machine are reapplied, or if you use a non-Group Policy method (where XML data files are used) (see section, "Deploying <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Directives without Group Policy," in Appendix A: Using <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> with MDM and UEM Tools). The <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager <code>ppupdate</code> command never uses the network to retrieve settings, so network connectivity is not needed to run this command.</p>
                                    <h2>Automatic Reapplication of Settings at Application Launch</h2>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>For a demonstration of this feature, please see this video: <a href="../../Video/ApplicationSettings/Superpowers.html" class="MCXref xref" xrefformat="{para}">The Superpowers</a>. </p>
                                    <p>When an application is run, its settings are automatically reapplied before the application is launched. This feature is turned on for all AppSets by default.</p>
                                    <p>If you do not want a particular AppSet's settings to apply automatically when the application is relaunched, it can be disabled when you set up the directives inside the GPMC.</p>
                                    <p>Inside the AppSet definition, find the Options button and deselect "Always re-apply settings when application runs." As you can see in Figure 43, all applications are checked by default. You can uncheck the checkbox to stop the reapplication.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ApplicationSettings/PolicyPak Application Settings_1_22.png" />
                                    </p>
                                    <p>Figure 43. Select or unselect the "Always re-apply settings when application runs" setting in the Options inside the Pak definition.</p>
                                    <p>Remember that the applications' settings will still reapply during periodic Group Policy background processing, or if you manually run <code>GPupdate </code>and have that setting enabled.</p>
                                    <p>The reapplication is provided by a kernel-mode driver, which is actively looking for applications that <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager is managing. If you wish to fully disable the kernel-mode driver (and, hence, the automatic reapplication of settings), you need to manually configure a Registry setting on the client at <code>HKLM\Software\PolicyPak\Config\Driver</code>, and then set Enabled (REG_DWORD) to 0. This is demonstrated in Figure 44.</p>
                                    <p>Note that you also should either reboot the machine to disable or re-enable the driver.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ApplicationSettings/PolicyPak Application Settings_1_23.png" />
                                    </p>
                                    <p>Figure 44. Use the following Registry location to fully disable the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> driver, which performs reapplication of settings for applications.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span> Log files for the automatic reapplication of settings at launch are found in<code> %appdata%\local\PolicyPak</code> in a file called ppUser_onLaunch.log.</p>
                                    <h2>Automatic Reapplication of Settings with the Reinforcement Timer</h2>
                                    <p>As previously stated, when the client is online and able to make contact with a domain controller, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager will automatically utilize the Group Policy background refresh cycle and ensure that any changed settings are reapplied as well as up to date (if changed by a user). And, a user can manually run <code>ppupdate.exe</code> for reapplication of settings when online or offline. Also, when the application is next run, the default behavior is set to have <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager reapply the application's settings. </p>
                                    <p><span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager has an optional switch, which must be manually turned on in the client's Registry, that will reapply applications' settings based on a timer. In essence, this runs <code>ppupdate</code> on a prescribed timeline. You might want to use this feature if the app is run infrequently or if you suspect that another application is modifying the application's settings.</p>
                                    <p>Again, the reinforcement timer is not enabled by default on the target machine. If you want to turn it on, edit <code>HKLM\Software\PolicyPak\Config\Scheduler</code> for everyone on the whole computer or <code>HKCU\Software\PolicyPak\Config\Scheduler</code> for a specific user on the machine and set ReapplyPeriod (as a REG_DWORD) to the desired interval in seconds. The allowed range is 30 seconds to 24 hours (86400 seconds). If you'd like to utilize the feature, the recommended reinforcement time is 30 minutes (1800 seconds) to 60 minutes (3600 seconds).</p>
                                    <p>However, note that if you enable the "Do not re-apply settings with Reinforcement Timer," as seen in Figure 45 (which is at the AppSet level), then the specific AppSet will NOT be reapplied when the timer is supposed to apply it. In short, by setting this option, you bypass reapplication of the settings even when the enforcement timer is set.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ApplicationSettings/PolicyPak Application Settings_1_24.png" />
                                    </p>
                                    <p>Figure 45. Enabling the "Do not re-apply settings with Reinforcement Timer" setting.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span> Log files for the "Automatic reapplication of settings using the timer" can be found in<code> %appdata%\local\PolicyPak</code> in a file called ppUser_onSchedule.log.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
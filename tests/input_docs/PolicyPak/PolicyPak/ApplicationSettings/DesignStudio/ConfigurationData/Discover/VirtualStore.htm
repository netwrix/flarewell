<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" class="_Skins_Netwrix_Website" lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Apps, Browsers, &amp; Java Security Pak|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Configuration Data in VirtualStore</title>
        <link href="../../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Configuration Data in VirtualStore</h1>
                                    <p>Sometimes, programs don't know that they are not allowed to store data in the protected Windows locations. When a standard user runs the application and tries to change configuration data, the application's configurations are not written to these protected Windows locations. They are redirected or virtualized instead. In Figure 91, we can see that when the application tried to write its data to <code>c:\Program Files</code>, it was actually redirected to </p>
                                    <p><code>%LocalAppData%\VirtualStore\Program Files (x86)\Foxit Software\Foxit Reader</code>.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_4.png" />
                                    </p>
                                    <p>Figure 91. Application data that has been redirected. </p>
                                    <p>This is a safety mechanism that Windows uses to allow applications to think that they've written data to the desired location (<code>\Program Files</code>), when in actuality, the application's data was really written to </p>
                                    <p><code>%appdata%\local\virtualstore\Program Files (x86)\Foxit Software\Foxit Reader</code>. However, there is one problem with this: both 32-bit and 64-bit client machines could possibly be our targets. Because of this, even though we're finding the file in </p>
                                    <p><code>%LocalAppData%\VirtualStore\Program Files (x86)\Foxit Software\Foxit Reader</code> (as shown in Figure 92), the data file could also be found on 32-bit machines in 
		<code>%LocalAppData%\VirtualStore\Program Files\Foxit Software\Foxit Reader</code> (as shown in Figure 93).</p>
                                    <p style="text-align: center;">
                                        <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_5.png" />
                                    </p>
                                    <p>Figure 92. The location for 64-bit machines is <code>%LocalAppData%\VirtualStore\Program Files (x86).</code></p>
                                    <p style="text-align: center;">
                                        <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_6.png" />
                                    </p>
                                    <p>Figure 93. The location for 32-bit machiens is <code>%LocalAppData%\VirtualStore\Program Files.</code> </p>
                                    <p>If you select a file within the VirtualStore directory, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> DesignStudio recognizes this and provides two features to ensure proper delivery to clients. First, as shown in Figure 94, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> DesignStudio will substitute the correct variable so it will work on client machines of the same type.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_7.png" />
                                    </p>
                                    <p>Figure 94. <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> DesignStudio substituting the correct variable.
              
        </p>
                                    <p>To account for the possibility that you might have both 32-bit and 64-bit machines as targets, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Application Settings Manager, by default, will always try to write to both locations on the target machine. That way, you're ensured that both 32-bit and 64-bit machines will get your directives. Note that this behavior is controllable within <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> <code>DesignStudio in Tools|Options </code>in the VirtualStore tab, as shown in Figure 95. It is recommended that you keep this checkbox checked. </p>
                                    <p style="text-align: center;">
                                        <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_8_624x322.png" class="img_151" style="width: 624;height: 322;" />
                                    </p>
                                    <p>Figure 95. The VirtualStore tab.
                </p>
                                    <p>If you want to see both actions, you can click on the element's "Advanced" button, as shown in Figure 96, and see the two actions created.</p>
                                    <p style="text-align: center;"> <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_9_312x592.png" class="img_152" style="width: 312;height: 592;" /></p>
                                    <p>Figure 96. The element's "Advanced" button.
                   </p>
                                    <p>If you were to hover the mouse over each "File" location, you would see that the actions are set against each possible file location automatically (<code>\Program Files(x86)</code> and <code>\Program Files</code>), one for the first action and another for the second action, as shown in Figure 97 and Figure 98.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_10.png" />
                                    </p>
                                    <p>Figure 97. The file location for the first action.</p>
                                    <p style="text-align: center;"> <img src="../../../../../Resources/Images/Appendix B - PolicyPak Application Manager DesignStudio Guide/Discovering Configuration_11_624x79.png" class="img_154" style="width: 624;height: 79;" /></p>
                                    <p>Figure 98. The file location for the second action.
                </p>
                                    <p>Therefore, there's really no downside in leaving the "Always create additional action when target files utilize Windows 7 "VirtualStore" directories (recommended)" turned on. It will mean that your 64-bit and 32-bit applications will read the right file and be correctly configured.</p>
                                    <p>For more information on the idea of how an application uses file virtualization, see the following resources:</p>
                                    <ul>
                                        <li>
                                            <p>Video and example app for testing: <a href="http://www.msigeek.com/328/video-file-registry-virtualization-in-windows-7" class="a_1">http://www.msigeek.com/328/video-file-registry-virtualization-in-windows-7</a></p>
                                        </li>
                                        <li>
                                            <p><a href="http://msdn.microsoft.com/en-us/library/bb756960.aspx" class="a_1">http://msdn.microsoft.com/en-us/library/bb756960.aspx</a>. Look for "Virtualization" about halfway down the page. </p>
                                        </li>
                                        <li>
                                            <p><a href="http://www.thewindowsclub.com/file-registry-virtualization-in-windows-7" class="a_1">http://www.thewindowsclub.com/file-registry-virtualization-in-windows-7</a>. </p>
                                        </li>
                                        <li>
                                            <p>Group Policy: Fundamentals, Security and the Managed Desktop by Jeremy Moskowitz Page 561–562. Available at <a href="http://www.GPanswers.com/book">www.GPanswers.com/book</a>. </p>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
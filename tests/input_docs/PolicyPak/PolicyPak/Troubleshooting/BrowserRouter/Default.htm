<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Browser Router|[%=System.LinkedTitle%]|Troubleshooting">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Why is Browser Router not showing up as the OS Default Browser since Feb24/March24 Monthly windows patches KB5035845?</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Why is Browser Router not showing up as the OS Default Browser since Feb24/March24 Monthly windows patches KB5035845?</h1>
                                    <p><b>Updated 9/12/2024</b>: Starting from CSE version 24.9 and later this problem has been overcome. If you're using CSE version 24.9 and later, there is no need to follow these steps. Only use these steps if you're using a CSE before version 24.9.</p>
                                    <p><span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> Browser Router and <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> File Associations Manager will generally still work as expected.  
However, since the Feb24/March24 Monthly windows patches KB5035845, Edge appears to “take over and won’t let go” of: </p>
                                    <ul>
                                        <li>
                                            <p>
File Association PDF</p>
                                        </li>
                                        <li>
                                            <p>Protocol: HTTP</p>
                                        </li>
                                        <li>
                                            <p>Protocol: HTTPS</p>
                                        </li>
                                    </ul>
                                    <p>What will work:</p>
                                    <ul>
                                        <li>
                                            <p>Browser to Browser Routing</p>
                                        </li>
                                        <li>
                                            <p>File Associations for everything except PDF</p>
                                        </li>
                                    </ul>
                                    <p>What won’t work:</p>
                                    <ul>
                                        <li>
                                            <p>Browser Router won’t be registered as “<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Browser Router Agent” within the OS. You’ll see Edge.</p>
                                        </li>
                                        <li>
                                            <p>Browser Router “Default Policy” type is not honored as expected and anything set to “Default Browser” will be passed onward to Edge (instead of what you might have set it to, say, Firefox, Chrome, etc). Use this article to understand “<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Browser Router Default Policy” type <a href="../../BrowserRouter/DefaultBrowser/Defined.htm" target="_parent" title="What is meant by &quot;Default Browser&quot; within Endpoint Policy Manager Browser router?" alt="What is meant by &quot;Default Browser&quot; within Endpoint Policy Manager Browser router?" class="MCXref xref" xrefformat="{para}">What is meant by "Default Browser" within Endpoint Policy Manager Browser router?</a></p>
                                        </li>
                                        <li>
                                            <p>Delivering File Associations specifically for PDF for <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> File Associations Manager</p>
                                        </li>
                                    </ul>
                                    <p>You will also get the same experience if you attempt to use PolicyPak File Associations Manager to change HTTP or HTTPS, even if you’re not using PolicyPak Browser Router. See the <a href="../../FileAssociations/DefaultBrowser.htm" target="_parent" title="Can I use Endpoint Policy Manager Browser Router and/or Endpoint Policy Manager File Associations Manager to set the default browser?" alt="Can I use Endpoint Policy Manager Browser Router and/or Endpoint Policy Manager File Associations Manager to set the default browser?" class="MCXref xref" xrefformat="{para}">Can I use Endpoint Policy ManagerBrowser Router and/or Endpoint Policy Manager File Associations Manager to set the default browser?</a> topic for additional information.</p>
                                    <p class="Bold_Subheading">Troubleshooting:</p>
                                    <p>Here’s an example log output:</p>
                                    <p>The <code>ppSwitched_onLogon</code> log file shows “Default Browser: MicrosoftEdge.EXE</p>
                                    <p>Agent Display Name: 'Managed by your organization (Browser Name)</p>
                                    <p>Use actual default browser icon: true</p>
                                    <p>Later in that file it shows an error:</p>
                                    <p>Updating system settings and registry entries</p>
                                    <div class="codeSnippet">
                                        <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>{<br />&#160;&#160;&#160;&#160;Loaded browser router policies state for user 'sxr'. Active: true<br />&#160;&#160;&#160;&#160;Loaded browser router policies state for any user. Active: true<br />&#160;&#160;&#160;&#160;Updating 'Browser Router' browser settings<br />&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;Going to apply user side settings.<br />&#160;&#160;&#160;&#160;&#160;&#160;Going to save default browser selected by user.<br />&#160;&#160;&#160;&#160;&#160;&#160;Default browser selected by user: 'MSEdgeHTM'<br />&#160;&#160;&#160;&#160;&#160;&#160;Default browser selected by user: 'MSEdgeHTM'<br />&#160;&#160;&#160;&#160;&#160;&#160;Changing program associations<br />&#160;&#160;&#160;&#160;&#160;&#160;{<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Error: Couldn't write association for 'http'. ProgId: 'PPBRNURL', Error code: 5<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Error: Couldn't write association for 'https'. ProgId: 'PPBRNURL', Error code: 5<br />&#160;&#160;&#160;&#160;&#160;&#160;} // End of Changing program associations, elapsed time: 00:00:00.078&#160;<br /></code></pre>
                                        </div>
                                    </div>
                                    <p>However, there is a workaround for both scenarios if your computers are DOMAIN JOINED.</p>
                                    <p>You can Revert to Legacy methods which have some detractors. Read the Explain/Help text for each of these two policy settings to decide if you want to revert back one or both products to Legacy method.</p>
                                    <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>The Legacy methods will not work if your endpoints are only using PolicyPak Cloud or only using an MDM service like Intune. Legacy mode only works when the machine is domain joined.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>After setting these settings and the policy refresh occurs to get these policies, endpoints may still need two logoffs and/or reboots for this to kick in.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/BrowserRouter/1326_1_2c5259c2472101dd55c56da8d1dbdb33.png" />
                                    </p>
                                    <p>
                                        <img src="../../../Resources/Images/Troubleshooting/BrowserRouter/1326_2_8f4ae9cf7f0bba8ddccb128640467c25.png" />
                                    </p>
                                    <p>Update 4/8/2024:</p>
                                    <p>It was identified that UCPD.sys driver is causing the issue with default file association for .PDF and protocol association for HTTP/HTTPS.</p>
                                    <p>UCPD.sys affects the following registry paths responsible for the associations to file extensions and protocols:</p>
                                    <p class="Bold_Subheading">Workaround 1 using <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers</p>
                                    <p>To fix the issue, you need to perform two steps:</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Create a Powershell script which will disable the UCPD.sys driver via registry.</p>
                                    <ul>
                                        <li>
                                            <p><code>New-ItemProperty -Path “HKLM:\SYSTEM\CurrentControlSet\Services\UCPD” -Name “Start” -Value 4 -PropertyType DWORD -Force</code>
                                            </p>
                                            <ul>
                                                <li>
                                                    <p>This script is setting value 4 to UCPD service to be disabled</p>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <p><code>Unregister-ScheduledTask -TaskName "UCPD velocity"</code>
                                            </p>
                                            <ul>
                                                <li>
                                                    <p>This part will unregister the scheduled task to check and re-deploy UCPD service at startup</p>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>
                                            <div class="codeSnippet">
                                                <div class="codeSnippetCaption">
                                                    <p>Disable UCPD.sys driver</p>
                                                </div>
                                                <div style="mc-code-lang: PowerShell;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><span style="color: #a71d5d; font-weight: bold; ">New-ItemProperty</span> -Path “HKLM:\SYSTEM\CurrentControlSet\Services\UCPD” -Name “Start” -Value <span style="color: #333333; ">4</span> -PropertyType DWORD -Force<br /><span style="color: #a71d5d; font-weight: bold; ">Unregister-ScheduledTask</span> -TaskName <span style="color: #df5000; ">"UCPD velocity"</span><br /><span style="color: #a71d5d; font-weight: bold; ">Unregister-ScheduledTask</span> -TaskName <span style="color: #df5000; ">"Pre-staged app cleanup"</span></code></pre>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Deploy the script via <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts Manager using the hints from the screen shot below.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Troubleshooting/BrowserRouter/1326_3_3e0331eadab3e6c272573b5c3b67e23c.png" />
                                    </p>
                                    <p class="Bold_Subheading">Workaround 2 using fsLogix (Microsoft Tools)</p>
                                    <p>You may also use Microsoft fsLogix if already installed on servers or workstations. You may use the following redirect rules which should overcome the concern.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>Do not use both Workaround 1 and 2 at the same time.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/BrowserRouter/1326_4_3a4d59894f3cd6623b958202447b1136.png" />
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
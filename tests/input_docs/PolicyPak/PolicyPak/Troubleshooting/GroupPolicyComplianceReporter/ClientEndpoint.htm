<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" class="_Skins_Netwrix_Website" lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|GPO Compliance Pak|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Troubleshooting Client and Endpoint Problems</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Troubleshooting Client and Endpoint Problems</h1>
                                    <p>In the sections below, we'll discuss some common problems and errors associated with the client and endpoints.</p>
                                    <h2>Forcing the Server to See Updated Computers in Active Directory</h2>
                                    <p>If you attempt to create a snapshot and you are unable to locate computers you expect, this does not necessarily mean that something is wrong. The Compliance Reporter server only checks where computers are in Active Directory once an hour. Therefore, if a computer is moved or renamed, PPGPCR won't know about it until the next hour. However, you can restart the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR Server service as shown in Figure 60. Then the most recent Active Directory data will be pulled and used.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Appendix F - PolicyPak Group Policy Compliance Reporter/Tuning and Troubleshooting_2.png" />
                                    </p>
                                    <p>Figure 60. Restarting the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR server service.
        </p>
                                    <h2>Forcing the Auditor to Run</h2>
                                    <p>There are two ways to get the auditor to send data to the server: </p>
                                    <ul>
                                        <li>
                                            <p>Running the scheduled task as an admin </p>
                                        </li>
                                        <li>
                                            <p>Running PPGPCR.Auditor.exe as SYSTEM (not as an admin)</p>
                                        </li>
                                    </ul>
                                    <p>In order to see the scheduled task on an endpoint, you must be logged in as an admin or run Task Scheduler as an admin. Only then will you see the "<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GP Compliance Reporter Auditor" task as shown below. To force it to run, right-click on the task, and select "Run," as shown in Figure 61. It will go from being queued to having a finished status.</p>
                                    <p>
                                        <p>
                                            <img src="../../../Resources/Images/Appendix F - PolicyPak Group Policy Compliance Reporter/Tuning and Troubleshooting_3.png" />
                                        </p>
                                        <p>Figure 61. Running the scheduled task from the Task Scheduler.
                </p>
                                    </p>
                                    <p>The second way to try to run the auditor is by hand, as SYSTEM. Local admin rights are not sufficient, and if you try to run the auditor as a user or admin, you will get an error, as shown in Figure 62.</p>
                                    <p>
                                        <p>
                                            <img src="../../../Resources/Images/Appendix F - PolicyPak Group Policy Compliance Reporter/Tuning and Troubleshooting_4.png" />
                                        </p>
                                        <p>Figure 62. Running the auditor as a user or admin will result in an error.
                </p>
                                    </p>
                                    <p>To run the auditor as SYSTEM, you need to open an admin command prompt, and download and run the PSEXEC tool from Microsoft. Run <code>PsExec -i -s CMD</code>, as shown in Figure 63. Then, to force the auditor to run, run <code>\\server\share\PPGPCR.Auditor.exe TargetServer /force</code>. You must specify the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR server on the command line, as shown in Figure 63.</p>
                                    <p>
                                        <p>
                                            <img src="../../../Resources/Images/Appendix F - PolicyPak Group Policy Compliance Reporter/Tuning and Troubleshooting_5.png" />
                                        </p>
                                        <p>Figure 63. Specifying the PPGPCR server on the command line.
                </p>
                                    </p>
                                    <p>The above steps will perform the same work as the Task Scheduler, and can be used if scheduled task is not operational.</p>
                                    <h2>Connection Errors</h2>
                                    <p>When making manual snapshots, if you see many machines reporting back "Connection Error," that means that there was a communication problem between the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR client (admin console) and each target machine requesting RSOP. An example of these errors is shown in Figure 64.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>For a video addressing the opening of the firewall ports as described in this section, please go to the following link: <a href="../../Video/GPOCompilanceReporter/FirewallPorts.html" class="MCXref xref">Open required firewall ports</a>.</p>
                                    <p>
                                        <p>
                                            <img src="../../../Resources/Images/Appendix F - PolicyPak Group Policy Compliance Reporter/Tuning and Troubleshooting_6.png" />
                                        </p>
                                        <p>Figure 64. Connection errors indicating a communication problem.
                </p>
                                    </p>
                                    <p>When this occurs, it is almost always caused by one of the following issues:</p>
                                    <ul>
                                        <li>
                                            <p>The target machine is off.</p>
                                        </li>
                                        <li>
                                            <p>The target machine has the Windows firewall turned on and is blocking the "Remote Admin" ports.</p>
                                        </li>
                                        <li>
                                            <p>DNS is not functioning between the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR client (admin console) and the target machine.</p>
                                        </li>
                                    </ul>
                                    <p>The <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR client (admin console) must be able to contact each target machine and request its RSOP. If any of the conditions above are true, you cannot receive that computer's data. Adjusting for DNS problems is beyond the scope of this manual. However, one problem we can address is opening the remote administration ports (ports 135 and 445) on the target machines. You can do this very easily by using Group Policy.</p>
                                    <p>Create a Group Policy setting for your machines to open the required ports. In Figure 65, you can see an example of a GPO linked to "East Sales Desktops." The setting to open the ports is located at Computer Configuration | Admin Templates | Network | Network Connections | Windows Firewall | Domain Profile | Windows Firewall: Allow inbound remote administrative exception, as shown in Figure 65.</p>
                                    <p>
                                        <p>
                                            <img src="../../../Resources/Images/Appendix F - PolicyPak Group Policy Compliance Reporter/Tuning and Troubleshooting_7.png" />
                                        </p>
                                        <p>Figure 65. Enabling the setting "WIndows Firewall: Allow inbound remote administrative exception."
                </p>
                                    </p>
                                    <p>When you do this, you will be able to remotely grab RSOP from target computers.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>After you make this change, it could take up to 120 minutes for all computers in the organizational unit (OU) to receive this signal. You can reboot them or manually run GPUpdate instead of waiting.</p>
                                    <h2>License Errors</h2>
                                    <p>When computers return "No License" in the snapshot status, this means a successful connection was established, but a <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR license was not found.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span> Target machines must be licensed for <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR to return all data (Microsoft and <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> data).</p>
                                    <p>When a machine is licensed for <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GP Compliance Reporter, you should see its status shown as "OK," as shown in Figure 66. A status of "Connection Error" or "No License" indicates problems where this computer will not be able to be reported on.</p>
                                    <p>
                                        <p>
                                            <img src="../../../Resources/Images/Appendix F - PolicyPak Group Policy Compliance Reporter/Tuning and Troubleshooting_8.png" />
                                        </p>
                                        <p>Figure 66. The license status of the machines.
            </p>
                                    </p>
                                    <h2>Warning Messages</h2>
                                    <p>Just as Group Policy contains both user-side and computer-side items, the RCT does as well. <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> GPCR helps test for compliance to your RCT. As such, an "OK" status is obtained only when 100% of the settings in the RCT (on the user- or computer-side) match what is on the target computer. Unless there is a perfect match, you will receive a warning, as shown in Figure 67.</p>
                                    <p>
                                        <p>
                                            <img src="../../../Resources/Images/GPOCompilanceReporter/GPCR Concepts and Quickstart_29_624x174.png" class="img_211" style="width: 624;height: 174;" />
                                        </p>
                                        <p>Figure 67. You will receive a warning if there is not a perfect match between the RCT and the target computer.
                </p>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Getting Started with Endpoint Policy Manager (Misc)|[%=System.LinkedTitle%]|Tips, Tricks and FAQs">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Set and Manage the Uninstallation Password for Endpoint Policy Manager Client-Side Extension </title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Set and Manage the Uninstallation Password for Endpoint Policy Manager Client-Side Extension </h1>
                                    <p>Starting with CSE 25.2, the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Client-Side Extension (CSE) Installer includes new command-line options that allow administrators to set and update an uninstallation password. This ensures that CSE can only be uninstalled with the correct password, adding an extra layer of protection.</p>
                                    <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>This feature is not strictly considered to be a security feature, but rather another layer of uninstallation protection. If someone is a local administrator on the machine or provided admin rights to certain tools via <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Least Privilege Manager (or similar), they may be able to work around the password.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>At the end of this topic, there is an explanation of how a true local administrator on the machine is authorized to uninstall the CSE without a password for emergency purposes. However, this may be exploited by any local administrator or those with admin-like rights when a tool like <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Least Privilege Manager is used.</p>
                                    <p>Based on  the information in this guide, you can determine if the password uninstall mechanism is enough for your company and should be used or not.</p>
                                    <p>This guide explains how to:</p>
                                    <ul>
                                        <li>
                                            <p>Set an uninstallation password during installation</p>
                                        </li>
                                        <li>
                                            <p>Update or repair an existing installation with a new password</p>
                                        </li>
                                        <li>
                                            <p>Uninstall CSE when a password has been set</p>
                                        </li>
                                    </ul>
                                    <p class="Bold_Subheading">Tips</p>
                                    <ul>
                                        <li>
                                            <p>If a password is provided, but it cannot be saved to the registry, the installation will be interrupted with an error</p>
                                        </li>
                                        <li>
                                            <p>Password protection is optional. No password is required.</p>
                                        </li>
                                        <li>
                                            <p>If no password is provided, CSE upgrade will install normally without requiring an uninstall password</p>
                                        </li>
                                    </ul>
                                    <h2>Set an Uninstallation Password During Installation</h2>
                                    <p>An uninstallation password can be specified at the time of installation using the <code>UNPASSWORD</code> command-line option.</p>
                                    <p class="Bold_Subheading">Example Password</p>
                                    <p>If you use the password “HelloWorld” and Base64 encrypt it, you will get <code>SGVsbG9Xb3JsZA==</code> as the result. You can use an encoder like <a href="https://www.base64encode.org/" target="_blank" title="Base64 Encode" alt="Base64 Encode">Base64 Encode</a>, shown below.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/CSE/Base64Format.png" />
                                    </p>
                                    <p class="Bold_Subheading">Example Use of the Feature</p>
                                    <ul>
                                        <li>
                                            <p><code>msiexec /i "PolicyPak Client-Side Extension x64.msi" UNPASSWORD=SGVsbG9Xb3JsZA==</code>
                                            </p>
                                        </li>
                                        <li>
                                            <p>The password must be provided as a Base64-encoded string</p>
                                        </li>
                                        <li>
                                            <p>If a password is set, CSE cannot be uninstalled without providing the same password</p>
                                        </li>
                                    </ul>
                                    <p>See the interactive example shown in the screenshot.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/CSE/CSEWizard.png" />
                                    </p>
                                    <p>If you try to uninstall the CSE by hand without a password, the following error message is displayed.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/CSE/CSEUninstallPW.png" />
                                    </p>
                                    <h2>Uninstall CSE When a Password Is Set</h2>
                                    <p>If an uninstallation password was configured, it must be provided during the uninstall process.</p>
                                    <p class="Bold_Subheading">Example Command</p>
                                    <p><code>msiexec /x "PolicyPak Client-Side Extension x64.msi" UNPASSWORD=SGVsbG9Xb3JsZA==</code>
                                    </p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/CSE/CSEPassword.png" />
                                    </p>
                                    <p class="Bold_Subheading">Uninstallation Rules</p>
                                    <ul>
                                        <li>
                                            <p>If the correct password is provided, CSE is uninstalled successfully</p>
                                        </li>
                                        <li>
                                            <p>If the wrong password is provided, the uninstallation fails with an error, and CSE remains installed</p>
                                        </li>
                                        <li>
                                            <p>If no password was set originally, CSE can be uninstalled normally without requiring <code>UNPASSWORD</code></p>
                                        </li>
                                        <li>
                                            <p>If a password was set but <code>UNPASSWORD</code> is not provided in the command, the uninstallation fails with an error</p>
                                        </li>
                                    </ul>
                                    <h2>Update or Repair an Existing Installation</h2>
                                    <p>The uninstallation password can be updated or repaired by using both <code>UNPASSWORD</code> (current password) and <code>NEWUNPASSWORD</code> (new password) in the installer command.</p>
                                    <p class="Bold_Subheading">Example Command</p>
                                    <p><code>msiexec /i "PolicyPak Client-Side Extension x64.msi" UNPASSWORD=SGVsbG9Xb3JsZA== NEWUNPASSWORD=SGVsbG9Xb3JsZEFnYWlu</code>
                                    </p>
                                    <p class="Bold_Subheading">Update Rules</p>
                                    <ul>
                                        <li>
                                            <p>If <code>UNPASSWORD</code> matches the existing saved password, the password is updated to <code>NEWUNPASSWORD</code></p>
                                        </li>
                                        <li>
                                            <p>If <code>NEWUNPASSWORD</code> is missing or cannot be saved, the installation fails with an error</p>
                                        </li>
                                        <li>
                                            <p>If <code>UNPASSWORD</code> and <code>NEWUNPASSWORD</code> are the same, the update is considered successful with no changes made</p>
                                        </li>
                                        <li>
                                            <p>If an incorrect <code>UNPASSWORD</code> is provided, the installation fails with an error</p>
                                        </li>
                                        <li>
                                            <p>If no <code>UNPASSWORD</code> is provided, but a password was set during installation, the update fails with an error</p>
                                        </li>
                                        <li>
                                            <p>If no password was previously set, and <code>NEWUNPASSWORD</code> is provided, the new password is saved as the uninstallation password</p>
                                        </li>
                                    </ul>
                                    <p class="Bold_Subheading">Storage and Security</p>
                                    <p>The password is encrypted and stored in the Windows Registry at:</p>
                                    <p><code>HKEY_LOCAL_MACHINE\SOFTWARE\PolicyPak\Config\CSE\Installer</code>
                                    </p>
                                    <p class="Bold_Subheading">Registry value details</p>
                                    <ul>
                                        <li>
                                            <p>Type — REG_BINARY</p>
                                        </li>
                                        <li>
                                            <p>Name — UninstallPassword</p>
                                        </li>
                                    </ul>
                                    <p>The password is encrypted with the Windows Data Protection API (DAPI) and not in plain text.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/CSE/EditBinary.png" />
                                    </p>
                                    <p>This registry key is protected and accessible only by Administrators and the Local System account.  The password cannot be copied to another machine. If the registry value is transferred, CSE will not recognize it on a different system.</p>
                                    <h2>Emergency Uninstallation without Password</h2>
                                    <p>As an emergency method of uninstallation, you may use the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> ADMX Troubleshooting files which contains a policy named “Force disable uninstall password”.</p>
                                    <p>See the <a href="../../Video/Troubleshooting/ADMXFiles.html" target="_parent" title="Troubleshooting with ADMX files" alt="Troubleshooting with ADMX files" class="MCXref xref" xrefformat="{para}">Troubleshooting with ADMX files</a> topic for additional information about the ADMX troubleshooting files.</p>
                                    <p>When this ADMX setting is set locally or targeted to a machine, the CSE will uninstall without a password.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/Troubleshooting/CSE/DisableUninstallPW.png" />
                                    </p>
                                    <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>Again as stated in the introduction of this document, someone with access rights to change the KHLM part of the registry or use the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> ADMX files could circumvent the password previously set earlier.</p>
                                    <h2>Conclusion</h2>
                                    <ul>
                                        <li>
                                            <p>The ability to set, update, and enforce an uninstallation password provides additional layer for CSE deployments.</p>
                                        </li>
                                        <li>
                                            <p>Administrators should carefully manage passwords to ensure seamless management and prevent unauthorized removals.</p>
                                        </li>
                                    </ul>
                                    <p class="Remember" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;i&gt;Remember, &lt;/i&gt;&lt;/span&gt;"><span class="autonumber"><span class="Remember"><span style="color: #fb8000;" class="mcFormatColor"><i>Remember, </i></span></span></span>anyone with full admin rights (or ability to use the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> ADMX settings) can circumvent the password set on the machine.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" class="_Skins_Netwrix_Website" lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Desktop Automation &amp; Connectivity Pak|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Quick Start - Making and Removing Shortcuts</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Quick Start - Making and Removing Shortcuts</h1>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>For some video overviews of <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager, see <a href="https://www.policypak.com/products/policypak-scripts-manager.html" target="_blank">https://www.policypak.com/products/policypak-scripts-manager.html</a> </p>
                                    <p>In this Quickstart example, we're going to deliver a shortcut to the desktop with a script. The shortcut will appear when the policy applies, and disappear when the policy no longer applies (i.e., when it "falls out of scope").</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Start out on your GPMC management station to create a group policy object (GPO) and link it to your users. In this example (Figure 7) we have a GPO created and linked it to the East Sales Users OU.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_3.png" />
                                    </p>
                                    <p>Figure 7. Using Group Policy to create and link a GPO to East Sales Users.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Edit the GPO, then go to User Configuration | <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> | Scripts &amp; Triggers Manager as shown in Figure 8 and select Add | New Policy. </p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_4.png" />
                                    </p>
                                    <p>Figure 8. Using the Group Policy Editor to make a new <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager policy.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>When you do this, the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager Wizard appears. Click "Next" to continue.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>At the "On apply action" page, select "PowerShell script," then paste in the contents from the PS\Create_PolicyPak_Shortcut.ps1 file from the PS folder included in the downloaded examples. The result can be seen in Figure 9.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_5.png" />
                                    </p>
                                    <p>Figure 9. Using <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Trigger Manager to deliver a PowerShell script.</p>
                                    <p>It should be noted that "Run interactively" is not checked in this example. This option should be used when you want to see an individual script perform its work, or if the user needs to interact with the script.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The "Run interactively" option is not available when the policy specifies that a script is meant for computers.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>On the "On revert action" page, select "PowerShell script," then copy in the Remove_PolicyPak_Shortcut.ps1 script contents, as seen in Figure 10.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_6.png" />
                                    </p>
                                    <p>Figure 10. Setting up a Revert Action script when the policy no longer applies.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 6 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 6 – </b></span></span>Click "Next" to continue. You will encounter the "Specify process mode" screen seen in Figure 11.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_7.png" />
                                    </p>
                                    <p>Figure 11. Specifying when the script should run.</p>
                                    <p>The "Specify process mode" page enables you to dictate when a script will apply. </p>
                                    <ul>
                                        <li>
                                            <p>Always: Will apply every time a policy processes. </p>
                                            <ul>
                                                <li>
                                                    <p>For Group Policy, this coincides with login, and runs in the background about every 90 minutes or so, when a DC is available.</p>
                                                </li>
                                                <li>
                                                    <p>For <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Cloud, this is every 60 minutes. (If you can see the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Cloud service.)</p>
                                                </li>
                                                <li>
                                                    <p>For <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> + MDM, this will apply user policies on login and on the computer side. "Switched" policies, explained later, should apply when the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> service starts or restarts (for example, on a reboot). </p>
                                                </li>
                                            </ul>
                                        </li>
                                        <li>Once: Will only apply one time when the policy is initially placed on the machine (when using Group Policy, Microsoft Endpoint Manager, or an MDM method).</li>
                                        <li>
                                            <p>Once or when forced: Will initially apply only one time, but you can re-run the policy and its script by running<code> gpupdate /force</code> when using Group Policy or <code>ppupdate /force</code> when using any other policy deployment method.</p>
                                        </li>
                                    </ul>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 7 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 7 – </b></span></span>For this Quickstart example, select the default and click "Next." At the "Policy settings" page, give the policy a name like "Desktop icon on and off." Leave the State and Item-Level Targeting fields set with the defaults, as shown in Figure 12, and click "Finish."</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_8.png" />
                                    </p>
                                    <p>Figure 12. <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager Wizard final settings page.</p>
                                    <p>The result of the policy you created can be seen in an entry like the one shown in Figure 13.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_9.png" />
                                    </p>
                                    <p>Figure 13. The new <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts policy in the Group Policy Editor.</p>
                                    <p>You can also validate that your settings are contained within the GPO by looking at the Group Policy HTML settings report in the GPMC, as shown in Figure 14.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_10.png" />
                                    </p>
                                    <p>Figure 14. <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager items appear in the GPMC reports.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 8 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 8 – </b></span></span>Now for testing, log into the endpoint as a new or existing user for whom the policy applies. In this example, we'll log in as EastSalesUser8. When logging in, you'll see the policy apply the script and an icon like the one shown in Figure 15 will be visible.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_11.png" />
                                    </p>
                                    <p>Figure 15. An example of a <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager PowerShell script on the endpoint.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 9 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 9 – </b></span></span>To complete testing, go back to the GPMC, and un-link the GPO to make it stop applying, as seen in Figure 16.</p>
                                    <p>
                                        <img src="../../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/Getting to Know Scripts Triggers_12.png" />
                                    </p>
                                    <p>Figure 16. Make a policy stop applying by removing the "Link Enabled" settings in the GPMC.</p>
                                    <p>The policy has now fallen out of scope and will stop applying. Back on the endpoint, run GPupdate. When you do, the "Off" script will run and the "Visit <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span>" icon will disappear.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
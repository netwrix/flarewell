<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" class="_Skins_Netwrix_Website" lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Desktop Automation &amp; Connectivity Pak|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Ins and Outs</title>
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Ins and Outs</h1>
                                    <p><span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager solves several huge Windows 10 issues. Its basic goal is to deliver scripts using whatever delivery mechanism you might want. For on-prem machines, you already have some good, but not great, options for running the occasional script. With <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Cloud, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts &amp; Triggers Manager brings a method to deploy scripts that didn't exist before. For those using an MDM solution, there is built-in script deployment, but it has many restrictions. In this section, we'll examine how scripts have worked with the in-box Group Policy method and with MDM solutions (without <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> ). </p>
                                    <h3>Managing Scripts with Group Policy</h3>
                                    <p>Deploying scripts with Group Policy is not hard, but it does have some limitations. We'll go through the process below.</p>
                                    <p>There are Startup and Shutdown script settings, which are found under the Computer Configuration | Policies node in the Windows Settings | Scripts (Startup/Shutdown) branch. You can get your proposed script into the proper GPO in many ways; however, we propose the following as the ideal way:</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>In the Group Policy Management Editor, drill down to the Scripts (Startup/Shutdown) node and double-click "Startup." The Startup Properties dialog box will appear.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Click the Add button to open the "Add a Script" dialog box.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>In the Script Name field, you can enter a file name or click "Browse" to open the Browse dialog box, shown in Figure 1.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>To create a new file, right-click in the Browse dialog box, and choose New| Text Document, for example.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Enter a name for the file, such as myscript.bat.</p>
                                    <p>
                                        <img src="../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/About PolicyPak Scripts Triggers.png" />
                                    </p>
                                    <p>Figure 1. Adding a script.</p>
                                    <p>Next, it's important to understand that Startup and Shutdown scripts run in the LocalSystem context. If you want to connect to resources across the network, you'll need to ensure that those resources allow for computer access across the network (not just user access), because the script will run in the context of the computer account when it accesses network resources (such as the Domain Computers group).</p>
                                    <p>The Logon and Logoff script settings are under the User Configuration | Policies node in the Windows Settings | Scripts (Logon/Logoff) branch. Logon and logoff scripts run in the User context. Remember that a user is just a mere mortal and might not be able to manipulate Registry keys that you may run in a logon or logoff script.</p>
                                    <p>You can also run PowerShell-based scripts. You can find these settings in User Configuration | Policies | Windows Settings | Scripts (Logon/Logoff). Similar settings for the computer are found in Computer Configuration | Policies | Windows Settings | Scripts (Startup/Shutdown). The dialog can be seen in Figure 2.</p>
                                    <p>
                                        <img src="../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/About PolicyPak Scripts Triggers_1.png" />
                                    </p>
                                    <p>Figure 2. Using the in-box Group Policy method to deploy PowerShell scripts.</p>
                                    <p>These processes are perfectly fine, but do not suit every case. The primary problems with the in-box Group Policy method are:</p>
                                    <ul>
                                        <li>
                                            <p>Scripts can only run at Startup/Shutdown and Logon/Logoff and are only run once, despite the fact that there may be other times when you want a script to run.</p>
                                        </li>
                                        <li>
                                            <p>Scripts are "all or nothing"; that is, the script cannot determine whether or not it should apply based on certain conditions.</p>
                                        </li>
                                        <li>
                                            <p>To make a script run interactively, you must create a global setting (to the machine) within Group Policy by going to User Configuration | Policies | Administrative Templates | System | Scripts, and selecting either "Run logon scripts visible" or "Run logoff scripts visible." For Startup and Shutdown scripts you must go to Computer Configuration | Policies | Administrative Templates | System | Scripts, and select either "Run startup scripts visible" or "Run shutdown scripts visible." However, you cannot make a specific script run interactively. </p>
                                        </li>
                                        <li>
                                            <p>You cannot make a script that would apply to all users who log into the computer (without using loopback).</p>
                                        </li>
                                    </ul>
                                    <h3>Managing Scripts with an MDM service</h3>
                                    <p>On Microsoft Endpoint Manager, the ability to run PowerShell scripts is handled by the Intune Management extension. For more information on this extension see <a href="https://docs.microsoft.com/en-us/intune/intune-management-extension" target="_blank">https://docs.microsoft.com/en-us/intune/intune-management-extension</a>. Figure 3 shows the available options for adding a PowerShell script with Intune.</p>
                                    <p>
                                        <p>
                                            <img src="../../Resources/Images/Netwrix_Book 12 - Scripts Manager Component_manual/About PolicyPak Scripts Triggers_2.png" />
                                        </p>
                                        <p>Figure 3. Deploying a PowerShell script using Microsoft Endpoint Manager.</p>
                                    </p>
                                    <p>The MDM script deployment mechanism leaves a lot to be desired, however. The following are the typical problems with built-in MDM scripts that you may find when using Microsoft Endpoint Manager (Intune), VMware Workspace ONE (AirWatch), or MobileIron (although the problems might be different on any given MDM solution, since they are all very different).</p>
                                    <ul>
                                        <li>
                                            <p>Some MDM solutions do not enable you to run any scripts at all for any reason.</p>
                                        </li>
                                        <li>
                                            <p>For MobileIron customers, enabling scripting costs extra with their MobileIron Bridge add-on. </p>
                                        </li>
                                        <li>
                                            <p>Depending on the vendor, the scripts might be restricted to one specific type. For instance, on Microsoft Endpoint Manager the only script type that may be used is PowerShell. </p>
                                        </li>
                                        <li>
                                            <p>Typically, the scripts are applied and run only once (unless the script itself is updated).</p>
                                        </li>
                                        <li>
                                            <p>Scripts can only be targeted to computers, not to users.</p>
                                        </li>
                                        <li>
                                            <p>The scripts can be targeted to a group of computers, but have no way to determine if conditions are true on the machine or not. (All the logic for when a script will apply has to be baked into the script).</p>
                                        </li>
                                        <li>
                                            <p>Scripts can take up to an hour to run (that's the nature of MDM, anyway).</p>
                                        </li>
                                        <li>
                                            <p>There is no way to trigger the script to re-run manually for quick testing purposes. You need to manually update the script and wait for MDM to re-deploy it.</p>
                                        </li>
                                        <li>
                                            <p>The following restrictions apply on Intune: </p>
                                            <ul>
                                                <li>
                                                    <p>Scripts must be less than 10 KB (ASCII) or 5 KB (Unicode).</p>
                                                </li>
                                                <li>
                                                    <p>Scripts can only call the 32-bit version of PowerShell, so 64-bit PowerShell cmdlets cannot be used.</p>
                                                </li>
                                                <li>
                                                    <p>The scripts only run when a computer is associated with a user; so with kiosk devices, using the MDM scripting is often not possible.</p>
                                                </li>
                                                <li>
                                                    <p>The scripts will not run with hybrid scenarios (domain-joined and Azure registered devices.)</p>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
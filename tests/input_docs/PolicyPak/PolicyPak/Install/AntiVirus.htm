<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|All Things Installation &amp; Upkeep|[%=System.LinkedTitle%]|AntiVirus and other System Software">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>How must I configure my Anti-virus or system-level software to work with Endpoint Policy Manager CSE?</title>
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>How must I configure my Anti-virus or system-level software to work with Endpoint Policy Manager CSE?</h1>
                                    <p>With some  Antivirus and other security engines it is necessary to exclude some <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> items.</p>
                                    <p><span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> acts as part of the operating system, and, as such, can occasionally conflict with some Antivirus programs. (McAfee, Sophos, etc.)</p>
                                    <p>Additionally, you can tell <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> to avoid conflict with Antivirus and security engines if you know what processes are getting entangled. If you wish to do that, please see <a href="https://helpcenter.netwrix.com/bundle/PolicyPak/page/Content/PolicyPak/Video/GettingStarted/ADMX.htm" target="_blank" title="Endpoint Policy Manager: Exclude Processes via ADMX" alt="Endpoint Policy Manager: Exclude Processes via ADMX">PolicyPak: Exclude Processes via ADMX</a> for general how-to directions. </p>
                                    <p>We suggest proactively&#160;excluding the two processes below&#160;which could be blocked and prevented from performing their jobs.</p>
                                    <ul>
                                        <li><code>PPWatcherSvc*.exe</code> (with * being either the 32- or 64-bit version)</li>
                                        <li><code>PPExtensionService.exe</code> (with * being either the 32- or 64-bit version)</li>
                                    </ul>
                                    <p>You might need to also exclude these:</p>
                                    <ul>
                                        <li><code>%Programdata%\PolicyPak.</code>
                                        </li>
                                        <li><code>%localappdata%\PolicyPak</code>
                                        </li>
                                    </ul>
                                    <p>For 32-bit machines:</p>
                                    <ul>
                                        <li><code>C:\Program Files\PolicyPak</code>
                                        </li>
                                        <li><code>C:\ProgramData\PolicyPak</code>
                                        </li>
                                        <li><code>C:\Program Files (x86)\PolicyPak\Application Manager\Client\*\PPReapplyOnLaunch32.dll&#160;</code>
                                            <br />	(* should be replaced with your&#160;installed CSE version, i.e. 21.10.2943)</li>
                                        <li><code>C:\Program Files (x86)\PolicyPak\Application Manager\Client\*\PPAppMgrClient.dll&#160;</code>
                                            <br />	(* should be replaced with your&#160;installed CSE version, i.e. 21.10.2943)</li>
                                    </ul>
                                    <p>For 64-bit machines:</p>
                                    <ul>
                                        <li><code>C:\program files (x86)\PolicyPak</code>
                                        </li>
                                        <li><code>C:\Program Files\PolicyPak</code>
                                        </li>
                                        <li><code>C:\ProgramData\PolicyPak</code>
                                        </li>
                                        <li><code>C:\Program Files\PolicyPak\Application Manager\Client\*\PPReapplyOnLaunch64.dll</code>
                                            <br />	(* should be replaced with your&#160;installed CSE version, i.e. 21.10.2943)</li>
                                        <li><code>C:\Program Files\PolicyPak\Application Manager\Client\*\PPAppMgrClient.dll</code>
                                            <br />	(* should be replaced with your&#160;installed CSE version, i.e. 21.10.2943)</li>
                                        <li><code>C:\Program Files\PolicyPak\Device Manager\Client\*\PPDMClient.dll</code>
                                            <br />	(* should be replaced with your&#160;installed CSE version, i.e. 21.10.2943)</li>
                                    </ul>
                                    <p class="Caution" data-mc-autonum="&lt;span style=&quot;color: #da0000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;CAUTION: &lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Caution"><span style="color: #da0000;" class="mcFormatColor"><b>CAUTION: </b></span></span></span>The above location paths&#160;must be matched to your installed CSE version.</p>
                                    <p>To cover all the bases please also exclude PPWatchersvc64.exe and PPWatchersvc32.exe from the Exploit Mitigation feature.</p>
                                    <p>For SOPHOS users who receive: APCViolation exploit prevented in <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Watcher Service:</p>
                                    <ul>
                                        <li>
                                            <p>Check the Event details and then make an exception in the Exploit Protection setting</p>
                                        </li>
                                        <li>
                                            <p>The typical workaround is to add PPWatersvc64.exe as an exclusion to the Exploit Mitigation</p>
                                        </li>
                                    </ul>
                                    <h2>IVANTI Heat Customers</h2>
                                    <p>There are a couple of issues to keep in mind:</p>
                                    <p>First, please read <a href="https://forums.ivanti.com/s/article/Troubleshooting-application-conflicts-with-LES?language=en_US" target="_blank" title="Troubleshooting Application Conflicts" alt="Troubleshooting Application Conflicts">ivanti forms Troubleshooting Application Conflicts for additional information.</a></p>
                                    <p>The basic approach is to rename these files and then reboot to see if conflicts still occur.
</p>
                                    <ul>
                                        <li><code>C:\Windows\System32\sxwmon64.dll</code>
                                        </li>
                                        <li><code>32-bit: C:\Windows\System32\sxwmon32.dll</code>
                                        </li>
                                        <li><code>64-bit: C:\Windows\SysWow64\sxwmon32.dll</code>
                                            <br />		&#160;</li>
                                    </ul>
                                    <h2>FORTINET Customers</h2>
                                    <p>FortiNet / FortiClient version 6.0.8.0261 will not install the latest CSE and displays the following error message during installation:&#160;</p>
                                    <p style="text-align: center;">
                                        <img alt="" height="198" src="../../Resources/Images/Install/54_1_image.png" width="552" />
                                    </p>
                                    <p>Symptom: Error message when installing CSE: Could not write value <code>ExplorerCommandHandler</code> to key <code>\SOFTWARE\Classes\exefile\shell\runasspecial</code></p>
                                    <ul>
                                        <li>The workaround is to update FortiClient to version&#160;6.0.9.0277 or higher.</li>
                                    </ul>
                                    <h2>More Information / Micorosft A/V Products</h2>
                                    <p>For more details on Windows Defender exclusions in general, please see <a href="https://cloudbrothers.info/en/guide-to-defender-exclusions/" target="_blank" title="The Hitchhiker's Guide to Microsoft Defender for Endpoint exclusions" alt="The Hitchhiker's Guide to Microsoft Defender for Endpoint exclusions">The Hitchhiker's Guide to Microsoft Defender for Endpoint exclusions</a>.</p>
                                    <h2>CARBON BLACK Customers</h2>
                                    <p>
During the installation of the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> &#160;CSE, you may encounter the following error message: </p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/54_2_image-20230330120114-2.png" />
                                    </p>
                                    <p>
To work around this issue please add the following BYPASS policies for <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> as shown  below.&#160;</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/54_3_image-2.png" />
                                    </p>
                                    <h2>DEFENDER Customers</h2>
                                    <p>During installation or removal of the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> CSE you may run into this error:</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/DefenderError.png" />
                                    </p>
                                    <p>The Windows Application log will also show the following Error:</p>
                                    <p>Product: <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> Client-Side Extension -- Error 1721. There is a problem with this Windows Installer package. A program required for this install to complete could not be run.</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/DefenderErrorEvent.png" />
                                    </p>
                                    <p>To work around this issue you need to add the following folder exclusions under <b>Attack Surface Reduction</b> &gt;<b> Attack Surface Rules</b>:</p>
                                    <ul>
                                        <li>
                                            <p><code>C:\Program Files\PolicyPak\</code>
                                            </p>
                                        </li>
                                        <li>
                                            <p><code>C:\ProgramData\PolicyPak\</code>
                                            </p>
                                        </li>
                                    </ul>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/DefenderEditPolicy.png" />
                                    </p>
                                    <p>See the Cloudbrothers article  <a href="https://cloudbrothers.info/en/guide-to-defender-exclusions/" target="_blank" title="The Hitchhiker's Guide to Microsoft Defender for Endpoint exclusions" alt="The Hitchhiker's Guide to Microsoft Defender for Endpoint exclusions">The Hitchhiker's Guide to Microsoft Defender for Endpoint exclusions</a> for additional information on Windows Defender exclusions.</p>
                                    <h2>Netskope Customers</h2>
                                    <p>For Netskope customers, this workaround was provided by another customer and may or may not work in your circumstance.</p>
                                    <p>If when installing the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Cloud client, you get the experience below:</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/NetskopeAndCloud.png" />
                                    </p>
                                    <p>Follow the steps to resolve Netskope errors.</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Create a <code>certpinned</code> app bypass including the 3 processes<code> ppcloudsvc.exe</code>, <code>ppcloud.exe</code>, <code>rundll32.exe</code>. See Netskope's article <a href="https://docs.netskope.com/en/creating-a-custom-certificate-pinned-application/#:~:text=If you want to bypass,the Certificate Pinned Apps tab" target="_blank" title="Creating a Custom Certificate Pinned Application" alt="Creating a Custom Certificate Pinned Application">Creating a Custom Certificate Pinned Application</a> for additional information.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Create a local domain bypass for <code>cloud-agent.policypak.com</code>.</p>
                                    <p class="Bold_Subheading">Explanation of Root Cause</p>
                                    <p>Many installed applications use embedded certificates for TLS communication. Netskope grabs all https traffic for SSL decryption. This is not an issue when it comes to browsers because Netskope swaps the certificate to something else that machines trust.  However, with application certificates (cert pinned apps), Netskope is unable to make the switch since the cert is embedded in the application.</p>
                                    <p>These steps above provide a workaround for Netskope + <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Cloud installation issues.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
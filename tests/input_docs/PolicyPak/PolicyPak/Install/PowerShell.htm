<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" class="_Skins_Netwrix_Website" lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Introduction &amp; Quick Start Manuals|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Endpoint Policy Manager and PowerShell</title>
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Endpoint Policy Manager and PowerShell</h1>
                                    <p><span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> has a PowerShell module that can perform some key tasks. As of the writing of this manual, the PowerShell cmdlets can perform licensing steps and discover <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> items within a Group Policy Object (GPO). The <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> PowerShell module is located in the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Extras folder you downloaded.</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/PolicyPak and PowerShell_1200x787.png" class="img_34" style="width: 1200;height: 787;" />
                                    </p>
                                    <p>Run the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> PowerShell Tools installer. The <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> PowerShell modules will be installed to <code>&gt;c:\Program Files\PolicyPak1\Tools\Modules\PolicyPak</code>. </p>
                                    <p>At a Powershell prompt run the command <code>&gt;Import-Module PolicyPak.psd1.</code> If you add the <code>&gt;-verbose </code>command you will see all of the available cmdlets.</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/PolicyPak and PowerShell_1_1200x974.png" class="img_35" style="width: 1200;height: 974;" /> </p>
                                    <h2>Endpoint Policy Manager PowerShell and Licensing Endpoint Policy Manager </h2>
                                    <p>To import a module, you need to call <code>&gt;Import-Module <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> </code>in PowerShell. At the time of the publication of this manual, all <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> cmdlets are for a licensing component that requires the following commands:
        </p>
                                    <ul>
                                        <li>
                                            <p>Importing cmdlet '<code>Get-PPCses</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Get-PPGPOs</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Get-RegisteredCses</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Register-PPLicenses</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Test-PPLicense</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Disable-InactiveComputers</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Get-InactiveComputers</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Get-PPLicenses</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>Register-PPLicense</code>'</p>
                                        </li>
                                        <li>
                                            <p>Importing cmdlet '<code>New-PPLicenseRequestFile</code>'</p>
                                        </li>
                                    </ul>
                                    <p>To generate a new <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> license request, there are two methods. Method 1 requires using the existing Microsoft cmdlet Get-ADOrganizationalUnit as shown below.</p>
                                    <p><code>&gt;# New-PPLicenseRequest</code>
                                    </p>
                                    <p><code>&gt;Import-Module ActiveDirectory</code>
                                    </p>
                                    <p><code>&gt;Import-Module PolicyPak</code>
                                    </p>
                                    <p><code>&gt;$scope = Get-ADOrganizationalUnit -Filter {(name -eq "OU2") -or (name -like "Domain*") -or (name -like "Real*")} -Property * | FT DistinguishedName -A -HideTableHeaders | Out-String</code>
                                    </p>
                                    <p><code>&gt;$som = Get-ADOrganizationalUnit -Filter {(name -like "Real*") -or (name -like "Domain*")} -Property * | FT DistinguishedName -A -HideTableHeaders | Out-String</code>
                                    </p>
                                    <p><code>&gt;New-PPLicenseRequestfile "C:\Temp\request1.xml" -Scope $scope -Som $som -Verbose </code>
                                    </p>
                                    <p>The request output is shownbelow.</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/PolicyPak and PowerShell_2.png" />
                                    </p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>To understand scope versus SOM, see  <a href="../License/ActiveDirectory/Scope.htm" target="_parent" title="Why does LT ask &quot;Who am I&quot; and &quot;Where do I want to use Endpoint Policy Manager?&quot;" alt="Why does LT ask &quot;Who am I&quot; and &quot;Where do I want to use Endpoint Policy Manager?&quot;" class="MCXref xref">Why does License Tool ask Who am I and Where do I want to use Endpoint Policy Manager?</a>.
                </p>
                                    <p>Method 2 requires indicating specific organizational units (OUs), as shown below. In this example, the scope is the whole domain, but the SOM is the Sales OU within the Fabrikam.com domain. Below is an example script which requests a new license file from a specific SOM and scope.</p>
                                    <p><code>&gt;# New-PPLicenseRequest</code>
                                    </p>
                                    <p><code>&gt;Import-Module ActiveDirectory</code>
                                    </p>
                                    <p><code>&gt;Import-Module PolicyPak</code>
                                    </p>
                                    <p><code>&gt;$scope = "DC=Fabrikam, DC=com" </code>
                                    </p>
                                    <p><code>&gt;$som = "OU=Sales, DC=Fabrikam, DC=com"</code>
                                    </p>
                                    <p><code>&gt;New-PPLicenseRequestFile "E:\Downloads\adcomputer.text.new.xml" -scope $scope -som $som -Verbose</code>
                                    </p>
                                    <p><code>&gt;#---</code>
                                    </p>
                                    <p style="text-align: center;"> <img src="../../Resources/Images/Install/PolicyPak and PowerShell_3_1200x833.png" class="img_31" style="width: 1200;height: 833;" /></p>
                                    <p>The next cmdlet enables you to determine how many computers are not active.</p>
                                    <p><code>&gt;# Get-InactiveComputers</code>
                                    </p>
                                    <p><code>&gt;Import-Module PolicyPak</code>
                                    </p>
                                    <p><code>&gt;Get-InactiveComputers -LastLoginTime 90 -inu -Verbose</code>
                                    </p>
                                    <p><code>&gt;#---</code>
                                    </p>
                                    <p>The result from this cmdlet is shown below.</p>
                                    <p style="text-align: center;"> <img src="../../Resources/Images/Install/PolicyPak and PowerShell_4_950x333.png" class="img_37" style="width: 950;height: 333;" /></p>
                                    <p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>&gt;The next cmdlet disables inactive computers.&gt;# Disable-InactiveComputers<br />&gt;Import-Module PolicyPak<br />&gt;Disable-InactiveComputers -LastLoginTime 900 -Verbose<br />&gt;#---</code></pre>
                                            </div>
                                        </div>
                                    </p>
                                    <p>You can then see the machines are disabled:</p>
                                    <p style="text-align: center;"> <img src="../../Resources/Images/Install/PolicyPak and PowerShell_5_1200x561.png" class="img_38" style="width: 1200;height: 561;" /> </p>
                                    <p>When the next cmdlet is run, you can see if the license file you got from <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> was valid. Note that you might have to run the cmdlet on each <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> license file you get.</p>
                                    <p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>&gt;# Test-PPlicense&gt;Import-Module PolicyPak<br />&gt;Test-PPlicense&#160;<br />&gt;"C:\Users\server\Desktop\_licenses\license_1.xml" -verbose<br />&gt;Test-PPlicense&#160;<br />&gt;"C:\Users\server\Desktop\_licenses\license1.xml" -verbose<br />&gt;Test-PPlicense&#160;<br />&gt;"C:\Users\server\Desktop\_licenses\license2.xml" -verbose<br />&gt;Test-PPlicense&#160;<br />&gt;"C:\Users\server\Desktop\_licenses\FIRSTLicense-Request-Key.xml" -verbose<br />&gt;#---</code></pre>
                                            </div>
                                        </div>
                                    </p>
                                    <p>You can then see that the license is valid:</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/PolicyPak and PowerShell_6_950x148.png" class="img_39" style="width: 950;height: 148;" />
                                    </p>
                                    <p>When the next cmdlet is run, you can create a new GPO and link it to the scope.</p>
                                    <p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>&gt;# Register-PPlicense&gt;Import-Module PolicyPak<br />&gt;Register-PPlicense&#160;<br />&gt;"C:\Users\server\Desktop\_licenses\license1.xml" -e $True -verbose&#160;</code></pre>
                                            </div>
                                        </div>
                                    </p>
                                    <p>You can then see the successful installation:</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/PolicyPak and PowerShell_7_1200x328.png" class="img_40" style="width: 1200;height: 328;" />
                                    </p>
                                    <p>The next cmdlet will specify a GPO by GUID.</p>
                                    <p>
                                        <div class="codeSnippet">
                                            <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>&gt;#Register-PPlicense &gt;"C:\Users\server\Desktop\_licenses\license1.xml" -e $True -mgpo "96A61654-8363-444B-97AC-47D466FE12EE" -verbose&#160;<br />&gt;#---<br />&gt;# Get-PPlicenses<br />&gt;Import-Module PolicyPak<br />&gt;Get-PPlicenses -Verbose<br />&gt;#---</code></pre>
                                            </div>
                                        </div>
                                    </p>
                                    <p>The result is shown below. You can see the GPO name, scope, expiration date of the license, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> license version type, and validation status of the license.</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/PolicyPak and PowerShell_8_1200x803.png" class="img_41" style="width: 1200;height: 803;" />
                                    </p>
                                    <h2>Endpoint Policy Manager PowerShell and Discovery</h2>
                                    <p><span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> can help you discover which GPOs contain <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> directives. After you have performed the import of the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> module with Import-Module PolicyPak, you can use cmdlets like the following examples:</p>
                                    <ul>
                                        <li>
                                            <p><code>&gt;Get-PPCses</code>: shows <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> client-side extension (CSE) names and guids
                </p>
                                        </li>
                                        <li>
                                            <p><code>&gt;Get-PPGPOs -cse "Security"</code>: same as above, but searches for CSEs with "security" in the name (case insensitive)
                </p>
                                        </li>
                                        <li>
                                            <p><code>&gt;Get-RegisteredCses</code>: shows CSEs registered in the system
                </p>
                                        </li>
                                        <li>
                                            <p><code>&gt;Get-PPGPOs | Format-Table -wrap</code>: shows all GPOs with any <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> product as a table (You can see this in Figure 26 below.)</p>
                                        </li>
                                        <li>
                                            <p><code>&gt;Get-PPGPOs | Select -ExpandProperty "GPO"</code>:&#160; shows all GPOs with <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> products as names only
                </p>
                                        </li>
                                        <li>
                                            <p><code>&gt;Get-PPGPOs -cse "Security" | Select -ExpandProperty "GPO"</code>: shows all GPOs with any <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> products with "security" in the title
                </p>
                                        </li>
                                        <li>
                                            <p><code>&gt;Get-PPGPOs -cse "E0088A46-AB54-4FBD-A733-303C58244C5E"</code>: shows all GPOs based on CSE GUID
                </p>
                                        </li>
                                    </ul>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/Install/PolicyPak and PowerShell_9_850x594.png" alt="Text&#xA;&#xA;Description automatically generated" class="img_42" style="width: 850;height: 594;" />
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
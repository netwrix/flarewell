<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|All Things Licensing|[%=System.LinkedTitle%]|Licensing: Requesting Licenses: MDM">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>If I have both Azure joined and Hybrid Azure AD joined machines, how do I count the exact number of licenses I need?</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>If I have both Azure joined and Hybrid Azure AD joined machines, how do I count the exact number of licenses I need?</h1>
                                    <p>First of all, we here at <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> do not want to charge you twice. If a machine is joined to On-Prem AD and also joined to Azure AD (called Hybrid Azure AD joined), then you should only have to pay for the machine one time. Here is a Microsoft's diagram below (borrowed from <a href="https://docs.microsoft.com/en-us/azure/active-directory/devices/concept-azure-ad-join-hybrid">https://docs.microsoft.com/en-us/azure/active-directory/devices/concept-azure-ad-join-hybrid</a> ).</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_1_image-20200723102952-1.png" width="603" />
                                    </p>
                                    <p>In this case, if you had exactly one machine like this ,you would need to:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>Pay for one license (remember, you only need to pay once.) But…</li>
                                        <li>Engage  both PolicyPak licensing mechanisms for this computer: <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Group Policy and <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> MDM.</li>
                                    </ul>
                                    <p>We recommend you do not deliver the same <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> settings from both Group Policy or MDM. But you might want to enable the ability to get those licenses from both sources, then transition away from Group Policy to MDM over time.</p>
                                    <p>Knowing you will have some machines:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>Joined to on-prem AD &amp; GPO (but not in Azure)</li>
                                        <li>Joined to Azure AD (but not on-prem AD) and</li>
                                        <li>Hybrid Azure AD Joined (dual enrolled to both)</li>
                                    </ul>
                                    <p>How do you dial in exactly how many computers to license? We will go over this same math again at the end, but here is the gist. Let us pretend you had the following numbers (which we will explain more  below):</p>
                                    <ul style="margin-left: 20px;">
                                        <li>Part 1 (On-Prem AD &amp; GPO machines): 1000</li>
                                        <li>Part 2 (Azure AD joined only): 250</li>
                                        <li>Part 3 (Hybrid AD joined): 150</li>
                                    </ul>
                                    <p>To correctly pay for each computer one time you would pay for:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>Azure AD joined only: 250</li>
                                        <li>Hybrid AD joined: 150</li>
                                        <li>AD &amp; GPO machines : 1000</li>
                                        <li>SUBTRACT the number of Hybrid AD joined: MINUS 150</li>
                                    </ul>
                                    <p>Final number for purchase, where each machine is licensed once:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>250 +</li>
                                        <li>150 +</li>
                                        <li>1000 MINUS</li>
                                        <li>150</li>
                                    </ul>
                                    <p>Grand total: 1,250 computers</p>
                                    <p>There is no easy button for this, but it is a straightforward procedure.</p>
                                    <h2>Step 1: Counting your on-prem AD &amp; GPO machines</h2>
                                    <p>Typically, you do this with the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> on-prem licensing tool (preferred), or if you need to, you can use PowerShell.  See<a href="../Unlicense/Options.htm" target="_parent" title="My organization doesn't permit me to run the LT (Endpoint Policy Manager Licensing Tool) or provide the XML information it produces. What are my other options?" alt="My organization doesn't permit me to run the LT (Endpoint Policy Manager Licensing Tool) or provide the XML information it produces. What are my other options?" class="MCXref xref" xrefformat="{para}">My organization doesn't permit me to run the LT (Endpoint Policy Manager Licensing Tool) or provide the XML information it produces. What are my other options?</a></p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_3_image-20200723102952-2.png" />
                                    </p>
                                    <h3>Preparing for Steps 2 and 3: Before we count the Azure only, machines and before we count the Hybrid Azure AD joined machines</h3>
                                    <p>In Azure you can go to  Devices &gt; All Devices, then look at the Join Type. You should see four possible fields:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>Azure AD registered —This is not required for a<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> license, as this is not Azure or MDM enrolled.</li>
                                        <li>Azure AD joined — This means the machine is joined directly to Azure AD and is not Hybrid (that is, it is not also joined to on-prem AD).</li>
                                        <li>Hybrid Azure AD Joined — This means the machine is joined both to Azure AD and to on-prem AD.</li>
                                        <li>Blank: Unknown.</li>
                                    </ul>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_5_image-20200723102952-3.png" />
                                    </p>
                                    <p>The problem is that you cannot count each type with this interface unless you have just a few  machines. Instead you need to use Powershell and have it do the counting for you.</p>
                                    <h2>Next: Using PowerShell to connect to Azure AD</h2>
                                    <p>Start out by installing the Azure AD module. See the Microsoft article on <a href="https://learn.microsoft.com/en-us/powershell/azure/install-azure-powershell?view=azps-13.1.0&amp;viewFallbackFrom=azps-4.4.0" target="_blank" title="How to install Azure PowerShell" alt="How to install Azure PowerShell">How to install Azure PowerShell</a> for additional information.</p>
                                    <p>Here is a copy of the command:</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>if ($PSVersionTable.PSEdition -eq 'Desktop' -and (Get-Module<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;-Name AzureRM -ListAvailable)) {&#160;&#160;&#160;Write-Warning -Message<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;('Az module not installed. Having both the AzureRM and ' +<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;'Az modules installed at the same time is not supported.')}<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;else {&#160;&#160;&#160;Install-Module -Name Az -AllowClobber -Scope CurrentUser}</code></pre>
                                        </div>
                                    </div>
                                    <p>Here is the result.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_7_image-20200723102952-4.png" />
                                    </p>
                                    <p>Start out with the Connect-AZAccount cmdlet (not shown). You will get prompted for credentials the first time.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_9_image-20200724004807-5.png" />
                                    </p>
                                    <p>The command should finish and return you with a result like this:</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_11_image-20200724004807-6.png" width="879" />
                                    </p>
                                    <p>Then use the connect-azuread command and provide credentials again, for a second time.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_13_image-20200723102952-5.png" width="907" />
                                    </p>
                                    <p>Results of connection are then seen here:</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_15_image-20200723102952-6.png" width="903" />
                                    </p>
                                    <p>You can then list all Windows 10 devices with the following command:</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>Get-AzureADDevice -all $true | select displayname, DeviceOSType, DeviceTrustType</code></pre>
                                        </div>
                                    </div>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_17_image-20200723102952-7.png" width="884" />
                                    </p>
                                    <h2>Step 2: Count your Joined to Azure AD only (but not on-prem domain joined machines)</h2>
                                    <p>To count Azure AD joined machines, run the first command:</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>Get-AzureADDevice -All $true | Where-Object {$_.DeviceTrustType -eq "AzureAd"} | measure&#160;</code></pre>
                                        </div>
                                    </div>
                                    <h2>Step 3: Count Hybrid Azure AD joined machines (those joined to on-prem AD and also Azure AD)&#160;</h2>
                                    <p>To count your Hybrid Azure AD joined machines, run this command.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PlainText;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>Get-AzureADDevice -All $true | Where-Object {$_.DeviceTrustType -eq "ServerAd"} | measure</code></pre>
                                        </div>
                                    </div>
                                    <h1>Results of your counting:</h1>
                                    <p>Results examples are seen here:</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/License/MDM/200_19_image-20200723102952-8.png" />
                                    </p>
                                    <h2>A final example with Math</h2>
                                    <p>Let's pretend you got the following numbers:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>Part 1 (On-Prem AD &amp; GPO machines): 1000</li>
                                        <li>Part 2 (Azure AD joined only): 250</li>
                                        <li>Part 3 (Hybrid AD joined): 150</li>
                                    </ul>
                                    <p>To correctly pay for each computer one time you would pay for:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>Azure AD joined only: 250</li>
                                        <li>Hybrid AD joined: 150</li>
                                        <li>AD &amp; GPO machines : 1000</li>
                                        <li>SUBTRACT the number of Hybrid AD joined: MINUS 150</li>
                                    </ul>
                                    <p>Final number for purchase,  where each machine is licensed once:</p>
                                    <ul style="margin-left: 20px;">
                                        <li>250 +</li>
                                        <li>150 +</li>
                                        <li>1000 MINUS</li>
                                        <li>150</li>
                                    </ul>
                                    <p>Grand total: 1,250 computers</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Least Privilege Manager|[%=System.LinkedTitle%]|How-To &amp; Tech Support">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Elevate (or smack down) scripts and Java JAR files</title>
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Elevate (or smack down) scripts and Java JAR files</h1>
                                    <p>If you want to prevent WannaCry and other malware, it's pretty easy. Just prevent users from running all scripts using <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span>. But then how do you PERMIT other scripts and also ELEVATE yet other scripts? In this video you'll find out in no time.</p>
                                    <p><iframe width="1700" height="956" src="https://www.youtube.com/embed/dL7RKd6RvQo" title="Endpoint Policy Manager: Elevate scripts and Java JAR files" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="1"></iframe>
                                    </p>
                                    <div id="tr1">
                                        <h3 id="transcript" style="text-align: center;">PolicyPak: Elevate scripts and Java JAR files</h3>
                                        <p>Hi. This is Jeremy Moskowitz. In this video, I'm going to show you how you can manage the heck out of your scripts, PowerShell and Java using PolicyPak and <a href="https://www.policypak.com/products/policypak-least-privilege-manager.html" target="_blank" title="Least Privilege Manager">https://www.policypak.com/products/policypak-least-privilege-manager.html</a>.</p>
                                        <p>Here's the example. Let's pretend you are the IT administrator here and you've deployed a couple of scripts that you want, but these scripts are a little special. When you double click them as a standard user, you can see "This file is clean from the IT department."</p>
                                        <p>But when they try to run the stuff inside, they can't manage stuff in HKEY_LOCAL_MACHINE. They're a standard user, so access is denied. They're not allowed to do these things. It doesn't work. You can see "Access is denied," "Access is denied," "Access is denied." Same thing with the command batch files that are trying to do things like start and stop services. A standard user can't do that.</p>
                                        <p>Well, what if they could? What if you could have the ability to elevate scripts that you want from a certain location? Let's go ahead and do that right now. We're going to do some other demos too, but let's just go ahead and get started here.</p>
                                        <p>For all of our "East Sales Users," we'll do "PPLPM Scripts and Java demo." (PPLPM is PolicyPak Least Privilege Manager.) I'm doing this on the user side for my "East Sales Users." I could also do this for my computers as well. I just happened to do this on the user side here.</p>
                                        <p>I'll dive down under user side, "PolicyPak" and pick "Least Privilege Manager." The very first thing I want to do is "Add" what's called a "New Script Policy." A script policy enables you to pick how the rules are such that this script will run elevated. I'm going to "Use simple rule." I'm just going to say where it's located. That's called the "Path." In other words, if I have the script on my server, there's no way the bad guy or a standard user could get it there, so it must be cool to run.</p>
                                        <p>So I'm going to say that these two scripts are going to be okay. Let me "Browse" for that location. That's going to be "<code>\dc2016share</code>." Then since I'm coming in over the network, I can go to "ITScripts." The batch file first, I'll pick this guy first. We're going to pick another one second, which was the command line. "Browse," and we'll take the command line.</p>
                                        <p>You can see both of these files are coming through the server and the share. If they're going to run, we want those to "Run with elevated privileges." We're going to give it a "Name" called "Let IT scripts run elevated," just these particular ones. There we go. Let's just do this one first, and we'll do some other things.</p>
                                        <p>We'll go to "Command Prompt" here, we'll run GP Update ("<code>gpupdate</code>"). We'll give this a second to bake in. Okay, now that that's done, ten seconds ago the script didn't run because it needed admin rights to work but now we've elevated this location. Let's see what happens. "Let's try to modify an HKLM key." "The operation completed successfully." Then if we want to unset the key, we can do that successfully as well.</p>
                                        <p>These operations that we would be using inside HKEY_LOCAL_MACHINE work now because this script is elevated. Let's see if we can start and stop services from this second script as well. Yes, sure enough. We're able to stop a particular service and start a particular service, and it works just the way we expect.</p>
                                        <p>I know what you're thinking. What if a user were to take this file and copy it to someplace like the desktop? Does it work here? Well, the script itself runs, but does it actually perform the work? The answer is no. "Access is denied" because, again, we're saying that the location, the path, must be dictated from the server. So that's the first thing.</p>
                                        <p>But you know what? I bet you're thinking about, what if we don't want users to be able to run scripts at all? Let's take a look at the kinds of scripts that a user could download. We're going to pretend that the user has downloaded all of these scripts off the Internet, all sorts of bad things. Some things might be good like that script we just tried. It doesn't do anything if they put it to that location. It doesn't perform the work.</p>
                                        <p>But what if that script were "Malware" or crypto malware? Or you take a "Java" commandlet that could be "Malware" as well, like this, that "Could have been malware." That's right. Or we take a Java script, that "Could have been malware." We could click on this. That's malware.</p>
                                        <p>PowerShell if you try to run it, when you just open it, it won't do anything directly. But if you try to actually right click and "Run with PowerShell" – again this is a standard user, I'm just a standard user – this is exactly what happens. They get prompted here. They can just say "Yes" or "Yes to All," and it "Could have been malware."</p>
                                        <p>In all these examples, these are just things that the user could have downloaded off the Internet and been totally naughty, and you would have been encrypted and WannaCry and all that stuff. You want to get out of that business. How are we going to do that? We're going to use what's called PolicyPak's SecureRun feature. You might have seen this in other videos where we showed how you can prevent executables, but now PolicyPak has the ability to also block most script types.</p>
                                        <p>We're just going to lay down the new "SecureRun Policy." SecureRun says if the person who is trying to run it is not on this list, then they can't run it at all. They're not going to be an "Administrator." They're not going to be the "SYSTEM." They're not going to be "TrustedInstaller." Because of that, as soon as we make that rule and put that down, we're smacking down all unknown, unsanctioned and unusual stuff that you have not said is good to go.</p>
                                        <p>Now that that's all done, let's go ahead and close that out. The scripts that we said are coming in over the network that we sanctioned are cool. In fact, they run with elevated rights. That's all cool and all works.</p>
                                        <p>But what happens if we try to take any given script? You saw before, I did the demo where I took this file, copied it to the desktop and the script ran. It didn't do anything, but let's see if it actually even runs at all. Now we're getting it blocked very specifically. ("This app has been blocked by your system administrator.")</p>
                                        <p>What about all these other things that they downloaded themselves? What about this "Malware" "BAT" file? Blocked. What about the command "Malware"? Blocked. What about the "JAVA-Malware"? Blocked. What about the "JS-Malware"? Blocked. What about the PowerShell "Malware"? What if we right click and "Run with PowerShell"? Blocked. Everything is blocked. All these script types are blocked automatically.</p>
                                        <p>Now you're thinking, okay, that's pretty cool. But what if I have specific things that I do want to sanction? Well, you saw me do that earlier, and that thing still runs. So the things that we send over the network will run. But maybe you have scripts that you don't want to run with admin rights. For instance, I have these scripts here that are digitally "Signed." What you can do is open the doggy doors for cleanly digitally signed things.</p>
                                        <p>Let me go over here. I'm going to "Add" a "New Script Policy" here. I'm going to say if it's signed by the IT department, then it must be good because those are good. I'll go ahead and take the "Signature," and I'm going to "Select script file" from my IT department here. I've got it in "ITScripts/Signed." It doesn't really matter. I'll pick any of them. They're all signed by my IT department all exactly the same way.</p>
                                        <p>If it's signed by my IT department, I don't need to elevate all that stuff. I just need to let it run standard. I'm just going to "Allow and log" it. I'll go ahead and click "Next" and say "Let scripts signed by my IT dept run" and click "Finish."</p>
                                        <p>Now let's give it a go. Let me go ahead and run GP Update ("<code>gpupdate</code>") again. This is all done. I'll close this out. Now these "Scripts" that are not signed are going to be blocked. We saw that before. But the ones that are signed, something magical happens and now if I were to right click on this PowerShell one that's signed and tried to "Run with PowerShell," what do we get? We still get prompted. We'll click "a" here, and "This file is clean from the IT department."</p>
                                        <p>But that other script, that script that we don't know what it is, if you try to right click that PowerShell script and try to "Run with PowerShell," it is blocked. Only the stuff that now is "Signed" is good to go. If you click on the "JS" file, "This file is clean from the IT department" and so on.</p>
                                        <p>But we still have a little problem with Java that we need to fix here. If we have Java that's "Malware" or if it's "Not Malware," the thing is it's great that it will block stuff that's malware but it also blocks stuff that's not malware. Even if it's "Signed" here, it's still being blocked because we need a special rule just for Java.</p>
                                        <p>Let's go ahead and fix that. In order to do that, we're going to "Add" a "New Java (JAR) Policy" here. We're going to say once again if it's digitally signed by us ("Signature") in "ITScripts" in "Signed," I want to take that same signature. I could have copied and pasted it, but I didn't.</p>
                                        <p>I can click "Next" here. I just want to "Allow and log" it. I'll go ahead and now say "Let Signed JAVA run from my IT dept." I'll click "Finish" and there we go.It's time to run GP Update ("<code>gpupdate</code>") one last time. Now that that's finished, I'll close this out. It opens up correctly because it's signed from the IT department.</p>
                                        <p>That's it. If you want to elevate scripts or smack them all down because they're not from you – so all the stuff that would have come through email and people sharing files, all that stuff – you could have the sanctioned applications run, the sanctioned scripts run but smack down everything else because they're not coming from you, the IT department. That's PolicyPak Least Privilege Manager with SecureRun.</p>
                                        <p>Just sign up for the webinar and once the webinar is over, we'll hand over the bits and you can try it out yourself.</p>
                                        <p>Thanks so very much, and we'll talk to you soon.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Least Privilege Manager|[%=System.LinkedTitle%]|Eventing">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Events</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Events</h1>
                                    <p>Learn about the Eventing System in PolicyPak Least Privilege Manger.</p>
                                    <p><iframe width="1477" height="831" src="https://www.youtube.com/embed/v2t3B5rBK6Y" title="Least Privilege Manager: Events" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="1"></iframe>
                                    </p>
                                    <h3>Transcript:&#160; Least Privilege Manager: Events</h3>
                                    <p>Hi. This is Jeremy Moskowitz. In this video, I'm going to give you a quick tour of the event system around PolicyPak Least Privilege Manager, some of the most common events that people would like to see.</p>
                                    <p>To get started, I actually have a few rules in place that will do some automatic and also on-demand elevation. The first one is "PowerPointViewer." You can see it's going to automatically "Elevate" that. The second one is going to do Process Monitor but only "Elevate (On Demand)." In between there, I'm going to show you what happens if a user tries to do a challenge and response code.</p>
                                    <p>We'll start off with "PowerPointViewer" here. Again, we have a rule in place, so it just sails on through. I'll go ahead and click "Continue" and just show you that, in fact, it will run even though it would normally require admin rights to install.</p>
                                    <p>Once this is all done, let me go ahead and show you the Event Viewer here and give you a quick tour about the event that occurred when that happened. If I go to "Event Viewer," you can do this as an admin or a standard user. You can go to "Applications and Services Logs." Give this a second to populate. Head down to "PolicyPak" and what you're looking for is "PolicyPak Least Privilege Manager Client - Operational" "Source." That's interesting in case you decide you want to do a custom view and show just those guys.</p>
                                    <p>Here in the "Source" you can see on "eastsalesuser1" "PowerPointViewer" tried to run. There's the "Command Line." You can see it was "Elevated with HASH rule." That's the name of the policy. You can see the GPO, and you can see the "Collection" that it's in which is the root. That's all the information you get, which is pretty great out of that elevation. You can see it has a particular "Event ID."</p>
                                    <p>Let's move on to a challenge and response. If I click on "Silverlight install" that doesn't have a rule, you see I get the "PolicyPak Admin Approval" dialog box. If the user tries to call you and you're not there, they have to click cancel. Let's see what kind of event they get when that happens.</p>
                                    <p>If we were to refresh this, we can see "Dialog canceled." Therefore, that was an application that was attempted to run. That was the "Silverlight install" that tried to run. You can see it was an "ApplicationInstaller" type. You can see the user, and you can see that it's "Signed." So there's a bunch of information that's contained here, and that's a particular "Event ID" as well so you can get right in there.</p>
                                    <p>Now let's continue down the road here. Let's pretend that you are at your desk. They click on "Silverlight install." They call you up or the help desk or whatever. They give you the "Request Code." I'm going to use the "Admin Approval Tool" which you've probably seen in other videos. I'll type it in here, and I want to run this "Once."</p>
                                    <p>I can pick a "Reason" code. Let's say it's "Application: Installation For User." This will come up in just a second. I'll use this "Once" and it "Expires" "Never." So there's the "Response Code." When I go ahead and click "OK" as the user, you can see "Silverlight" now goes ahead and does its installation here. Go ahead and give this a second to finish up, and we're done.</p>
                                    <p>Let's go ahead and see that event in the event system. If I refresh here, you can see "Dialog Success." This is "Event 613" which is different than the one that we saw earlier. Now we can see that "Command Line" succeeded. It's an "ApplicationInstaller," and you can see that again it's "Signed."</p>
                                    <p>"Code Uses: 1/1." Again, if you made it such that this was a reoccurring code, that would show up here. You could have it one time, five times, ten times, and never expires and so on. Those things are all listed here, so you can see how many "Code Uses" there are. And also "Apply to Child Processes" as well which is an important privilege to hand out or to restrict.</p>
                                    <p>That's the second thing I wanted to show. The last thing I wanted to show is this idea of self-elevation. Going back to the Process Monitor rule here, I have a special condition in place that would let an advanced user "Apply on demand" or do what's called self-elevation.</p>
                                    <p>This is handy for developers or advanced users who when they click on something maybe you want it to run standard, but you know that you can teach these special users how to right click and "Run with PolicyPak." So this is a special apply on demand rule and when you do that the application runs correctly.</p>
                                    <p>And you probably want this to be logged, so let's go ahead and see what that logging looks like. We'll go back to Event Viewer here. We'll go ahead and refresh this, and here we go. "The following process has been allowed. Run with elevated token." That's "Procmon." This is "Event 605." You can see that was run just the way you would expect here. All the same information you saw earlier, so that gives you the ability to know when a user has done a self-elevation rule.</p>
                                    <p>That's it for right now. We actually have all the event IDs hanging out in the manual ready for you to explore. If you are interested, there are other videos on how to take these, round these event logs up, send them to a collection server or a collection system and then if you wanted to also use something like Splunk to paw through them and get pretty charts and graphs and so on. But for now, this is a very quick tour to help you get on your way. Hope this gets you on the right path.</p>
                                    <p>Thank you very much, and talk to you soon.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
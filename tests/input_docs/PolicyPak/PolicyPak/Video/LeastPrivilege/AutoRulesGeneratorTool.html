<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Least Privilege Manager|[%=System.LinkedTitle%]|Basics and Getting Started">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Auto Rules Generator Tool (with SecureRun)</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Auto Rules Generator Tool (with SecureRun)</h1>
                                    <p>Once PPLPM and SecureRun are on, users are blocked from running unwanted stuff. But how can you create some rules automatically to ALLOW or ELEVATE applications and installations? Check out this free tool from <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> !</p>
                                    <p><iframe width="1642" height="924" src="https://www.youtube.com/embed/Jju3eIdqq08" title="PPLPM: Auto Rules Generator Utility" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="1"></iframe>
                                    </p>
                                    <h3>PPLPM: Auto Rules Generator Utility</h3>
                                    <p>Hi. This is Jeremy Moskowitz. In this video, I'm going to show you how you can automatically and quickly generate rules for<a href="https://www.policypak.com/products/policypak-least-privilege-manager.html" target="_blank" title="Least Privilege Manager">https://www.policypak.com/products/policypak-least-privilege-manager.html</a> using our Automatic Rule Generator utility.You're going to find this utility in your download here in the "PolicyPak Extras" folder. I'm going to go into that in just a minute, but here it is: "PolicyPak LPM Auto Rule Generator Tool."</p>
                                    <p>Let's set the stage. The stage is that you've got a Group Policy setting with "Least Privilege Manager" and our "SecureRun policy," just to set the stage here. We already have videos on the "SecureRun Policy," but when "SecureRun" is turned on, what happens? Only applications that are owned by these people, "Administrator" or "TrustedInstaller" or "SYSTEM," are going to run. If they're not installed by the admin, then they're not going to run.</p>
                                    <p>Let's see that as an example. Can we run "Adobe Reader"? Yes, we can because that was installed by the admin or SCCM or SYSTEM or something like that. What about applications that are downloaded by the end user like "NotepadP"? That's going to be blocked by SecureRun. Or "CamPlay"? That's going to be blocked by SecureRun. Or trying to install an application?</p>
                                    <p>Anything is going to be blocked because the owner on the file, if we take a look at "WinZip" here, the owner, "Security" and if we take a look at "Advanced" and we look, the "Owner" is "SYSTEM" here. When users download crap off the Internet, they are the owner. If we look at "Security," "Advanced" here, the user is the "Owner."</p>
                                    <p>Now that's the problem. The problem is as soon as you turn SecureRun on, a lot of things are going to stop working by design. You don't want users to be able to run these things, run "Scripts" and all that other stuff. So like I said, a bunch of things aren't going to run.</p>
                                    <p>What we've created is this thing called the Automatic Rule Generator Tool. In fact, let me turn off SecureRun for now just because I need to be able to run the tool here. Let me go ahead and run GP Update ("<code>gpupdate</code>") to just turn it off for a second here.</p>
                                    <p>Okay, so now SecureRun is off and all sorts of things that were prevented are now going to start running. "CamPlay" and "NotepadP" and users will get prompted for Process Manager ("Procmon") and all sorts of things. They can't run it because they're not a local admin.</p>
                                    <p>Let's talk about what the tool does. The tool is going to help you make discoveries. You would often use this tool for touching your gold image. For instance, we're going to pretend that this machine that we're on is a gold imagine. I have a bunch of stuff on the desktop just to make it easy for an example, but you'll see that the Automatic Rule Generator Tool lets you do stuff anywhere.</p>
                                    <p>Here's the "<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> LPM Auto Rule Generator Tool." I'll go ahead and run it. Again, I'm running it as the user. Today, as I make this video, this tool only lets you "Make Rules from Local Computer." At some point in the future, we're going to be able to "Make Rules from Remote Computer" and also based on "Event Logs" that happen from either one or multiple machines. But as it sits right now, this tool works with one computer and lets you create the rules.</p>
                                    <p>By way of example, you can select all sorts of "Locations" where applications are stored. I'm not going to do that just for the sake of expediency. I'm going to pick a particular location ("Other Locations") like the "Desktop." Because you saw that on my Desktop I had a bunch of stuff that I had to make some decisions about. Do I want to allow it? Do I want to run it? Do I want to keep it blocked? And so on.</p>
                                    <p>Here are the things that SecureRun will prevent. I'll go for everything: executables ("EXE"), "MSI," "SCRIPT" and "JAVA Applet." We're working on "UWP/METRO" style apps "Coming soon." Let's go ahead and "Expand All." This is everything that's on the Desktop. This is everything that's on the Desktop that qualifies as something that <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> can elevate, block or enable.</p>
                                    <p>I'm going to say "Check All," let's do everything here. Not that we're going to make a rule for everything, but let's evaluate everything here. If there's something that we didn't want to evaluate, we don't have to check the checkbox. I'll go ahead and click "Next" here.</p>
                                    <p>This is what we call the "SecureRun Simulator." I want to "Enable" the SecureRun Simulator and take the defaults. Or if you've added members like your SCCM service or some other third-party thing that deploys software, you'd want to "Add member" because that's going to evaluate what's going on in the machine right now.</p>
                                    <p>Now on this machine, of all the files that we said, these are the things that are going to be marked "Automatic Block" or "Automatic Allow." Actually, let's look at that first line second. But then look at all these other things that are automatically blocked. In fact, we just saw that. We saw that "CamPlay" was blocked when SecureRun was on. We saw "NotepadP" was blocked when SecureRun was on. I tried to run Process Monitor ("<code>Procmon</code>") and it was automatically blocked because SecureRun is going to block absolutely everything.</p>
                                    <p>But let's make some decisions. We know that Process Monitor ("<code>Procmon</code>"), we want to actually "Elevate" that. "CamPlay," that's a cool application, but we don't need to elevate it. We just want to simply "Allow" it.</p>
                                    <p>Then wait a second. Look at this special one over here. This one says "CamPlay-Admin-Owned." That's the name of it. I made it that on purpose. You can see I have "CamPlay" and "CamPlay-Admin-Owned." Let's look at that on the Desktop. Let's see the difference. Here's "CamPlay" and we have one called "CamPlay-Admin-Owned." What's the difference here?</p>
                                    <p>If we look at "Security" of CamPlay, you can see that "EastSalesUser1" copied that file down onto the Desktop. If we look at "CamPlay-Admin-Owned" and look at "Security" here, it shows that the "Administrators" group is the owner of that file. Let's go ahead and take a look back at the Automatic Rule Generator Tool. It's going to be automatically allowed because that person is inside a group that's on the "Allow" list.</p>
                                    <p>So if you want to, you can leave it as "Automatic Allow," or you can change it to "Elevate" (I can't imagine why you would want to) or "Block." You can say that file shouldn't be there. Even though it's admin copied, I want to block it. I'm going to leave it as "Automatic Allow" just to do something.</p>
                                    <p>Then you could if you want to put a double smackdown on something. Sure, things will be marked "Automatic Block," but if you want to, you could put an explicit "Block" rule if you want to as well. There's no real need if you're automatically blocking it with SecureRun, but it does give you an option.</p>
                                    <p>So you have "Automatic Allow." You can "Allow," which is simply let it run even though the hard candy shell is on with SecureRun. You can "Elevate" if you know that there's something that you want to do. In fact, you can elevate lots of things. For instance, let's do an executable and "SkypeSetup." We'll go ahead and automatically "Elevate" the "SkypeSetup" routine, and we'll specifically "Block" "Zoomit" as well. So that will just make a couple of these changes here.</p>
                                    <p>So of the "28" things that we found, we're going to leave one thing "Automatically Allowed," "23" things will be "Automatically Blocked," "2" things we're going "to make ELEVATE rules," "1" "ALLOW rule" and "1" "BLOCK rule." So we tell you what we're going to do in advance.</p>
                                    <p>The next question is, how do you want to do this? We recommend you keep the defaults, which are "Create signature rules for files that are digitally signed" and then secondarily as a second factor – this is called a combo rule – you want to "Match specific programs by file's information or path" and "if a file is not signed, create the following types of rule," a "File hash" rule. You could also just go right to "Path" rules or you can "Create file hash rules for all files." We recommend you just leave the defaults here.</p>
                                    <p>Go ahead and click "Next" and these are the rules that are going to show up in Group Policy land, or you can export these if you want to for use with <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Cloud. Here are the rules. We're saying "Allow" "CamPlay" based on "Hash." Why did it pick hash? Because it's not digitally signed, so we had to fall back to hash.</p>
                                    <p>For ProcessMonitor ("Procmon"), it picked "Signature + FileInfo," so we're going to get as specific as possible there. And then same thing for "Skype" as an MSI, use "Signature + FileInfo." For "Zoomit," we "Block" it with "Signature + FileInfo."</p>
                                    <p>Let's go ahead and click "Next." We need to actually say we want to "Check All." We've got all four checkboxes checked, and we're ready to actually do something useful. P.S., by the way, there are some extra little fly-out options here. You an "Open Location." You can "Open as XML rule in Notepad." If you just want to see what's our thinking here, what are we're going to do, you can just look inside and see right there what the rule is going to be.</p>
                                    <p>You can click "Next," and these are the rules that we're going to generate. We've selected all "4" things, and we want to make "2" "Elevate" rules, "1" "Block" rule and "1" "Allow" rule. Because we had the SecureRun simulator on, let's go ahead and also "Export SecureRun Rule" and turn on SecureRun in the Group Policy Object of our choosing.</p>
                                    <p>You could if you want to "Export as XML file for later import" for use in <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Cloud or your own MDM service, or you can go right here and select "Copy rules to PPLPM collection an existing GPO" and select a "GPO to update."</p>
                                    <p>Now remember, we're running this tool as a standard user. So you're thinking, how can a standard user update a particular Group Policy Object? No problem. Let's go ahead and "Select GPO." Let's find the GPO we were working on earlier which is "PPLPM with SecureRun demo." This is the GPO you saw me create earlier. Click "Next," but we're not going to have edit rights.</p>
                                    <p>We can do this on the user or computer side. I'm going to continue doing it on the user side, but you can do user or computer. You could also "Add Collection" if you wanted to that says when the machine is a human resources person or a developer or IT pro. You can make any sort of arrangements here. I'm not going to do that here, but it's an option if you're so inclined. We'll just go ahead and create the rules right at the root there and click "Next."</p>
                                    <p>We're going to try to make these rules inside the GPO as a standard user, but what's going to happen? "You do not have permission to perform this operation." You click "OK," and you can get prompted for the correct person who can create GPO rights. That might be this guy. We are able to manipulate the GPO now because you provided the right credentials here.</p>
                                    <p>Now we can "Edit GPO" provided this machine has the RSAT utilities. Actually, let's go on the safe side here. Let's go ahead and close that GPO we had open earlier so there's no conflict or anything. Let's go ahead and "Edit GPO" here first. Let's go ahead and click "OK." Let's give it the correct rights to edit the GPO. You have to have the RSAT utilities in order to do this.</p>
                                    <p>Now if we go to user side, "PolicyPak/Least Privilege Manager," we'll see all the rules we just created automatically generated. You can click on any of them to see what it looks like. This is the internal view of it. You can see we have the "Signature" and also the "Product version" information. That's what we're matching on there. I'll go ahead and close that out.</p>
                                    <p>Let's go ahead and close this GPO here, and let's just see it. Let's right click over the GPO here in our other admin console. Let's go ahead and "Refresh." We'll see that the report is all there. Let's just make sure the GPO is all there. Still here. Same exact idea, user side, "PolicyPak." It's the same GPO but just looking at it from a different computer here. Yes, all the rules are there.</p>
                                    <p>Now we're ready to try it, so let's go ahead and close this out. The rules are in place, so now we can close this out and we can run GP Update ("<code>gpupdate</code>"). Let's see what happens now that we've applied the rules. We said we wanted to do a handful of things. Let's see if those handful of things will, in fact, work as we expect. Done.</p>
                                    <p>Let's go ahead and review. We said all of our standard apps are still going to run. We didn't make any rules about that, so nothing is going to change there. Let's start off. "NotepadP," we've got SecureRun on. What's going to happen? Blocked, that's what we expect.</p>
                                    <p>"Procmon," we said run elevated, and Procmon runs elevated. We said "CamPlay.exe" to just allow because we don't need to run that elevated, just allow. That runs fine too. If we take a look at "SkypeSetup," "SkypeSetup" will now run elevated also because we made an elevate rule.</p>
                                    <p>SecureRun is on doing its thing, blocking everything that we don't have any explicit rules for. That's its job. If the application is owned by the user, it's not going to run. But if we do have a rule like in this case for Skype, we're going to elevate it.</p>
                                    <p>Oh, there was one more thing. Remember, we have two versions of CamPlay. We have "CamPlay-Admin-Owned." Just to prove a point, that's going to run even though there's no rule because that puppy is owned by the admin. That was allow stuff because the admin put it there. That's going to run. It's basically the same thing as these applications. These applications are also going to run just fine because they're placed there by the admin, so there's really just an implicit allow rule on those.</p>
                                    <p>That's about it for Least Privilege Manager Automatic Rule Generator Tool. There are some advanced scenarios, but I figure that gets you off to the races and started. That's it. I'm done with Skype. I can close that out, and I can close this video out too.</p>
                                    <p>Remember, this is a free tool available as part of the download. When you get the ISO, it's just included inside the download in the "PolicyPak Extras" folder. There you go. I hope this helps you out. Looking forward to seeing you on board real soon.<br />Bye.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
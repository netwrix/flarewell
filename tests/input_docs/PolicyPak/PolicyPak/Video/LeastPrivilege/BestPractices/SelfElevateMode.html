<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Least Privilege Manager|[%=System.LinkedTitle%]|Best Practices">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Endpoint Policy Manager Least Priv Manager: Self Elevate Mode</title>
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Endpoint Policy Manager Least Priv Manager: Self Elevate Mode</h1>
                                    <p>Use PPLPM Self Elevate mode to overcome UAC prompts without requiring specific rules. This is useful if you want to take away local admin rights, but still give users the ability to "break the glass" if they have an emergency. This technique isn't generally recommended due to a potential lowering of your security posture, but it can be very useful for the right circumstances.</p>
                                    <p><iframe width="1700" height="956" src="https://www.youtube.com/embed/6MtBFMLyrTE" title="Endpoint Policy Manager Least Priv Manager: Self Elevate Mode" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="1"></iframe>
                                    </p>
                                    <p>Hi, this is Jeremy Moskowitz, and in this video we're going to talk about how to use PolicyPak Least Privilege Manager Self-Elevate Mode. Now before I get too far into it, I want to advise against using this feature. That's right; this is a feature that we built, but I hope you don't have to use it. Well, let's talk about why you would have to use it, though. You might have an application that throws a UAC prompt. You would generally use Lease Privilege Manger to just make a rule to overcome that, or if a user in the field needs to install an application, you would generally make another rule to overcome that.</p>
                                    <p>You might have the scenario from time to time where you want to enable a bucket of people to just do all the things as if they were admins even without local admin rights, just all the things. How do we do that? Well, that's what Self-Elevate Mode is all about. I'm going to show you here is just – I'm going to create a new GPO here called PPLPM Self-Elevate Mode. The rules for self-elevate, you can do this on the user or the computer side, so I'm going to do this one on the user side. I want to go to Least Privilege Manager, and I'm going to right-click Add New Self-Elevation Policy.</p>
                                    <p>New Self-Elevation Policy Wizard gives you the ability to turn on all these values automatically no matter what the story is. For instance, if you wanted everybody who gets this GPO – and this is linked to my east sales users, so if I wanted all of my east sales users to be able to be able to perform any executable or to perform any MSI or to do both or scripts or Java – why don't we just stick to executables and MSIs to keep it easy here. Whenever I click on these things, I can right-click and then Perform Self-Elevation for any activity I need for exes or MSIs. </p>
                                    <p>We also have the limiters. We have another video on the limiters. By default, it will apply to child processes. If you don't want to do that, you can uncheck that. If you want to reign people in a little bit more by making it so that it – they can't use this. They can use this for as little evil as possible, you might want to do that. Again, I have other videos on this particular thing. For this particular demo, I'm just going to go ahead and just talk more about self-elevation mode. As you see, I've enabled it for exes and MSIs. Go ahead and click on Next here. Let me add in a member of a domain, and I'm going to add in all of my east sales users. You do have to actually dictate a group even if it is targeted at an OU level. I'm going to dictate my east sales users here. That's who they are.</p>
                                    <p>Then here's where I have some choices. The first thing is you can change the name of the self-elevation command item. I'm going to come back to that. We can also display a message to the user. We can use the default message or change it; we'll come back and change it in a second. Then you can also do what's called require justification text where they have to tell you why they're doing this thing. We'll call this Self-Elevation for East Sales, and we'll come back around and take a look at some of those extra settings.</p>
                                    <p>Just to put a fine point on it, here's a .exe. It forces me to put a UAC prompt in, and I can right-click. There's no way for me to run this thing magically. Same thing for this MSI package. Once I get to here, I'm going to get a UAC prompt here. There's no magical way to overcome that. If I were to right-click, there's no magically overcome.</p>
                                    <p>Let's go ahead and run GP Update here, and we'll see self-elevate with the default options for a second first. Then we'll come back around and we'll play with the knobs and whistles. Give this a second to finish up here, and there we go. Procmon, again, if we double-click it, what happens? We still get the UAC prompt but not because we said that the east sales users can do self-elevate, we can right-click and do Run Self-Elevated with PolicyPak. Now that we do that, we did say that we wanted to put justification in here, so let's go ahead and let's say why. "This is required for the monthly report," or something, whatever Let's go ahead and put that in there; click Okay. Look at that. It runs. We've got our application to run. We didn't have any special rules in place. This person was able to overcome that UAC prompt and you didn't have to know a certain rule in advance.</p>
                                    <p>Let's go ahead and do the same thing for Skype set-up. Right-click and Run Self-Elevated with PolicyPak. Let's see what happens here. Hey, look at that. "Needed this to communicate with," whatever. Go ahead and click Okay and it runs and it installs just fine. You can see what the defaults were there. Chances are you probably want to go back and make your own configuration changes to the default, so let's go ahead and do that and see what those look like. I want to give you a little bit of demonstration in there.</p>
                                    <p>Let's go ahead and change some of those items here. Those would be the messages. The first thing is you can change the right-click. What we can do is say "audited self-elevate for IT," whatever's right for you. The second thing is that you can display a message. "Every action here is audited. Please think twice before elevating," whatever you want. You can also add in some variables as well. If you wanted to add in, for instance, the process name, so the process name, Process Command Line, and if you wanted to add in the publisher or whatever else you wanted to put in here, that's available to you. Some of these may or may not make sense depending on the situation but they're all available for you here. The message that would be displayed here would be "Everything is audited. Think twice." Obviously I'm going kind of fast here. That's that, and let's go ahead and check that out. Let's see how that works.</p>
                                    <p>Actually, I wanted to do one more thing here, which is the – yep, Require Justification Text. That's available It's on by default. You can turn it off if you want to, but it's – we recommend that you leave it on here, and you'll see why at the end. Let's go ahead and run GP Update here, and we'll just do two more different things here. Give this a second to finish up. What we'll do is we'll right-click over Procmon and boom, self-elevate for IT. We change the fly-out item here and hey, look, everything's audited; think twice. This is a message from your IT department, and look, you can see we put the variables in here, Procmon, the process itself, and then I think I picked the publisher. "Need to run this for weekly report." This is being audited. You should probably also say enter your justification text below. You have to actually put that in here, so you should probably change that. Go ahead and click Okay and bang, it does its thing. </p>
                                    <p>If we were to try to do now this time Silverlight install, right-click, Audited for Self-Elevate IT. There you go, same idea. "Need this for old IE website," whatever and you're off to the races. Because all this is being audited, I want to show you where this lives in the event log so you get a feel for how this works. If we go to Event Viewer here, and we go to Windows Logs – I'm sorry, Applications and Services Logs, rather, there's a PolicyPak node and in the PolicyPak node, we're going to have all of our events. You could use – we have other videos on event forwarding and tracing. You can go ahead and watch those. The point is that everything happens local to the machine, and so everything you do here will show up here.</p>
                                    <p>If we go over to the PolicyPak node, you're looking for Least Privileger Manager Client Events. Typically what you're looking for is 6400, 6401 and 6402. You can see 6401 is Self-Elevated with Justification Text. Okay, Silverlight installer – gosh, I really wonder why they needed it. Oh, look at that. They needed it for this old IE website. If we look over here, here's Procmon. Why did they need it? Oh, they needed it to run this weekly report. If we take a look at this guy, we can see what the allowed versus blocked is. We actually can see. This gives sort of like a little mini ARSOP of what's happening. We can see that East Sales User 1 is allowed to do these things on this machine.</p>
                                    <p>Now that's basically all the bells and whistles. However, what I also want to show you is how to block a specific user from doing this. Remember, we said we wanted to do the self-elevation for east sales. I'm allowing – my allowed users is east sales. If I wanted to now take away this ability for a particular user, you can create another self-elevation policy that will block them. If I were to disable it, it's going to block them. Who's the them? You can add a particular group or you can add a particular user. I'm going to add a domain user here. I'm going to use the same guy I'm logged on right now, East Sales User 1. There's East Sales User 1, going to select him and what worked ten seconds ago shouldn't work now. "Blocking East Sales User 1" here. Go ahead and click Finish. Now if we were to go to GP Update here, let's give this a second. Let this finish up. Everybody in east sales can do it but not East Sales User 1. How do we know? Let's just double-click on Procmon and that shouldn't work anyway There's no rules for that. If we were to right-click and audit with self-elevated IT, ah, it doesn't work. How about if I were to do an MSI? Right-click and oh, I can't do that, doesn't let me anymore. </p>
                                    <p>The idea is that you're creating the first rule for who will get the self-elevation policy, and then you're going to create later rules for who will block it, if that's what you want to do. Hope this is a feature that you don't have to use, and the reason why I'm advising against it is that it really is incredibly powerful and gives self-elevation/emergency rights to somebody or a group of somebodys if you need to, but I think it's a better practice to try to eliminate self-elevation and use rules that you know you are targeting to those users or computers so you actually have a better handle on exactly what they're doing. On the other hand, though, if you do turn on self-elevation, at least everything is logged to the Event Log and you can use those logs to your advantage to figure out what you can then make rules for and then eventually turn off self-elevate.</p>
                                    <p>So I hope this gets you to where you need to go and looking forward to seeing you in PolicyPak land real soon. Thanks so much.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
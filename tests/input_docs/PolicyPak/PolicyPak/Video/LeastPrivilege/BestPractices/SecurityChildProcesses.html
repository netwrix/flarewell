<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Least Privilege Manager|[%=System.LinkedTitle%]|Best Practices">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Security and Child Processes</title>
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Security and Child Processes</h1>
                                    <p><iframe width="1700" height="956" src="https://www.youtube.com/embed/GsydgID-lo4" title="PPLPM: Security and Child Processes" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="1"></iframe>
                                    </p>
                                    <h3>Transcript:Security and Child Processes</h3>
                                    <p>Hi. This is Jeremy Moskowitz. In this video, we're going to talk about best practices with regards to security and PolicyPak Least Privilege Manager.</p>
                                    <p>To set the stage, PolicyPak Least Privilege Manager, like I say, is a sharp scalpel and it will do exactly what you tell it to do. Because of that, you should be always thinking about how to give your users the least amount of privileges possible.</p>
                                    <p>Now we're going to talk about that in excruciating detail, but I want to set the stage by using a typical application like "Adobe (Acrobat) Reader" here just to show you something that you may not even know you could do.</p>
                                    <p>Now before we even go into that, I also want to show you something you can do in "Task Manager." If you click on the "Details" tab in "Task Manager," you can see your running applications and if they're "Elevated" or not. Now I don't have Least Privilege Manager elevating this application right now, and as such it says "Elevated" "No." Okay, great.</p>
                                    <p>Now some applications like Acrobat Reader and a lot of other applications enable you to go to places like "My Computer/Browse." And then you can go to things like "c:\\windows\system32." If you type "*" here to get all the items and then zip on down to the Command prompt ("cmd"), you could right click and "Open."</p>
                                    <p>Now remember, you're not elevated, so running a Command prompt from this "File/Open" window within "Adobe Reader," what's that going to do? That's going to just create a standard Command prompt. If you were to try to right click, "Run as administrator," you're going to UAC credentials. This is fine. Again, no PolicyPak involved at this stage.</p>
                                    <p>What I want to show you next, however, is if you were to go ahead and try to elevate an application that has a File/Open dialogue like this. So I'm going to "Add" a "New Executable Policy." I'm going to "Use simple rule." I'm just going to use "Path" for now.</p>
                                    <p>Most of the talk we're going to be talking about a little later is here around these "Settings," "Apply to child processes" and these other little guys. Hang tight. That's going to be the main focus of our talk.</p>
                                    <p>But just to get it started here, I'm going to "Add/Add file." I'll just use "*acro*.exe." So now I'm going to just say anything called "acro" reader whatever, that's going to "Run with elevated privileges." And we're off to the races.</p>
                                    <p>Let's do that exact same thing we did earlier. I'm going to run GP Update ("gpupdate") here. Then after this is done, I'm going to rerun Acrobat Reader. What we should see is that Acrobat Reader is now elevated because of Least Privilege Manager. Then let's do that exact same test again. Let's see what we get this time.</p>
                                    <p>We go run "Adobe (Acrobat) Reader." Go to "Open." Actually, before we do that, we can see "AcroRd32" is in fact elevated. If we were to go to "My Computer," "Browse," and go to "c:\windows\System32" and we'll type "*" again. Go back to the "cmd" prompt, or any other application. I'm just using the Command prompt as an example here. Right click and "Open."</p>
                                    <p>Now remember, we're running elevated. When we click "Open," what's going to happen? It's set as an "Administrator" Command prompt which enables you to do things like "net start" and stop. If I want to do "net stop ‘windows audio,'" this is something that can only be done if you're an admin. So this Command prompt is running with admin rights.</p>
                                    <p>Now if you're having a little panic attack, don't have a panic attack. The ability to change this behavior has always been in PolicyPak the entire time. All you need to do is when you click on the "Conditions" here, you can just say don't "Apply to child processes."</p>
                                    <p>When you unselect "Apply to child processes," what happens next automatically – let me go back to GP Update ("gpupdate") here – now what we're saying is any processes that get launched from that initial parent process are going to not inherit those rights.</p>
                                    <p>Let's do this exact same demo again. Go back to "Adobe (Acrobat) Reader." Acrobat Reader itself is in fact elevated as you can see here. We'll go to "Open," go to "My Computer," "Browse," "c:\windows\System32," and go back to Command prompt here ("cmd"), the application itself is still elevated.</p>
                                    <p>But now if we were to try to go to right click and go to "Open," what do we get? Standard Command prompt. If we try to do "net start" or stop, "net stop ‘windows time,'" for instance, you will not be able to do that because you are not running with admin rights.</p>
                                    <p>So you have this ability to block applications from spawning other processes right there. So it's on by default. Why do we have it on by default? Why do we enable the ability to spawn other processes as admin by default? Because there are times in applications, even Acrobat Reader actually is a pretty good example.</p>
                                    <p>When you go to "Help/Check for Updates," how is the process going to run? How is "Check for Updates" going to run from this parent process? If you go to "Check for Updates" and it's being told that it can't do it in elevated fashion, that's going to fail.</p>
                                    <p>So our default behavior, if we go back here, as you saw earlier is to set it such that it will "Apply to child processes." So it will automatically apply to child processes. Now again, at any point in time you can just uncheck that provided your application is suitable to do so.</p>
                                    <p>Now there are a couple other extra security mechanisms that are available to you if you want to turn the different thumbscrews. So even though you're going to by default "Apply to child processes," you can also make some choices about when things will not be able to inherit the permissions.</p>
                                    <p>For instance, "Don't apply to unsigned executables." Let's try that one. What's an unsigned executable? An unsigned executable, for instance on my Desktop here, would be this guy, this program called "CamPlay." "CamPlay" has no digital signature, and you would know that because it would have a Digital Signatures tab. Unlike "Procmon" which does have a "Digital Signatures" tab. So therefore, "CamPlay" is not digitally signed.</p>
                                    <p>Let me go ahead and run GP Update ("gpupdate") and let me try to attempt now, now that I've made that settings change in Group Policy and PolicyPak Least Privilege Manager, to try to run "CamPlay" elevated. So again, we're going to use the trusty "Details" tab here.</p>
                                    <p>Let me go ahead and run "Adobe Reader" and we can see that it's running elevated. Go to "Open" and "My Computer" and "Browse" and go to "c:\windows\System32." Actually, no, that's not what I want to do. I want to go back to the "Desktop." Here's "CamPlay." Right click and try to "Open" it.</p>
                                    <p>Now if it were digitally signed, it would run elevated. But you see it's not digitally signed, so it's not running elevate. If I were to try to "Run as administrator," it still will not run elevated. Okay, it's still not running elevated.</p>
                                    <p>But an application that is digitally signed, for instance "Procmon," right click and "Open." What's going to happen? It's running elevated. Procmon is running elevated automatically. There we go. "Procmon" is running elevated because what we told Least Privilege Manager to do was only do the prevention of passing permissions to "unsigned executables."</p>
                                    <p>So what I think we should do next is take this to the next level and talk about the idea of "untrusted executables" and "executables signed by other publishers." Let's start with "Don't apply to executables signed by other publishers."</p>
                                    <p>What does that mean? Well, as you might imagine, Acrobat Reader is signed by Adobe and Process Monitor (Procmon) is a Microsoft tool and signed by Microsoft. So now let's rerun Command prompt here and run GP Update ("gpupdate").</p>
                                    <p>So now what we're saying is if you start off life in Acrobat Reader and you try to jump the fence over to a different publisher altogether, then block that action. Let's go ahead and just see it work, and then we'll talk through that a little bit more.</p>
                                    <p>Let's go back to "Adobe Reader" here, "Open," "My Computer," "Browse," and again on my "Desktop" here, there we go. Now Process Monitor ("Procmon") signed by Microsoft, right click and "Open." What are we going to get? We are not going to be able to make the jump to running with admin rights. Same thing if I were to try to right click again and "Run as administrator." We're blocking that.</p>
                                    <p>Why would you maybe need to have this on or need this off? It's possible that Acrobat Reader maybe calls something else by the same publisher in order to get its job done. So in that way, you may want to apply it to executables signed by the same publisher which is the default behavior. Like I said before, if Acrobat Reader is trying to do its own updates or something like that, you may want to ensure that it's always going to be able to do that. But you don't want to "apply to executables signed by other publishers."</p>
                                    <p>Next on the docket here is "Don't apply to unrelated executables." That means not in the same folder or recursive. And there's a little tool tip to help you remember that. So for instance, if I "Don't apply to unrelated executables" here, you're going to see basically the exact same here. The demo will not be any different. But what we're saying here is you started the process off in Acrobat Reader land. You're trying to jump to a different folder like the Desktop. You're trying to run an application from there. What are we're going to do? We're going to block that from occurring.</p>
                                    <p>So let's go ahead and try that one out. If we go to "Open" and go to "My Computer," "Browse," go back to the "Desktop" and show everything on the Desktop here, we can then try to rerun "Procmon" and "Open" it. What's going to happen? It's going to be blocked. And other processes that we start are not going to be running with admin rights even if they run at all. They're just going to be running with standard rights.</p>
                                    <p>The last one on the docket is a little bit more advanced which is why I'm saving it for last. The idea about this last guy here, "Don't apply to untrusted executables" here, it's job is to help you look at the file owner and if it's not on the regular SecureRun list – which is to say trusted installer, a local admin, or somebody who is on the SecureRun list when SecureRun is on – then it's not going to let it run with admin rights. So also a pretty good idea.</p>
                                    <p>So long story short, it is definitely going to be your best case to have all of these checked. Well, actually, your best and most secure would be to never try to "Apply to child processes." That is actually your most secure because in this way there's no other way for that application to elevate into foreign applications.</p>
                                    <p>But again, if this is required, you may try to turn the additional thumbscrews on, on purpose, to then see if that application can be contained enough such that it is within control and doesn't need to jump out to try to apply to things like "unsigned executables," "untrusted executables," "executables signed by other publishers," or "unrelated executables."</p>
                                    <p>With that in mind, this is your security lecture of the day. I hope this helps you out and, therefore, you're using Least Privilege Manager to do that job, to do the least amount of privileges possible. So again, whenever possible uncheck "Apply to child processes." But if you do need to apply to child processes, at least you have these extra thumbscrews to turn such that your users can't jump out and run additional processes that you do not want elevated.</p>
                                    <p>All right, hope this helps you out. Thank you very much, and talk to you soon.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
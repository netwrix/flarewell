<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Application Manager|[%=System.LinkedTitle%]|Features, Tech Support and How-To">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Using Environment Variables in Paks</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Using Environment Variables in Paks</h1>
                                    <p>You might want to deliver settings based upon Windows' environment variables. There are several types of Env variables, and in this demo, we show you how to find them and some use cases.
        </p>
                                    <p><iframe width="1700" height="956" src="https://www.youtube.com/embed/xOOKQY-QrfQ" title="Endpoint Policy Manager: Using Environment Variables in Paks" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="1"></iframe>
                                    </p>
                                    <div id="tr1">
                                        <h3 id="transcript" style="text-align: center;">PolicyPak: Using Environment Variables in Paks Video Transcript</h3>
                                        <p>Hi. This is Jeremy Moskowitz, former Group Policy MVP and Founder of PolicyPak Software. In this video, I'm going to show you how you can use environment variables when using PolicyPak.</p>
                                        <p>The way to get started is let's take a look for an application that has the ability to be configured, such as WinZip here. Now, you can see that WinZip has a bunch of different "Folders." You might want to declare what the "CheckOut base folder" is. You can see here that it's by default not configured. You might want to choose maybe the Desktop of %temp or something like that, and it's easy enough to perform.</p>
                                        <p>The way to do this is inside "PolicyPak" you're just going to create a GPO and link it over to where you want to. I've already done that, so I'll go to "New/Application" and pick "PolicyPak for WinZip International LLC WinZip 14 to 17" here.</p>
                                        <p>Now inside here, all you're going to do is – in the Pak definition itself, we've already put something we think you might want, which is "<code>%localappdata%temp</code>." If you were simply to use this by right clicking and selecting "Always reapply this setting," it will take "<code>%localappdata%temp</code>" and evaluate that on the client.</p>
                                        <p>Let's go ahead and see that in action. If we were to go here and run "gpupdate," and let's go ahead and run "WinZip" now after getting the update here. If we go over to "Folders," you can see that it has updated the "CheckOut base folder" to "<code>C:Userseastsalesuser2AppDataLocaltemp</code>."</p>
                                        <p>Now again, you can if you want to change this to something else. Like let me go back over here. I'll go over here and change it to maybe "<code>%desktop%</code>." In changing it to "<code>%desktop%</code>" and going over to the target machine and running "<code>gpupdate</code>" and rerunning "<code>WinZip</code>" here, if we go to "Options/Configuration…," go back to "Folders," you can see it has declared that the "CheckOut base folder" for this user is "<code>C:Userseastsalesuser2Desktop</code>."</p>
                                        <p>There are a lot of other options here, but let me give you a quick technique to go to the advanced level here. On every target machine, all these environment variables are declared inside a special location in the registry. I'm going to show you that location. Actually, I'm going to "<a href="https://www.policypak.com/products/policypak-least-privilege-manager.html" target="_blank" title="Run as administrator">https://www.policypak.com/products/policypak-least-privilege-manager.html</a>." This is an advanced technique, so I'm going to run this as administrator here.</p>
                                        <p>I'll type "regedit." I'm looking under "<code>HKEY_CURRENT_USER/Software/Microsoft/Windows/Current Version/Explorer/Shell Folders</code>." These guys, everything on the left here, is an environment variable that you can use on this machine.</p>
                                        <p>There may be others that are available, for instance, all the things that are available when you type "set" at a Command prompt. These are all available. Everything that's set inside of Windows is available. So like "<code>%PUBLIC%</code>" as you can see will go to "<code>C:UsersPublic</code>." That's available. "<code>%HOMEPATH%</code>" – so all of these evaluate, plus all of these guys in "Shell Folders." For instance, if you wanted to go to "History" – "History" is this folder that goes all the way down there – you would just do "<code>%history%</code>" and that would evaluate there.</p>
                                        <p>Now, there are a couple of weird ones in this list, so I want to point them out. Take a look at this guy right here. This guy evaluates to "<code>C:UsersaDownloads</code>." So the name for this guy is, well, let's take a look. We would have to do "<code>%{374DE290-123F-4565-9164-39C4925E467B}%</code>." That's "Downloads."</p>
                                        <p>The reason why is that these handful of guys simply are somewhat different than some of the other guys. Just to prove a point here to make this "Downloads," I'll copy this guy into my PolicyPak here. Instead of "<code>%desktop%</code>," I'm going to do "<code>%{374DE290-123F-4565-9164-39C4925E467B}%</code>" and that is "Downloads." I know it's a little weird, but that's how it works.</p>
                                        <p>I'll close this out. I'll rerun "<code>gpupdate</code>," and we'll see that it works. OK, we'll run "WinZip" here. We'll go to "Options/Configuration…," go to "Folders" and there's the "<code>C:Userseastsalesuser2Downloads</code>" folder. That would work. You could also use if you wanted to – I'll do it for this one just to prove a point – you could also use "<code>%userprofile%downloads</code>." That should work also: "<code>%userprofile%downloads</code>."</p>
                                        <p>Let's see that that works. It starts off, it's not at "Downloads." Now let's go ahead and run "<code>gpupdate</code>" here, and we'll see if it works. If I run "<code>WinZip</code>" here – remember, I'm manipulating a different folder – there it is. Those are two ways that you could use "Downloads."</p>
                                        <p>There's one other way you might want to use environment variables, and that comes down to using item-level targeting ("Enable item-level targeting"). We have other videos on item-level targeting. But if you'll remember, item-level targeting lets you specify certain conditions for when this Pak entry will hit a target machine.</p>
                                        <p>You may want to use it, for instance, on "File Match." You might want to say when the "File exists" and put in something like "<code>%desktop%file123.doc</code>." In other words, this whole Pak entry won't kick off unless it see the file called "<code>file123.doc</code>" on the Desktop. That's perfectly legal, so that's how you would use environment variables inside the item-level targeting.</p>
                                        <p>That's it for environment variables. If you have questions on that, we're here for you. Go ahead and post your questions in the forum, and we'll see you there.</p>
                                        <p>Thanks so much.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|File Associations Manager|[%=System.LinkedTitle%]|Tips and Tricks">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Endpoint Policy Manager: How to get mailto: to open in Office 365</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Endpoint Policy Manager: How to get mailto: to open in Office 365</h1>
                                    <p>Use <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> File Associations Manager to use OWA URL links to compose message directly in Office 365. When done OWA will be the default handler for the mailto protocol in Windows, so that clicking an email address will open the OWA "Compose message" window. Hope this helps you out.</p>
                                    <p><iframe width="1463" height="823" src="https://www.youtube.com/embed/3N38DsZY-mo" title="Endpoint Policy Manager: How to get mailto: to open in Office 365" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="1"></iframe>
                                    </p>
                                    <p>Code:</p>
                                    <div class="codeSnippet">
                                        <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>`@echo off<br />set address=%1<br />set address=%address:~7%<br />rundll32 URL.DLL,FileProtocolHandler "https://outlook.office.com/?path=/mail/action/compose&amp;to=%address%"`</code></pre>
                                        </div>
                                    </div>
                                    <h3>How to get mailto: to open in&#160;Office 365</h3>
                                    <p>Hi. This is Jeremy Moskowitz. In this video, I'm going to show you how you can make your mailto handler actually open up a web browser such that it will launch Outlook web access.</p>
                                    <p>Let me show used to the result of what I put together. When you go ahead and click on a mailto like, it says "Do you want to open this link?" What's it going to do? It's going to open up your default browser and, provided you've already logged on to Office 365, it's then going to automatically send that mail to that person. It's just that simple.</p>
                                    <p>How did I perform this magic here? The first thing is that I have a little batch file. I put it in "temp," and I just called it "<code>a1.bat</code>." Let me show you what it does here. The first thing it does is that it silences it as much as it can ("@echo off").</p>
                                    <p>Then it says "set address=%1" which means it's going to take in the item that you're passing. So that would be the address: "mailto:jeremym@policypak.com." Then what it does is removes the first seven characters which would be "mailto:" and then what we do is that we run the default browser against the special link in "https://outlook.office.com" and then we put in "<code>%address%</code>" which is the address without the "mailto:".</p>
                                    <p>The net result, as you can see, is that when you click it and click "Yes" you do get that very brief flash of the DOS prompt, but the net result is that you get exactly what you're after here.</p>
                                    <p>Now let me show you how I set this up in File Associations Manager in <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> land. You have to do this on the computer side in "File Associations Manager." Then here is how to do it. You give it any "Policy Name" you want. You use the "Network Protocol." You have to use "MAILTO."</p>
                                    <p>Then we use a "Custom application." I'm going to say that my custom application is where that batch file is: "<code>c:\temp\a1.bat</code>." Then you're going to pass it "%1." The "Application Name" itself doesn't really matter, and you can select any "Application Icon." That part is not of real concern. So this is the "Associated Program" and that is the "Command Line." That's all there is to it.</p>
                                    <p>Once you've done that, you're off to the races. It will automatically associate correctly. All you have to do is run GP Update ("<code>gpupdate</code>"), log off and log back on once, and you're good to go.</p>
                                    <p>Now the next thing about this is that you may want to change the default browser, and that is totally supported as well. That's going to be in Browser Router. I already have a Browser Router policy, so I'm just going to modify that guy.</p>
                                    <p>I think my default browser right now is Internet Explorer, but let's go ahead and check it out. If I were to go to Browser Router, "<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span>" and go to my "Browser Router" settings here and if I were to check my "Default browser," it's "Internet Explorer." Let's go ahead and change that to "Google Chrome" or "Edge" or whatever you want. I'll go ahead and click on "Google Chrome" here. I'll set that.</p>
                                    <p>Then I'm going to run GP Update ("<code>gpupdate</code>") to get my latest directives here. After I do this, my goal is that I want to launch the mailto again and this time it will automatically go to Chrome. Now if I haven't logged on to Office 365 in Chrome yet, then it may not automatically open up the Office page, but you get the gist. It will have opened Office through Chrome, just not having not logged on yet.</p>
                                    <p>All right, let's go check it out. Let me go ahead and click on the email link and click "Yes." What do we get? We got Chrome automatically. We can see the log on page here. I just haven't quite logged on yet, but when I do it will then pass that all the way through, pass the correct items directly to Office 365.</p>
                                    <p>Therefore, any time you click on a mailto link, you're automatically going to the default browser and passing in the special characteristics to open up that page in Office 365 and Outlook instead of a mail program that's local.</p>
                                    <p>If you like what you see here and want to get started with PolicyPak , then go ahead and we'll see you in the webinar. Then after that, we'll hand over the bits, and you can try it out yourself.</p>
                                    <p>Thanks so very much, and we'll talk to you soon.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
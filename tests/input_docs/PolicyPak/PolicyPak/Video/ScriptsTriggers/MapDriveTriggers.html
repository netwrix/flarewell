<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Scripts &amp; Triggers Manager|[%=System.LinkedTitle%]|Triggers Specific Examples">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Endpoint Policy Manager Scripts + Triggers: Map a printer or drive when a process runs and un-map it when closed.</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Endpoint Policy Manager Scripts + Triggers: Map a printer or drive when a process runs and un-map it when closed.</h1>
                                    <p><iframe width="1700" height="956" src="https://www.youtube.com/embed/5tOXS2buwKU" title="Endpoint Policy Manager Scripts + Triggers: Map a printer or drive when a process runs and un-map it when closed." frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="1"></iframe>
                                    </p>
                                    <p>How do you map a printer or drive when you launch an application like Acrobat Reader ? Using <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> Scripts + Triggers of course. Its easy to do... just pre-try your script first, then use <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts + Triggers to do the magic. Its easy !!</p>
                                    <p>Hi, this is Jeremy Moskowitz, and in this video, I'm going to show you how you can use <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts and triggers to map a drive, or map a printer, or do some other exciting thing when you launch a process. Wouldn't it be neat if you double-click on, say, Acrobat Reader and when you do and when Acrobat Reader launches, then bingo. You either get a printer or you get a drive map or whatever you want.</p>
                                    <p>Before we run through this, let's do a little walking here. The way you're going to walk is to test this out first on a machine or two with the script you're going to actually use. I've already done this in advance, and there's two ways to map a printer with a script. One way is through PowerShell. I found that this doesn't always kick in a hundred percent of the time, but it does work sometimes, so I can just show you right here. If I were to Add Printer, Dash Connection Name, wak-wak-server-wak-printer1 here. It may or may not decide to kick in. We're going to find out together and give this a second to catch up. Yeah, see, that decided not to work, and it should work. There's absolutely nothing wrong with this command. That should work in PowerShell land.</p>
                                    <p>Instead, we're going to fall back to this old-school method called run dllprintui against the print UI entry input. Then we're going to give it the server and printer name, so let's go ahead and try this one on for size. Let's go ahead and see that, and look at that, magically delicious. We can see we got a little run there, and now we're just waiting for the printer to kick in and there we go. I mean, each one of these could actually work and it could take a little bit of time the first time. Don't panic if when you try this technique out it doesn't kick in the very first time. It's just an affect of the Windows 10 and the printer script.</p>
                                    <p>Now the removal script is remove-printername. This generally works pretty fast, so we'll go ahead and give this a shot here and then boom, there we go. There's the printer removal. How do we take what we just learned and use <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts and triggers?</p>
                                    <p>Here are the exact same commands here, and what we'll do is – what we'll say is hey, let's create a new GPO for all of our east sales users. "When we run Acrobat, then map our special printer." That's what we'll call that, and then we'll click on Edit here. What we're going to do is create two different scripts with triggers. What we'll do is we'll go to Scripts Manager here. You can do this on either the user or the computer side. I'm going to do this on the user side, so go to Add Policy here and what we're going to do is add in that script. Now that first script, like I said, that PowerShell one gives me a little bit of fits, so what I'm going to do is take the old-school run dll32printer guy here. Bang, so I'm copying that in. There's the bad script.</p>
                                    <p>Now there is no revert script when you use triggers, so we'll just go ahead and click Next and then on the trigger, what we want to do is on a process start. On process start, we want to run this thing. What's the process? Well, let's go ahead and – well, let's run Acrobat Reader. If we run Acrobat Reader on this machine, you can see that it's running here and we can just select that process from the actual running process right here. Let's go ahead and pick that guy. Thank you for popping up, Acrobat Reader. Here we go. Here's Acrobat Reader. When we see Acrobat Reader run as the process, then perform the work. Policy start trigger, so we'll call this "Acro Map Printer." </p>
                                    <p>Now we actually have to do another one when the process stops. We'll create a new policy here. This one will be the PowerShell script because we saw that one worked out pretty well, so we'll go ahead and pick that guy. Remove Printer Name, so PowerShell script this time. Remove the printer name and then no revert script there. This time what we'll do is we'll say "On trigger when it's a process close," and we'll pick the process again. We'll select from the process here. We'll go ahead and pick Acrobat Reader, and we're off to the races.</p>
                                    <p>Again, if you didn't have the process running, you can just pick it by the file and so no. go ahead and click Next and now we'll say unmap printer. Here we go, unmap printer. You can put any number of things in here, but I'm just doing this nifty printer mapping thing. Now that we're all set and ready to go here, let me go ahead and run GP update to just get the signal that we're doing this new thing. Give this a second to finish up. Alright, now let's take it for a test drive. Let's go ahead and just leave that window down there and let's run Acrobat Reader. I'm going to move this out of the way so we can actually see it. There we go. You can see the printer 2016 is actually mapped automatically. When we close this process here, watch what happens to the printer. It's going to get nuked.</p>
                                    <p>Alright, let's do it one more time just for good measure. Double-click on Acrobat Reader. What happens? Boom, the printer's installed. When we uncheck or when we close Acrobat Reader, the printer is automatically nuked because of <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts. </p>
                                    <p>Don't get dismayed if this doesn't work the very first time. Again, it's some kind of affect around how the printer takes a couple seconds the very first time to probably get that driver in and rocking and rolling. After that, you can see it actually happens really, really quickly. I hope this helps you out and you're ready to use <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts and triggers. Thanks very much.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Scripts &amp; Triggers Manager|[%=System.LinkedTitle%]|Triggers Specific Examples">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Endpoint Policy Manager Scripts and Triggers: Get to understand login script trigger with GP and MDM systems !</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Endpoint Policy Manager Scripts and Triggers: Get to understand login script trigger with GP and MDM systems !</h1>
                                    <p><iframe width="1700" height="956" src="https://www.youtube.com/embed/y14Q4qUndxM" title="Endpoint Policy Manager Scripts and Triggers: Get to understand login script trigger with GP and MDM systems !" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="1"></iframe>
                                    </p>
                                    <p>No login scripts in MDM and Intune got your down? Looking to have something faster and more reliable (and something that works offline) for GPO and <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> cloud? Then check out <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts + Login Script Triggers... right here!</p>
                                    <p>Hi, this is Jeremy Moskowitz. In this video, we're going to learn how to use triggers with regards to <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts. There's a bunch of problems we want to overcome. The first one is that if you're using a machine that's connected to an MDM service like this one is, there's no log-on script. There's also no log-off script. What I'm going to show you how to do is how to create a trigger for your machines for your MDM service. Another thing we want to solve today is if you are domain-joined, there's no way to trigger something when a particular application is run. I'm going to show you both of those things right now with <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts Manager. </p>
                                    <p>What we're going to do is our our east sales users, we're going to create a GPO called <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts and Triggers. Of course this GPO name could be whatever you want. Then I'll go ahead and click Edit here and this is just built right into <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span>. You can do this on the users side or the computers side, so the idea is that you can say for everybody who logs on the machine, they're going to get this script, or you can do this script on the computer side. We'll go ahead and right-click and Add New Policy here. What we'll do is we'll define our script.</p>
                                    <p>For this simple example, I'm going to do a PowerShell script that puts a shortcut icon. Here is the script that we're going to use, so I'm just going to take it. It's going to put a shortcut icon the desktop. We're going to run this script as user. If you have a complex or unusual script that you need to run at system, you can run it with elevated rights, which is pretty nifty. We're going to skip over this idea of revert action because revert actions are not supported on trigger-based scripts. What we'll then do is say instead of always, once, or once when forced, now we'll get to use on trigger. We'll just do a simple log-on trigger. Now log-on, you can also do at shutdown. You can do it when the session is locked or unlocked for Citrix and terminal server. You can also do when process starts, stops, or on a particular schedule, which is also incredibly nifty.</p>
                                    <p>I'm just going to do log-on for right now. The other part about log-on is that you can also delay X number of minutes after log-on. I'm not going to do that. I'm going to have it just fly right away. Once we've done this log-on trigger script policy here, we're off to the races. Let's go ahead and check it out. I don't have my item here. What I am going to do is run GP Update just to get the signal for this policy. Just give this a second to catch up. Now that that's done, let's go ahead and go over and let's log off. We'll log on here, and now that we're logged on, boom, there it is. Our scripted activity is right there right at log-on time. Again, if we wanted to push this into X number of minutes into the future after log-on, we can certainly do that.</p>
                                    <p>Now it's time to save this out for use with MDM. We'll go ahead and export this as XML, call this PP Export Script 1 here. Remember, we have this little utility that's an MSI wrap-up utility here. That's the Exporter tool. Then what we want to do is create a new MSI, and we'll add that existing file here. Let's find my Export Script 1 file and I'm going to change this for use on the computer. Every user on the computer will now get this script. Then I'll go ahead and click Next and I'll save it out as an MSI to upload to my MDM service. I'll call it Exported GPOs. </p>
                                    <p>Now it's time to get this into my MDM service like InTune right now. Here we are in Microsoft InTune, and you can see we've already pre-staged and assigned the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> client set extension and the <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> license. Now it's time to add in the exported group policy objects. All three of these things are going to make it go. Here we are back on our MDM-enrolled machine. We've gotten it synchronized. It got the policy. We're all set to go. Only thing that's left is to sign out, sign back on, and see that our log-on script is now hitting with <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts and triggers.</p>
                                    <p>If we go ahead and log back on here, give it a second to catch up, and here we are. We'll all logged on. There it is, the Visit <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> item, and like I said, if we decide – a user throws that in the trash and then they log out and log back on, what's going to happen? This is a log-on script. It's happening through MDM. It's going to happen absolutely every single time because that's what we said to do. Let's go ahead and log on, see that that's true. There we go. Our log-on script is running.</p>
                                    <p>If you like the idea of <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> scripts and triggers, you're welcome to watch some more videos on how the triggers work. Thanks so very much and talk to you soon.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
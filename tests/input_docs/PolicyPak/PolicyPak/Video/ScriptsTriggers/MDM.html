<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Scripts &amp; Triggers Manager|[%=System.LinkedTitle%]|Methods: MDM, PDQ, etc.">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Endpoint Policy Manager Scripts and YOUR MDM service: Un-real power</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Endpoint Policy Manager Scripts and YOUR MDM service: Un-real power</h1>
                                    <p>MDM services cannot deliver scripts and UN-deliver scripts. That's where <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> Scripts Manager AND your MDM service become awesome. Check out this video for an overview of WHY you need it and some examples of PP Scripts + MDM in use.</p>
                                    <p><iframe width="1700" height="956" src="https://www.youtube.com/embed/sosYsaPbWSo" title="Endpoint Policy Manager Scripts and YOUR MDM service: Un-real power" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="1"></iframe>
                                    </p>
                                    <h3 id="policypak-scripts-and-your-mdm-service-un-real-power" style="text-align: center;">PolicyPak Scripts and YOUR MDM service-Un-real power</h3>
                                    <p>Hi, this is Jeremy Moskowitz, Desktop Management and former Group Policy MVP. In this video, I'm going to show you first why your MDM solution isn't that good at scripting and how we here at <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> with our <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Script Manager plus your MDM is probably way better than what your vendor provides by itself.</p>
                                    <p>The first thing is that maybe your vendor doesn't provide any scripting ability in their MDM solution. Some of them don't. Some of them do. I'm going to talk about the ones that do but if you don't have any scripting ability, well, now you do with <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Script Manager.</p>
                                    <p>If you're a MobileIron customer, this is an extra add-on. In other words, this thing called MobileIron Bridge you have to pay into in order to run existing PowerShell scripts that they provide or you can create yourself. But the point is if you want to do this idea, you have to buy into it as a MobileIron customer.</p>
                                    <p>A lot of these vendors only let you use one script type. Most of them are restricted to PowerShell but if you've got some intricate scripts that are already VB or batch file scripts, you're kind of out of luck. I'll show you how to fix that problem.</p>
                                    <p>These scripts will never update. Typically, these scripts are applied and run only one time unless the script itself is updated. In our world that's different, and I'll show you how that's different.</p>
                                    <p>These other solutions let you target only computers and not users. That's kind of a bummer because you might want to do something that affects every user on the machine, and you may want to do things that affect the system itself. With these other systems, you kind of can only do the latter. You can only affect the system itself.</p>
                                    <p>All the logic must be contained inside the script. This is a big problem because you might have a script that you might want to say, "Do this thing when it's a desktop; do this other thing when it's a laptop." That stinks because then you have to figure out how to determine those conditions being true, and you have to jam that all into the script. So if you're not a bona fide scripting expert, that can be pretty hard. I'll show you how to work around that.</p>
                                    <p>Most of these scripts cannot be retriggered. The idea is that if you've deployed a script, then that script has no way to get rerun. These scripts have no way to get retriggered. So once that script comes down, there's really no way for you to retrigger that and see that happen again. Typically you need to just update the script and wait for MDM to redeploy it. There's no way to rerun that script for testing purposes.</p>
                                    <p>These last four – number 3, 2, 1 and 0 – are kind of all about Intune restrictions. At Microsoft Ignite this last year, they made a big deal that you can now deploy PowerShell scripts using Intune. The crowd went wild and that's great, but it should be noted about what the limitations are. I want to go through that here.</p>
                                    <p>The first thing is that it only lets you do PowerShell scripts. Actually, that's another thing. It only lets you do PowerShell scripts just like some of the other vendors. If you have things that are not in PowerShell, you can't do it.</p>
                                    <p>The other key restriction is that the scripts must be very, very small: 10 KB for ACSII or 5 KB for Unicode, which is really, really small.</p>
                                    <p>The second thing which might even be more important is that you can only use the 32-bit version of PowerShell. So if you have 64-bit PowerShell cmdlets, those are not a thing you can do inside the Intune plus PowerShell.</p>
                                    <p>The scripts only run when the computer is actually already pre-associated with a user. If you have non logon devices like kiosk machines, then MDM plus Intune plus scripting is not a thing you can do here. It's kind of a major restriction.</p>
                                    <p>Also, the scripts will not run with hybrid scenarios. That is, if the computer is both on-prem domain joined and Azure domain joined, then it's a no-go. The script will not run in that case.</p>
                                    <p>So how do we overcome all that? We've really thought those problems all the way through and tried to wrestle them all the way to the ground.</p>
                                    <p>The first thing is that <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts is included with the On-Prem and MDM edition, and it works across any MDM service.</p>
                                    <p>We can target stuff to both user and computer side. It just works the way you would expect.</p>
                                    <p>We can use all sorts of languages, like VB, JS, BAT and PowerShell as a language.</p>
                                    <p>Scripts can be applied ONCE, ALWAYS, and ONCE plus a retrigger if you want to.</p>
                                    <p>We have no size restrictions.</p>
                                    <p>We can work with kiosk mode.</p>
                                    <p>We can work with hybrid join.</p>
                                    <p>And my favorite two superpowers is this idea where you get an ON script and an OFF script. So when the policy no longer applies, you're predetermining what's supposed to happen when that policy no longer applies.</p>
                                    <p>And all of our stuff can be wrapped up inside item-level targeting to make it drop-dead easy. In other words, if you have a script that you want to say, "Do this thing when it's a laptop," great. We can figure that out very quickly using item-level targeting.</p>
                                    <p>That's it for the little mini stuff here. Now I'm hoping you watched the previous videos where I created existing policies here in <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts land. I have one here on the user side which is going to deliver a shortcut and it's also going to un-deliver a shortcut when the policy no longer applies.</p>
                                    <p>Here's he "Apply action" that's going to do deliver a shortcut when the policy applies. Here's the "Revert action" that's going to nuke the shortcut when the policy no longer applies. We talked about this in other videos that you can wrap the whole thing up in "Item Level Targeting" which is awesome.</p>
                                    <p>You can just point and shoot your way to glory and say I'm going to do this ON script when it's a "Portable Computer" or when the "Operating System" is Windows 10 or when the "CPU Speed" or when the "IP Address Range," whatever your goal is you can set the targeting filters so that this script will only fire off when the condition is true. And when the condition isn't true anymore, we're going to run the OFF script.</p>
                                    <p>I've already done this script. Actually, in a previous video, I dragged it over here to the desktop in a little folder called "PPSCRIPTS XML." It's right here, the scripts for the user side to make the shortcut.</p>
                                    <p>The other thing I did in the other video here is I created another script that will rename my network adapter, so it's going to do a system wide thing. It's going to find the ethernet adapter and "Rename" it to be called "AwayNet." Just something so you can see me do something on the computer side.</p>
                                    <p>Like I said, <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> can use not just "PowerShell" but it can use "Batch script," "VB Script" and "JavaScript." We've got that ON script and that OFF script.</p>
                                    <p>I've already dragged and dropped this over to a file, and it's ready to go. Now we're ready to close out the policy editor, and now we're ready to convert the XMLs into an MSI. How do you do that? We're going to go to the "PolicyPak/PolicyPak Exporter Tool." The <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Exporter utility lets you "Create a new MSI installer" to then upload to your MDM service.</p>
                                    <p>Let's go ahead create those. We're going to "Add Existing Files." Here they are. I'll just go ahead and "Open" those guys. Now at this point, you can see that the first item here is going to go to "Users &amp; Groups." Now I haven't declared any users. This would be for users that would be domain joined, so in hybrid scenarios we would do that.</p>
                                    <p>Because the machine I'm going to be demonstrating on has no domain joined property, I'm going to set it to "Computer." This is really important. This script, even though it's a user side thing, is going to hit "All Users" on the "Computer." That's the amazing part. It's going to hit all users on the computer. This other thing that's a system policy, it's going to rename the network card, that is on the "Computer" side. That is on the system side, and there's no changing that.</p>
                                    <p>We'll go ahead and click "Next" here, and we'll call this "Packaged <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Settings for SCRIPTS." Something like that so you know what you're doing here. We'll go ahead and click "Next" and finish it out. We'll go ahead and save it here in the same folder, and we'll call it "PPSCRIPTSMSI.msi." There we go. There's our file ready to go.</p>
                                    <p>Let's upload it to our MDM service. The one I happen to be using is "AirWatch." Again, we work with MobileIron. We work with Intune. We work with other ones. I've already got the "<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Client-Side Extension" – that's the moving part to make <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> do it's magic – uploaded. I've got our "Licenses" uploaded. I've got some older "Settings" that are uploaded.</p>
                                    <p>Let me go ahead and "Add Application" here. I'm going to go ahead and find the MSI file we just generated together. Where is that guy? On the "Desktop," "PPSCRIPTS XML," here we go: "PPSCRIPTSMSI." We'll go ahead and "Save" it. It's not a "dependency app." Okay, very exciting stuff.</p>
                                    <p>I'm going to just zip through this whole thing really fast. This only takes a quick second here. I'm going to go ahead and "Add Assignment" to everybody. We'll go ahead and do everybody here. There we go. Ready to go. We'll deploy it to all computers here.</p>
                                    <p>Now this is the thing that takes a while, which is to say MDM runs on its own schedule. I've got it deployed. It's going to everybody. If I take a look at my endpoint here, the first thing is you can see that I am enrolled in my "AirWatch" or my MDM service. Again, it doesn't matter which one. I'll go ahead and close that out.</p>
                                    <p>You can also see that my MDM service has deployed my "<span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Client-Side Extension." That's the magic that makes this all go. There are the "Licenses" to light up <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span>. I'll leave this open for now.</p>
                                    <p>The last thing is that we want to see the result. The result we're looking for when the script is finally downloaded by our MDM is service is that it's going to rename the "Ethernet" adapter and also going to give us a shortcut. That's just a simple script that I created in previous videos. What I'll do now is I'll pause the video. We'll come back and we'll see the result of the MDM service.</p>
                                    <p>Okay, I've waited a while. My MDM service and my client have talked to each other, and here are the results. The first thing is that here is the "Packaged <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Settings for SCRIPTS" MSI that's automatically downloaded. Again, our MDM service delivered that to us.</p>
                                    <p>And look, we have the shortcut that affects all users on the machine. I did have to hit F5 to refresh this, but you can see the ethernet adapter has changed from "Ethernet" to "AwayNet." So it's doing all those things.</p>
                                    <p>And here's the other best part. I'm not going to use MDM to do this part. I'm just going to do this by hand. But what happens if the script is revoked? Let's go ahead and pretend that using our MDM service we decide that we don't want this script anymore. I'm going to go ahead and just "Uninstall" the preconfigured "Packaged <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Settings for SCRIPTS" here.</p>
                                    <p>If I were to go put the password in here, watch what's going to happen here. We've removed it here, and watch the icon disappear because we have that ON script idea and that OFF script idea. We were able to deliver the ON script when the policy and MSI applied, and we're able to revoke that policy with the script when the OFF script was ready to apply just like that.</p>
                                    <p>Again, no other MDM solution can do that. And again, we're not an MDM solution. We hook into and make your MDM solution even better. I hope this helps you out and gets you a better understanding of where <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts plus your MDM solution equals way more awesome than you had five minutes ago.</p>
                                    <p>Thanks so much for watching, and we'll talk to you soon.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
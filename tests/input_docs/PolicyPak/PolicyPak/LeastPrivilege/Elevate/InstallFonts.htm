<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Least Privilege Manager|[%=System.LinkedTitle%]|Tips (Specific Workaround for Apps and Scenarios)">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Install Windows Fonts for users or Elevate end-users to install fonts themselves</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Install Windows Fonts for users or Elevate end-users to install fonts themselves</h1>
                                    <p><b>Business case</b>: Your users don't have rights to install fonts, but you may want them to install fonts themselves or install fonts that you approve. In this document we will demonstrate how will you install fonts by using the either method.</p>
                                    <h2>Elevating an end-user to install Windows Fonts (FOR USERS)</h2>
                                    <h3>Using Endpoint Privilege Manager:</h3>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Create a GPO and link it to the required scope</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Create a PPLPM policy, by right-clicking on that node and select <b>Add New EXE Policy</b></p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Select <b>Use Simple Rule</b> and click on <b>Next</b></p>
                                    <p style="text-align: center;">
                                        <img alt="" height="560" src="../../../Resources/Images/LeastPrivilege/Elevate/467_1_img-1.png" width="747" />
                                    </p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>Consider choosing <b>Use combo rule</b> option for extra security.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Choose condition as Path, click the  <b>Add </b>button and select <b>Add File</b> option.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Click on the <b>Browse</b> button and specify the path of the fontview.exe application, as shown below.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 6 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 6 – </b></span></span>Run <code>GPUPDATE </code>on the client machine and verify the results. You can also view theabove steps in this video: <a href="../../Video/LeastPrivilege/Elevate/InstallFonts.html" target="_blank" title="Enable end-users to install their own fonts" alt="Enable end-users to install their own fonts" class="MCXref xref" xrefformat="{para}">Enable end-users to install their own fonts</a></p>
                                    <h2>Installing fonts for end-users (FOR ADMINS)</h2>
                                    <p>Administrators can install fonts for end-users by using a <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> Scripts Manager.</p>
                                    <h3>Using Endpoint Policy Scripts Manager:</h3>
                                    <p>In this method we'll show how an administrator can install fonts for the users through a GPO using <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> Scripts Manager.</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Create a GPO and link it to the required scope.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Create a PP Scripts Manager policy and click  <b>Next </b>on the Wizard.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Leave the default option checked <b>Apply this policy to computer (default)</b> and click <b>Next</b>.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Select PowerShell Script from the drop-down and paste the script to install fonts.</p>
                                    <p style="text-align: center;">
                                        <img alt="" height="561" src="../../../Resources/Images/LeastPrivilege/Elevate/467_5_img-3.png" width="732" />
                                    </p>
                                    <p>This script to Add Fonts from PowerShell is acquired from Microsoft Doc website. For more information see the Microsoft article on <a href="https://learn.microsoft.com/en-us/archive/blogs/deploymentguys/adding-and-removing-fonts-with-windows-powershell" target="_blank" title="Adding and Removing Fonts with Windows PowerShell" alt="Adding and Removing Fonts with Windows PowerShell">Adding and Removing Fonts with Windows PowerShell</a>.<a href="https://learn.microsoft.com/en-us/archive/blogs/deploymentguys/adding-and-removing-fonts-with-windows-powershell" target="_blank" title="Adding and Removing Fonts with Windows PowerShell" alt="Adding and Removing Fonts with Windows PowerShell"></a></p>
                                    <div class="codeSnippet"> <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>#########################################################################################&#160;&#160;&#160;&#160;<br /># MICROSOFT LEGAL STATEMENT FOR SAMPLE SCRIPTS/CODE&#160;&#160;&#160;&#160;######################################<br />###################################################&#160;&#160;&#160;&#160;<br /># This Sample Code is provided for the purpose of illustration only and is not&#160;&#160;&#160;&#160;<br /># intended to be used in a production environment.<br />#&#160;&#160;&#160;&#160;# THIS SAMPLE CODE AND ANY RELATED INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY&#160;&#160;&#160;&#160;<br /># OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED&#160;&#160;&#160;&#160;<br /># WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.&#160;&#160;&#160;&#160;<br />#&#160;&#160;&#160;&#160;# We grant You a nonexclusive, royalty-free right to use and modify the Sample Code&#160;&#160;&#160;&#160;#&#160;<br />and to reproduce and distribute the object code form of the Sample Code, provided&#160;&#160;&#160;&#160;# that You agree:&#160;&#160;&#160;&#160;<br /># (i) to not use Our name, logo, or trademarks to market Your software product&#160;&#160;&#160;&#160;# in which the Sample Code is embedded;&#160;&#160;&#160;&#160;<br /># (ii) to include a valid copyright notice on Your software product in which&#160;&#160;&#160;&#160;# the Sample Code is embedded;&#160;<br />and&#160;&#160;&#160;&#160;# (iii) to indemnify, hold harmless, and defend Us and Our suppliers from and&#160;&#160;&#160;&#160;# against any claims or lawsuits,&#160;<br />including attorneys' fees, that arise&#160;&#160;&#160;&#160;<br /># or result from the use or distribution of the Sample Code.&#160;&#160;&#160;&#160;<br />#########################################################################################&#160;&#160;&#160;&#160;<br />#******************************************************************************&#160;&#160;&#160;&#160;<br /># File: Add-Font.ps1&#160;&#160;&#160;&#160;# Date: 08/28/2013&#160;&#160;&#160;&#160;# Version: 1.0.1&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;<br /># Purpose: PowerShell script to install Windows fonts.&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Usage: Add-Font -help | -path "&lt;Font file or folder path&gt;"&#160;&#160;&#160;&#160;<br />#&#160;&#160;&#160;&#160;# Copyright (C) 2010 Microsoft Corporation&#160;&#160;&#160;&#160;<br />#&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Revisions:&#160;&#160;&#160;&#160;# ----------&#160;&#160;&#160;&#160;# 1.0.0 09/22/2010 Created script.&#160;&#160;&#160;&#160;# 1.0.1 08/28/2013 Fixed help text.&#160;<br />Added quotes around paths in messages.&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;#******************************************************************************&#160;&#160;&#160;&#160;<br />#requires -Version 2.0&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;# Declare Parameters&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;param(&#160;&#160;&#160;&#160;[string] $path = "",&#160;&#160;&#160;&#160;[switch] $help = $false&#160;&#160;&#160;&#160;)&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;<br /># Declare Global Variables and Constants&#160;&#160;&#160;&#160;#*******************************************************************&#160;&#160;&#160;&#160;<br /># Define constants&#160;&#160;&#160;&#160;set-variable CSIDL_FONTS 0x14 -option constant&#160;&#160;&#160;&#160;<br /># Create hashtable containing valid font file extensions and text to append to Registry entry name.&#160;&#160;&#160;&#160;$hashFontFileTypes = @{}&#160;&#160;&#160;&#160;<br />$hashFontFileTypes.Add(".fon", "")&#160;&#160;&#160;&#160;$hashFontFileTypes.Add(".fnt", "")&#160;&#160;&#160;&#160;$hashFontFileTypes.Add(".ttf", " (TrueType)")&#160;&#160;&#160;&#160;<br />$hashFontFileTypes.Add(".ttc", " (TrueType)")&#160;&#160;&#160;&#160;$hashFontFileTypes.Add(".otf", " (OpenType)")&#160;&#160;&#160;&#160;<br /># Type 1 fonts require handling multiple resource files.&#160;&#160;&#160;&#160;# Not supported in this script&#160;&#160;&#160;&#160;<br />#$hashFontFileTypes.Add(".mmm", "")&#160;&#160;&#160;&#160;#$hashFontFileTypes.Add(".pbf", "")&#160;&#160;&#160;&#160;#$hashFontFileTypes.Add(".pfm", "")&#160;&#160;&#160;&#160;<br /># Initialize variables&#160;&#160;&#160;&#160;$invocation = (Get-Variable MyInvocation -Scope 0).Value&#160;&#160;&#160;&#160;<br />$scriptPath = Split-Path $Invocation.MyCommand.Path&#160;&#160;&#160;&#160;$fontRegistryPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts"&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;# Load C# code&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;<br />$fontCSharpCode = @'&#160;&#160;&#160;&#160;using System;&#160;&#160;&#160;&#160;using System.Collections.Generic;&#160;&#160;&#160;&#160;using System.Text;&#160;&#160;&#160;&#160;using System.IO;&#160;&#160;&#160;&#160;<br />using System.Runtime.InteropServices;&#160;&#160;&#160;&#160;namespace FontResource&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;public class AddRemoveFonts&#160;&#160;&#160;&#160;<br />{&#160;&#160;&#160;&#160;private static IntPtr HWND_BROADCAST = new IntPtr(0xffff);&#160;&#160;&#160;&#160;<br />private static IntPtr HWND_TOP = new IntPtr(0);&#160;&#160;&#160;&#160;private static IntPtr HWND_BOTTOM = new IntPtr(1);&#160;&#160;&#160;&#160;<br />private static IntPtr HWND_TOPMOST = new IntPtr(-1);&#160;&#160;&#160;&#160;private static IntPtr&#160;<br />HWND_NOTOPMOST = new IntPtr(-2);&#160;&#160;&#160;&#160;private static IntPtr HWND_MESSAGE = new IntPtr(-3);&#160;&#160;&#160;&#160;<br />[DllImport("gdi32.dll")]&#160;&#160;&#160;&#160;static extern int AddFontResource(string lpFilename);&#160;&#160;&#160;&#160;<br />[DllImport("gdi32.dll")]&#160;&#160;&#160;&#160;static extern int RemoveFontResource(string lpFileName);&#160;&#160;&#160;&#160;<br />[DllImport("user32.dll",CharSet=CharSet.Auto)]&#160;&#160;&#160;&#160;private static extern int SendMessage(IntPtr hWnd, WM wMsg, IntPtr wParam, IntPtr lParam);&#160;&#160;&#160;&#160;<br />[return: MarshalAs(UnmanagedType.Bool)]&#160;&#160;&#160;&#160;[DllImport("user32.dll", SetLastError = true)]&#160;&#160;&#160;&#160;<br />private static extern bool PostMessage(IntPtr hWnd, WM Msg, IntPtr wParam, IntPtr lParam);&#160;&#160;&#160;&#160;<br />public static int AddFont(string fontFilePath) {&#160;&#160;&#160;&#160;FileInfo fontFile = new FileInfo(fontFilePath);&#160;&#160;&#160;&#160;<br />if (!fontFile.Exists)&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;return 0;&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />try&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;int retVal = AddFontResource(fontFilePath);&#160;&#160;&#160;&#160;//This version of SendMessage is a blocking call until all windows respond.<br />//long result = SendMessage(HWND_BROADCAST, WM.FONTCHANGE, IntPtr.Zero, IntPtr.Zero);&#160;&#160;&#160;&#160;<br />//Alternatively PostMessage instead of SendMessage to prevent application hang&#160;&#160;&#160;&#160;bool posted = PostMessage(HWND_BROADCAST,&#160;<br />WM.FONTCHANGE, IntPtr.Zero, IntPtr.Zero);&#160;&#160;&#160;&#160;return retVal;&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;catch&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;return 0;&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />public static int RemoveFont(string fontFileName)&#160;<br />{&#160;&#160;&#160;&#160;//FileInfo fontFile = new FileInfo(fontFileName);&#160;&#160;&#160;&#160;//if (!fontFile.Exists)&#160;&#160;&#160;&#160;//{&#160;&#160;&#160;&#160;// return false;&#160;&#160;&#160;&#160;<br />//}&#160;&#160;&#160;&#160;try&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;int retVal = RemoveFontResource(fontFileName);&#160;&#160;&#160;&#160;<br />//This version of SendMessage is a blocking call until all windows respond.&#160;&#160;&#160;&#160;<br />//long result = SendMessage(HWND_BROADCAST, WM.FONTCHANGE, IntPtr.Zero, IntPtr.Zero);&#160;&#160;&#160;&#160;<br />//Alternatively PostMessage instead of SendMessage to prevent application hang&#160;&#160;&#160;&#160;bool posted =&#160;<br />PostMessage(HWND_BROADCAST, WM.FONTCHANGE, IntPtr.Zero, IntPtr.Zero);&#160;&#160;&#160;&#160;return retVal;&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />catch&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;return 0;&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />public enum WM : uint&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;NULL = 0x0000,&#160;&#160;&#160;&#160;CREATE = 0x0001,&#160;&#160;&#160;&#160;DESTROY = 0x0002,&#160;&#160;&#160;&#160;MOVE = 0x0003,&#160;&#160;&#160;&#160;<br />SIZE = 0x0005,&#160;&#160;&#160;&#160;ACTIVATE = 0x0006,&#160;&#160;&#160;&#160;SETFOCUS = 0x0007,&#160;&#160;&#160;&#160;KILLFOCUS = 0x0008,&#160;&#160;&#160;&#160;ENABLE = 0x000A,&#160;&#160;&#160;&#160;<br />SETREDRAW = 0x000B,&#160;&#160;&#160;&#160;SETTEXT = 0x000C,&#160;&#160;&#160;&#160;GETTEXT = 0x000D,&#160;&#160;&#160;&#160;GETTEXTLENGTH = 0x000E,&#160;&#160;&#160;&#160;PAINT = 0x000F,&#160;&#160;&#160;&#160;<br />CLOSE = 0x0010,&#160;&#160;&#160;&#160;QUERYENDSESSION = 0x0011,&#160;&#160;&#160;&#160;QUERYOPEN = 0x0013,&#160;&#160;&#160;&#160;ENDSESSION = 0x0016,&#160;&#160;&#160;&#160;<br />QUIT = 0x0012,&#160;&#160;&#160;&#160;ERASEBKGND = 0x0014,&#160;&#160;&#160;&#160;SYSCOLORCHANGE = 0x0015,&#160;&#160;&#160;&#160;SHOWWINDOW = 0x0018,&#160;&#160;&#160;&#160;<br />WININICHANGE = 0x001A,&#160;&#160;&#160;&#160;SETTINGCHANGE = WM.WININICHANGE,&#160;&#160;&#160;&#160;<br />DEVMODECHANGE = 0x001B,&#160;&#160;&#160;&#160;ACTIVATEAPP = 0x001C,&#160;&#160;&#160;&#160;FONTCHANGE = 0x001D,&#160;&#160;&#160;&#160;TIMECHANGE = 0x001E,&#160;&#160;&#160;&#160;<br />CANCELMODE = 0x001F,&#160;&#160;&#160;&#160;SETCURSOR = 0x0020,&#160;&#160;&#160;&#160;MOUSEACTIVATE = 0x0021,&#160;&#160;&#160;&#160;CHILDACTIVATE = 0x0022,<br />QUEUESYNC = 0x0023,&#160;&#160;&#160;&#160;GETMINMAXINFO = 0x0024,&#160;&#160;&#160;&#160;PAINTICON = 0x0026,&#160;&#160;&#160;&#160;ICONERASEBKGND = 0x0027,&#160;&#160;&#160;&#160;<br />NEXTDLGCTL = 0x0028,&#160;&#160;&#160;&#160;SPOOLERSTATUS = 0x002A,&#160;&#160;&#160;&#160;DRAWITEM = 0x002B,&#160;&#160;&#160;&#160;MEASUREITEM = 0x002C,&#160;&#160;&#160;&#160;<br />DELETEITEM = 0x002D,&#160;&#160;&#160;&#160;VKEYTOITEM = 0x002E,&#160;&#160;&#160;&#160;CHARTOITEM = 0x002F,&#160;&#160;&#160;&#160;SETFONT = 0x0030,&#160;&#160;&#160;&#160;<br />GETFONT = 0x0031,&#160;&#160;&#160;&#160;SETHOTKEY = 0x0032,&#160;&#160;&#160;&#160;<br />GETHOTKEY = 0x0033,&#160;&#160;&#160;&#160;QUERYDRAGICON = 0x0037,&#160;&#160;&#160;&#160;COMPAREITEM = 0x0039,&#160;&#160;&#160;&#160;GETOBJECT = 0x003D,&#160;&#160;&#160;&#160;<br />COMPACTING = 0x0041,&#160;&#160;&#160;&#160;COMMNOTIFY = 0x0044,&#160;&#160;&#160;&#160;WINDOWPOSCHANGING = 0x0046,&#160;&#160;&#160;&#160;<br />WINDOWPOSCHANGED = 0x0047,&#160;&#160;&#160;&#160;POWER = 0x0048,&#160;&#160;&#160;&#160;COPYDATA = 0x004A,&#160;&#160;&#160;&#160;CANCELJOURNAL = 0x004B,&#160;&#160;&#160;&#160;<br />NOTIFY = 0x004E,&#160;&#160;&#160;&#160;INPUTLANGCHANGEREQUEST = 0x0050,&#160;&#160;&#160;&#160;INPUTLANGCHANGE = 0x0051,&#160;&#160;&#160;&#160;<br />TCARD = 0x0052,&#160;&#160;&#160;&#160;HELP = 0x0053,&#160;&#160;&#160;&#160;USERCHANGED = 0x0054,&#160;&#160;&#160;&#160;NOTIFYFORMAT = 0x0055,<br />CONTEXTMENU = 0x007B,&#160;&#160;&#160;&#160;STYLECHANGING = 0x007C,&#160;&#160;&#160;&#160;STYLECHANGED = 0x007D,&#160;&#160;&#160;&#160;DISPLAYCHANGE = 0x007E,&#160;&#160;&#160;&#160;GETICON = 0x007F,&#160;&#160;&#160;&#160;<br />SETICON = 0x0080,&#160;&#160;&#160;&#160;NCCREATE = 0x0081,&#160;&#160;&#160;&#160;NCDESTROY = 0x0082,&#160;&#160;&#160;&#160;NCCALCSIZE = 0x0083,&#160;&#160;&#160;&#160;<br />NCHITTEST = 0x0084,&#160;&#160;&#160;&#160;NCPAINT = 0x0085,&#160;&#160;&#160;&#160;NCACTIVATE = 0x0086,&#160;&#160;&#160;&#160;GETDLGCODE = 0x0087,&#160;&#160;&#160;&#160;<br />SYNCPAINT = 0x0088,&#160;&#160;&#160;&#160;NCMOUSEMOVE = 0x00A0,&#160;&#160;&#160;&#160;NCLBUTTONDOWN = 0x00A1,&#160;&#160;&#160;&#160;NCLBUTTONUP = 0x00A2,&#160;&#160;&#160;&#160;<br />NCLBUTTONDBLCLK = 0x00A3,&#160;&#160;&#160;&#160;NCRBUTTONDOWN = 0x00A4,&#160;&#160;&#160;&#160;NCRBUTTONUP = 0x00A5,&#160;&#160;&#160;&#160;<br />NCRBUTTONDBLCLK = 0x00A6,&#160;&#160;&#160;&#160;NCMBUTTONDOWN = 0x00A7,&#160;&#160;&#160;&#160;NCMBUTTONUP = 0x00A8,&#160;&#160;&#160;&#160;<br />NCMBUTTONDBLCLK = 0x00A9,&#160;&#160;&#160;&#160;NCXBUTTONDOWN = 0x00AB,&#160;&#160;&#160;&#160;NCXBUTTONUP = 0x00AC,&#160;&#160;&#160;&#160;<br />NCXBUTTONDBLCLK = 0x00AD,&#160;&#160;&#160;&#160;INPUT_DEVICE_CHANGE = 0x00FE,&#160;&#160;&#160;&#160;<br />INPUT = 0x00FF,&#160;&#160;&#160;&#160;KEYFIRST = 0x0100,&#160;&#160;&#160;&#160;KEYDOWN = 0x0100,&#160;&#160;&#160;&#160;KEYUP = 0x0101,&#160;&#160;&#160;&#160;<br />CHAR = 0x0102,&#160;&#160;&#160;&#160;DEADCHAR = 0x0103,&#160;&#160;&#160;&#160;SYSKEYDOWN = 0x0104,&#160;&#160;&#160;&#160;SYSKEYUP = 0x0105,&#160;&#160;&#160;&#160;<br />SYSCHAR = 0x0106,&#160;&#160;&#160;&#160;SYSDEADCHAR = 0x0107,&#160;&#160;&#160;&#160;UNICHAR = 0x0109,&#160;&#160;&#160;&#160;KEYLAST = 0x0109,&#160;&#160;&#160;&#160;<br />IME_STARTCOMPOSITION = 0x010D,&#160;&#160;&#160;&#160;IME_ENDCOMPOSITION = 0x010E,&#160;&#160;&#160;&#160;IME_COMPOSITION = 0x010F,&#160;&#160;&#160;&#160;<br />IME_KEYLAST = 0x010F,&#160;&#160;&#160;&#160;INITDIALOG = 0x0110,&#160;&#160;&#160;&#160;COMMAND = 0x0111,&#160;&#160;&#160;&#160;SYSCOMMAND = 0x0112,&#160;&#160;&#160;&#160;<br />TIMER = 0x0113,&#160;&#160;&#160;&#160;HSCROLL = 0x0114,&#160;&#160;&#160;&#160;VSCROLL = 0x0115,&#160;&#160;&#160;&#160;INITMENU = 0x0116,&#160;&#160;&#160;&#160;<br />INITMENUPOPUP = 0x0117,&#160;&#160;&#160;&#160;MENUSELECT = 0x011F,&#160;&#160;&#160;&#160;MENUCHAR = 0x0120,&#160;&#160;&#160;&#160;<br />ENTERIDLE = 0x0121,&#160;&#160;&#160;&#160;MENURBUTTONUP = 0x0122,&#160;&#160;&#160;&#160;MENUDRAG = 0x0123,&#160;&#160;&#160;&#160;MENUGETOBJECT = 0x0124,&#160;&#160;&#160;&#160;<br />UNINITMENUPOPUP = 0x0125,&#160;&#160;&#160;&#160;MENUCOMMAND = 0x0126,&#160;&#160;&#160;&#160;CHANGEUISTATE = 0x0127,&#160;&#160;&#160;&#160;UPDATEUISTATE = 0x0128,<br />QUERYUISTATE = 0x0129,&#160;&#160;&#160;&#160;CTLCOLORMSGBOX = 0x0132,&#160;&#160;&#160;&#160;CTLCOLOREDIT = 0x0133,&#160;&#160;&#160;&#160;CTLCOLORLISTBOX = 0x0134,&#160;&#160;&#160;&#160;<br />CTLCOLORBTN = 0x0135,&#160;&#160;&#160;&#160;CTLCOLORDLG = 0x0136,&#160;&#160;&#160;&#160;CTLCOLORSCROLLBAR = 0x0137,&#160;&#160;&#160;&#160;CTLCOLORSTATIC = 0x0138,&#160;&#160;&#160;&#160;<br />MOUSEFIRST = 0x0200,&#160;&#160;&#160;&#160;MOUSEMOVE = 0x0200,&#160;&#160;&#160;&#160;LBUTTONDOWN = 0x0201,&#160;&#160;&#160;&#160;LBUTTONUP = 0x0202,&#160;&#160;&#160;&#160;<br />LBUTTONDBLCLK = 0x0203,&#160;&#160;&#160;&#160;RBUTTONDOWN = 0x0204,&#160;&#160;&#160;&#160;RBUTTONUP = 0x0205,&#160;&#160;&#160;&#160;RBUTTONDBLCLK = 0x0206,&#160;&#160;&#160;&#160;MBUTTONDOWN = 0x0207,&#160;&#160;&#160;&#160;<br />MBUTTONUP = 0x0208,&#160;&#160;&#160;&#160;MBUTTONDBLCLK = 0x0209,&#160;&#160;&#160;&#160;MOUSEWHEEL = 0x020A,&#160;&#160;&#160;&#160;XBUTTONDOWN = 0x020B,&#160;&#160;&#160;&#160;<br />XBUTTONUP = 0x020C,&#160;&#160;&#160;&#160;XBUTTONDBLCLK = 0x020D,&#160;&#160;&#160;&#160;MOUSEHWHEEL = 0x020E,&#160;&#160;&#160;&#160;MOUSELAST = 0x020E,&#160;&#160;&#160;&#160;<br />PARENTNOTIFY = 0x0210,&#160;&#160;&#160;&#160;ENTERMENULOOP = 0x0211,&#160;&#160;&#160;&#160;EXITMENULOOP = 0x0212,&#160;&#160;&#160;&#160;NEXTMENU = 0x0213,&#160;&#160;&#160;&#160;<br />SIZING = 0x0214,&#160;&#160;&#160;&#160;CAPTURECHANGED = 0x0215,&#160;&#160;&#160;&#160;MOVING = 0x0216,&#160;&#160;&#160;&#160;POWERBROADCAST = 0x0218,&#160;&#160;&#160;&#160;<br />DEVICECHANGE = 0x0219,&#160;&#160;&#160;&#160;MDICREATE = 0x0220,&#160;&#160;&#160;&#160;MDIDESTROY = 0x0221,&#160;&#160;&#160;&#160;MDIACTIVATE = 0x0222,&#160;&#160;&#160;&#160;<br />MDIRESTORE = 0x0223,&#160;&#160;&#160;&#160;MDINEXT = 0x0224,&#160;&#160;&#160;&#160;MDIMAXIMIZE = 0x0225,&#160;&#160;&#160;&#160;MDITILE = 0x0226,&#160;&#160;&#160;&#160;<br />MDICASCADE = 0x0227,&#160;&#160;&#160;&#160;MDIICONARRANGE = 0x0228,&#160;&#160;&#160;&#160;MDIGETACTIVE = 0x0229,&#160;&#160;&#160;&#160;MDISETMENU = 0x0230,&#160;&#160;&#160;&#160;<br />ENTERSIZEMOVE = 0x0231,&#160;&#160;&#160;&#160;EXITSIZEMOVE = 0x0232,&#160;&#160;&#160;&#160;DROPFILES = 0x0233,&#160;&#160;&#160;&#160;MDIREFRESHMENU = 0x0234,&#160;&#160;&#160;&#160;<br />IME_SETCONTEXT = 0x0281,&#160;&#160;&#160;&#160;IME_NOTIFY = 0x0282,&#160;&#160;&#160;&#160;IME_CONTROL = 0x0283,&#160;&#160;&#160;&#160;IME_COMPOSITIONFULL = 0x0284,&#160;&#160;&#160;&#160;<br />IME_SELECT = 0x0285,&#160;&#160;&#160;&#160;IME_CHAR = 0x0286,&#160;&#160;&#160;&#160;IME_REQUEST = 0x0288,&#160;&#160;&#160;&#160;IME_KEYDOWN = 0x0290,&#160;&#160;&#160;&#160;<br />IME_KEYUP = 0x0291,&#160;&#160;&#160;&#160;MOUSEHOVER = 0x02A1,&#160;&#160;&#160;&#160;MOUSELEAVE = 0x02A3,&#160;&#160;&#160;&#160;NCMOUSEHOVER = 0x02A0,&#160;&#160;&#160;&#160;<br />NCMOUSELEAVE = 0x02A2,&#160;&#160;&#160;&#160;WTSSESSION_CHANGE = 0x02B1,&#160;&#160;&#160;&#160;TABLET_FIRST = 0x02c0,&#160;&#160;&#160;&#160;TABLET_LAST = 0x02df,&#160;&#160;&#160;&#160;<br />CUT = 0x0300,&#160;&#160;&#160;&#160;COPY = 0x0301,&#160;&#160;&#160;&#160;PASTE = 0x0302,&#160;&#160;&#160;&#160;CLEAR = 0x0303,&#160;&#160;&#160;&#160;UNDO = 0x0304,&#160;&#160;&#160;&#160;RENDERFORMAT = 0x0305,&#160;&#160;&#160;&#160;<br />RENDERALLFORMATS = 0x0306,&#160;&#160;&#160;&#160;DESTROYCLIPBOARD = 0x0307,&#160;&#160;&#160;&#160;DRAWCLIPBOARD = 0x0308,&#160;&#160;&#160;&#160;PAINTCLIPBOARD = 0x0309,<br />VSCROLLCLIPBOARD = 0x030A,&#160;&#160;&#160;&#160;SIZECLIPBOARD = 0x030B,&#160;&#160;&#160;&#160;ASKCBFORMATNAME = 0x030C,&#160;&#160;&#160;&#160;CHANGECBCHAIN = 0x030D,&#160;&#160;&#160;&#160;<br />HSCROLLCLIPBOARD = 0x030E,&#160;&#160;&#160;&#160;QUERYNEWPALETTE = 0x030F,&#160;&#160;&#160;&#160;PALETTEISCHANGING = 0x0310,&#160;&#160;&#160;&#160;PALETTECHANGED = 0x0311,&#160;&#160;&#160;&#160;<br />HOTKEY = 0x0312,&#160;&#160;&#160;&#160;PRINT = 0x0317,&#160;&#160;&#160;&#160;PRINTCLIENT = 0x0318,&#160;&#160;&#160;&#160;APPCOMMAND = 0x0319,&#160;&#160;&#160;&#160;THEMECHANGED = 0x031A,&#160;&#160;&#160;&#160;<br />CLIPBOARDUPDATE = 0x031D,&#160;&#160;&#160;&#160;<br />DWMCOMPOSITIONCHANGED = 0x031E,&#160;&#160;&#160;&#160;DWMNCRENDERINGCHANGED = 0x031F,&#160;&#160;&#160;&#160;DWMCOLORIZATIONCOLORCHANGED = 0x0320,&#160;&#160;&#160;&#160;<br />DWMWINDOWMAXIMIZEDCHANGE = 0x0321,&#160;&#160;&#160;&#160;GETTITLEBARINFOEX = 0x033F,&#160;&#160;&#160;&#160;HANDHELDFIRST = 0x0358,&#160;&#160;&#160;&#160;<br />HANDHELDLAST = 0x035F,&#160;&#160;&#160;&#160;AFXFIRST = 0x0360,&#160;&#160;&#160;&#160;AFXLAST = 0x037F,&#160;&#160;&#160;&#160;PENWINFIRST = 0x0380,&#160;&#160;&#160;&#160;<br />PENWINLAST = 0x038F,&#160;&#160;&#160;&#160;APP = 0x8000,&#160;&#160;&#160;&#160;USER = 0x0400,&#160;&#160;&#160;&#160;CPL_LAUNCH = USER+0x1000,&#160;&#160;&#160;&#160;<br />CPL_LAUNCHED = USER+0x1001,&#160;&#160;&#160;&#160;SYSTIMER = 0x118&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;'@&#160;&#160;&#160;&#160;Add-Type $fontCSharpCode<br />#*******************************************************************&#160;&#160;&#160;&#160;<br /># Declare Functions&#160;&#160;&#160;&#160;#*******************************************************************&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;<br /># Function Get-SpecialFolder()&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Purpose: Convert a CSIDL string to a folder parh string&#160;&#160;&#160;&#160;<br />#&#160;&#160;&#160;&#160;# Input: $id CSIDL folder identifier string&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Returns: Folder path&#160;&#160;&#160;&#160;<br />#&#160;&#160;&#160;&#160;#*******************************************************************&#160;&#160;&#160;&#160;<br />function Get-SpecialFolder($id)&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;$shell = New-Object –COM "Shell.Application"&#160;&#160;&#160;&#160;<br />$folder = $shell.NameSpace($id)&#160;&#160;&#160;&#160;$specialFolder = $folder.Self.Path&#160;&#160;&#160;&#160;$specialFolder&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;# Function Add-SingleFont()&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;<br /># Purpose: Install a font file&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Input: $file Font file path&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Returns: 0 - success, 1 - failure&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;function Add-SingleFont($filePath)&#160;&#160;&#160;&#160;<br />{&#160;&#160;&#160;&#160;try&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;[string]$filePath = (resolve-path $filePath).path&#160;&#160;&#160;&#160;[string]$fileDir = split-path $filePath&#160;&#160;&#160;&#160;<br />[string]$fileName = split-path $filePath -leaf&#160;&#160;&#160;&#160;[string]$fileExt = (Get-Item $filePath).extension&#160;&#160;&#160;&#160;<br />[string]$fileBaseName = $fileName -replace($fileExt ,"")&#160;&#160;&#160;&#160;$shell = new-object -com shell.application&#160;&#160;&#160;&#160;<br />$myFolder = $shell.Namespace($fileDir)&#160;&#160;&#160;&#160;$fileobj = $myFolder.Items().Item($fileName)&#160;&#160;&#160;&#160;<br />$fontName = $myFolder.GetDetailsOf($fileobj,21)&#160;&#160;&#160;&#160;if ($fontName -eq "") { $fontName = $fileBaseName }&#160;&#160;&#160;&#160;copy-item $filePath -destination $fontsFolderPath&#160;&#160;&#160;&#160;<br />$fontFinalPath = Join-Path $fontsFolderPath $fileName&#160;&#160;&#160;&#160;$retVal = [FontResource.AddRemoveFonts]::AddFont($fontFinalPath)&#160;&#160;&#160;&#160;<br />if ($retVal -eq 0) {&#160;&#160;&#160;&#160;Write-Host "Font `'$($filePath)`'`' installation failed"&#160;&#160;&#160;&#160;Write-Host ""&#160;&#160;&#160;&#160;1&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;else&#160;&#160;&#160;&#160;<br />{&#160;&#160;&#160;&#160;Write-Host "Font `'$($filePath)`' installed successfully"&#160;&#160;&#160;&#160;Write-Host ""&#160;&#160;&#160;&#160;Set-ItemProperty -path "$($fontRegistryPath)"&#160;<br />-name "$($fontName)$($hashFontFileTypes.item($fileExt))" -value "$($fileName)" -type STRING&#160;&#160;&#160;&#160;0&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;""&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />catch&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;Write-Host "An error occured installing `'$($filePath)`'"&#160;&#160;&#160;&#160;Write-Host ""&#160;&#160;&#160;&#160;<br />Write-Host "$($error[0].ToString())"&#160;&#160;&#160;&#160;Write-Host ""&#160;&#160;&#160;&#160;$error.clear()&#160;&#160;&#160;&#160;1&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;<br /># Function Show-Usage()&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Purpose: Shows the correct usage to the user.&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;<br /># Input: None&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Output: Help messages are displayed on screen.&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;function Show-Usage()&#160;&#160;&#160;&#160;<br />{&#160;&#160;&#160;&#160;$usage = @'&#160;&#160;&#160;&#160;Add-Font.ps1&#160;&#160;&#160;&#160;This script is used to install Windows fonts.&#160;&#160;&#160;&#160;<br />Usage:&#160;&#160;&#160;&#160;Add-Font.ps1 -help | -path "&lt;Font file or folder path&gt;"&#160;&#160;&#160;&#160;Parameters:&#160;&#160;&#160;&#160;-help&#160;&#160;&#160;&#160;<br />Displays usage information.&#160;&#160;&#160;&#160;-path&#160;&#160;&#160;&#160;May be either the path to a font file to install or the path to a folder&#160;&#160;&#160;&#160;<br />containing font files to install. Valid file types are .fon, .fnt,&#160;&#160;&#160;&#160;.ttf,.ttc, .otf, .mmm, .pbf, and .pfm&#160;&#160;&#160;&#160;<br />Examples:&#160;&#160;&#160;&#160;Add-Font.ps1&#160;&#160;&#160;&#160;Add-Font.ps1 -path "C:\Custom Fonts\MyFont.ttf"&#160;&#160;&#160;&#160;Add-Font.ps1 -path&#160;<br />"C:\Custom Fonts"&#160;&#160;&#160;&#160;'@&#160;&#160;&#160;&#160;$usage&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;#*******************************************************************&#160;&#160;&#160;&#160;<br /># Function Process-Arguments()&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Purpose: To validate parameters and their values&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;<br /># Input: All parameters&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;# Output: Exit script if parameters are invalid&#160;&#160;&#160;&#160;#&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;function Process-Arguments()&#160;&#160;&#160;&#160;<br />{&#160;&#160;&#160;&#160;## Write-host 'Processing Arguments'&#160;&#160;&#160;&#160;if ($unnamedArgs.Length -gt 0)&#160;&#160;&#160;&#160;<br />{&#160;&#160;&#160;&#160;write-host "The following arguments are not defined:"&#160;&#160;&#160;&#160;$unnamedArgs&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />if ($help -eq $true)&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;Show-Usage&#160;&#160;&#160;&#160;break&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;if ((Test-Path $path -PathType Leaf) -eq $true)&#160;&#160;&#160;&#160;<br />{&#160;&#160;&#160;&#160;If ($hashFontFileTypes.ContainsKey((Get-Item $path).Extension))&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;$retVal = Add-SingleFont $path&#160;&#160;&#160;&#160;<br />if ($retVal -ne 0)&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;exit 1&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;else&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;exit 0&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;else&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;"`'$($path)`' not a valid font file type"&#160;&#160;&#160;&#160;""&#160;&#160;&#160;&#160;exit 1&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}<br />elseif ((Test-Path $path -PathType Container) -eq $true)&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;$bErrorOccured = $false&#160;&#160;&#160;&#160;foreach($file in (Get-Childitem $path))<br />{&#160;&#160;&#160;&#160;if ($hashFontFileTypes.ContainsKey($file.Extension))&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;$retVal = Add-SingleFont (Join-Path $path $file.Name)&#160;&#160;&#160;&#160;<br />if ($retVal -ne 0)&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;$bErrorOccured = $true&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;else&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;"`'$(Join-Path $path $file.Name)`' not a valid font file type"&#160;&#160;&#160;&#160;""&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}<br />If ($bErrorOccured -eq $true)&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;exit 1&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;else&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;exit 0&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;else&#160;&#160;&#160;&#160;{&#160;&#160;&#160;&#160;"`'$($path)`' not found"&#160;&#160;&#160;&#160;""&#160;&#160;&#160;&#160;exit 1&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;}&#160;&#160;&#160;&#160;<br />#*******************************************************************&#160;&#160;&#160;&#160;# Main Script&#160;&#160;&#160;&#160;<br />#*******************************************************************<br />$fontsFolderPath = Get-SpecialFolder($CSIDL_FONTS)&#160;&#160;&#160;&#160;Process-Arguments</code></pre></div></div>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Insert the folder path for the required fonts and click <b>Next</b>.</p>
                                    <p style="text-align: center;">
                                        <img alt="" height="559" src="../../../Resources/Images/LeastPrivilege/Elevate/467_7_img-5.png" width="732" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 6 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 6 – </b></span></span>Select <b>Once or when forced</b>  and click <b>Next </b>.</p>
                                    <p style="text-align: center;">
                                        <img alt="" height="559" src="../../../Resources/Images/LeastPrivilege/Elevate/467_9_img-6.png" width="733" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 7 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 7 – </b></span></span>Name the policy and click <b>Finish</b>.</p>
                                    <p style="text-align: center;">
                                        <img alt="" height="556" src="../../../Resources/Images/LeastPrivilege/Elevate/467_11_img-7.png" width="730" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 8 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 8 – </b></span></span>Run <code>GPUPDATE /FORCE</code> on theclient machine.</p>
                                    <ol>
                                        <li value="1">Create a GPO and link it to the required scope.</li>
                                        <li value="2">Create a PP Scripts Manager policy and click  <b>Next</b>.</li>
                                        <li value="3">Leave  <b>Apply this policy to computer (default)</b> checked and click  <b>Next</b>.<p>Select <b>PowerShell Script</b> from the drop-down and paste the script to install fonts.</p><p><img src="../../../Resources/Images/LeastPrivilege/Elevate/467_5_img-3.png" width="732" /></p></li>
                                        <li value="4">
                                            <p>This script to Add Fonts from PowerShell is acquired from Microsoft Doc website. For more information see the Microsoft article on <a href="https://learn.microsoft.com/en-us/archive/blogs/deploymentguys/adding-and-removing-fonts-with-windows-powershell" target="_blank" title="Adding and Removing Fonts with Windows PowerShell" alt="Adding and Removing Fonts with Windows PowerShell">Adding and Removing Fonts with Windows PowerShell</a>.</p>
                                        </li>
                                        <li value="5">
                                            <p>Insert the folder path for the required fonts and click <b>Next</b>.</p>
                                            <p>
                                                <img src="../../../Resources/Images/LeastPrivilege/Elevate/467_7_img-5.png" width="732" />
                                            </p>
                                        </li>
                                        <li value="6">
                                            <p>Select <b>Once or when forced</b> radio button and click <b>Next </b>.</p>
                                            <p>
                                                <img src="../../../Resources/Images/LeastPrivilege/Elevate/467_9_img-6.png" width="733" />
                                            </p>
                                        </li>
                                        <li value="7">
                                            <p>Name the policy and click <b>Finish</b>.</p>
                                            <p>
                                                <img src="../../../Resources/Images/LeastPrivilege/Elevate/467_11_img-7.png" width="730" />
                                            </p>
                                        </li>
                                        <li value="8">Run <code>GPUPDATE /FORCE</code> on the client machine.</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
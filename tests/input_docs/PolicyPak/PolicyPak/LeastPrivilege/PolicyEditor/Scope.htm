<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Netwrix_Website" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|Least Privilege Manager|[%=System.LinkedTitle%]|Tips for Admin Approval, Self Elevate, Apply on Demand, SecureCopy and UI Branding">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>How do I use the Filter section in Endpoint Privilege Manager ?</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>How do I use the Filter section in Endpoint Privilege Manager ?</h1>
                                    <p>The Scope filter section can be found in various rule types in <span class="mc-variable PolicyPak.Product_Long_Name variable">Netwrix Endpoint Policy Manager (formerly PolicyPak)</span> <span class="mc-variable PolicyPak.Least_Privilege_Manager_Short_Name variable">Least Privilege Manager</span>. For instance, it exists in every explicit rule, like this:</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_1_faq-img-01_950x578.png" style="width: 950;height: 578;" />
                                    </p>
                                    <p>And also in SecureRun™ rules like this:&#160;</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_2_faq-img-02_950x537.png" style="width: 950;height: 537;" />
                                    </p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>At  this time, Policy Scope rules are not yet available for:</p>
                                    <ul>
                                        <li>Global Settings Policy (to perform Discovery audits.)</li>
                                        <li>Admin Approval Policy</li>
                                    </ul>
                                    <p>These are coming soon.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>The Policy Scope option is only available when used on the Computer side; on the User side it is greyed out because this setting is only meant to express to the COMPUTER (system) how to work with User, and User and System Processes. On the User side, the processes are always in the context of the User.</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_3_faq-img-03_950x571.png" style="width: 950;height: 571;" />
                                    </p>
                                    <p>In this topic, we are going over various use cases when you might use the Policy Scope option (which again, will only be un-gray / valid on the Computer side.)</p>
                                    <h2>Scenario 1: Enhanced SecureRun / Prevent untrusted executables and scripts from running even by LOCAL SYSTEM.</h2>
                                    <p>When you apply SecureRun on the user or computer side, you're saying "Block all untrusted executables started by users." But this does not, by default,  block the attack vector of the System performing the attack. You can see the example below where the Standard User is blocked from an executable attempt, but System is still allowed.&#160;</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_4_faq-img-04_950x647.png" style="width: 950;height: 647;" />
                                    </p>
                                    <p>However, you can switch SecureRun on the computer side to now say "Block all untrusted executables started by users or LOCAL SYSTEM." You would do this on the Computer side, and specify User and System Processes, as shown below.</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_5_faq-img-05_950x547.png" style="width: 950;height: 547;" />
                                    </p>
                                    <p>The result is that both User and System attempts to run un-trusted executables will be prevented.</p>
                                    <p>When could this occur? </p>
                                    <ul>
                                        <li>
                                            <p>If a normal (user-level) process exploits a security vulnerability to escalate his own privileges and run some arbitrary code with higherprivileges (like LOCAL SYSTEM in this case).&#160;</p>
                                        </li>
                                        <li>
                                            <p>If malware launched software on a machine that runs as Local System and existed at <code>c:\anything\Program.exe</code> (like PSEXEC, other ransomware, etc.). In this case, it would be owned by the user (who is not on the SecureRun list.) However, if the malware executed the<code> c:\anything\Program.exe</code> as SYSTEM, this attack would be prevented, because the owner of the <code>c:\anything\Program.exe</code> is the User (as the attacker) but would not on the SecureRun list (even though the process is being run AS SYSTEM.)</p>
                                        </li>
                                    </ul>
                                    <p>This would strengthen security if a malware ended up using an elevated process to attempt to perform its work as LOCAL SYSTEM and tries to run an un-trusted file. Therefore, when the application (<code>.EXE</code>) or script, etc.,  was attempted to fire off, because the user isn't on the SecureRun trusted list, the attack attempt will fail.</p>
                                    <p>For a video demo of this scenario, see&#160;<a href="../../Video/LeastPrivilege/BestPractices/SecureRun/UserSystemExecutables.html" target="_blank" title="SecureRun to block User AND System executables" alt="SecureRun to block User AND System executables" class="MCXref xref">SecureRun to block User AND System executables</a></p>
                                    <h2>Scenario 2: Specific rule to block an app from being run, even as local System.</h2>
                                    <p>You might want to explicitly block attack vectors such as PSEXEC (which was used in WannaCry), or entirely block PowerShell.&#160; If you specify to do this only on the User side (or set Computer side scope to User processed only), then only user processes will be affected: </p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_6_faq-img-06_950x195.png" style="width: 950;height: 195;" />
                                    </p>
                                    <p>You can shore up this attack vector by making the explicit deny rule on the Computer side:</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_7_faq-img-07_950x381.png" style="width: 950;height: 381;" />
                                    </p>
                                    <p>When you do, &#160;this happens:</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_8_faq-img-08_950x183.png" style="width: 950;height: 183;" />
                                    </p>
                                    <h3>Scenario 2B: Block Powershell.exe completely, but allow Local System to run a specific .PS1 script</h3>
                                    <p>In the previous example, we blocked Powershell (or PSEXEC, etc.) from all user and system processes.</p>
                                    <p>However, you might need to run some Powershell scripts as SYSTEM to perform some maintenance tasks.&#160; Since PowerShell is now being blocked for all Computer side processes, you cannot run a specific script with PowerShel:</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_9_faq-img-09_950x271.png" style="width: 950;height: 271;" />
                                    </p>
                                    <p>To enable this, simply add another rule to ALLOW AND LOG, for example, <code>C:\SCRIPTS\ITSCRIPT1.ps1</code>, and set the scope to User and System processes, but use the scope Filter to SYSTEM.</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_10_faq-img-10_950x453.png" style="width: 950;height: 453;" />
                                    </p>
                                    <p>Result:</p>
                                    <p>
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_11_faq-img-11_950x375.png" style="width: 950;height: 375;" />
                                    </p>
                                    <p>For more information on this issue, see &#160;<a href="../../Video/LeastPrivilege/BestPractices/PowerShellBlock.html" target="_blank" title="Block PowerShell in General, Open up for specific items" alt="Block PowerShell in General, Open up for specific items" class="MCXref xref">Block PowerShell in General, Open up for specific items</a></p>
                                    <h2>Scenario 3: Running or Elevating applications or installers, but blocking other admins from running them.</h2>
                                    <p>In this scenario you want to do work with <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> <span class="mc-variable PolicyPak.Least_Privilege_Manager_Short_Name variable">Least Privilege Manager</span> (Elevate, Allow, or Block) but prevent other admins (local admins or domain admins) from overcoming your rule.</p>
                                    <p>To perform this, you'll need to apply these two rules:</p>
                                    <p>1. First one BLOCKS <code>ABC.EXE</code> or <code>ABC.CMD</code> or <code>ABC.MSI</code>. This must be done on the COMPUTER side with SCOPE = USER AND SYSTEM. Then, filter the scope by group (more on this in a second.) </p>
                                    <p>2. Second rule ALLOWS or ELEVATES <code>ABC.EXE</code> or <code>ABC.CMD</code> or <code>ABC.MSI</code>. The scope doesn't matter. You can do this on the COMPUTER or USER side. (leaving the default filters in place.)</p>
                                    <p>If you want toblock only LOCAL admins (but not domain admins) then Rule #1 needs to look like this. (Note that this group is not available when editing a GPO from a DC, and only available when creating the GPO from a Windows 10 computer):</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_12_faq-img-12_950x482.png" style="width: 950;height: 482;" />
                                    </p>
                                    <p>If you want toblock both local admins and domain administrators, then Rule #1 needs to look like this. </p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_13_faq-img-13_950x534.png" style="width: 950;height: 534;" />
                                    </p>
                                    <p class="Remember" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;i&gt;Remember, &lt;/i&gt;&lt;/span&gt;"><span class="autonumber"><span class="Remember"><span style="color: #fb8000;" class="mcFormatColor"><i>Remember, </i></span></span></span>rule 2, the rule that does the ELEVATE or ALLOW, is just a standard rule, and can be done on the user or computer side, like this:</p>
                                    <p style="text-align: center;">
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_14_faq-img-14_950x458.png" style="width: 950;height: 458;" />
                                    </p>
                                    <p>video 3:&#160;<a href="../../Video/LeastPrivilege/BestPractices/AppBlock.html" class="MCXref xref">Elevate apps as standard user, BLOCK other Admins</a></p>
                                    <h2>Scenario 4:&#160; Elevating a Service account</h2>
                                    <p>You might have a service which requires specific privileges. Maybe your service, by default, uses Local System, and you want to give it less rights.</p>
                                    <p>With <span class="mc-variable PolicyPak.Product_Short_Name variable">Endpoint Policy Manager</span> <span class="mc-variable PolicyPak.Least_Privilege_Manager_Short_Name variable">Least Privilege Manager</span>, you can remove the powerful privileges of the service account and strip out LOCAL SYSTEM and grant a specific user the permissions required.</p>
                                    <p>If you want a process to be run via special user account, follow these steps you would need to do the following:</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>Make a rule for an <code>.exe</code> from which the service runs.</p>
                                    <p>We recommend to make a File Info + Signature rule, but PATH rules would work as well.</p>
                                    <p>e.g. <code>C:\Program Files\AppABC \AppService.exe</code></p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>On the Actions page select "Run with custom token" and configure the TOKEN and/or exact PRIVILEGES the process needs like Load Driver Privilege (SeLoadDriverPrivilege), Bypass Traverse Checking (SeChangeNotify).</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>On the final page select Scope = User and System Processes</p>
                                    <p>AND</p>
                                    <p>Scope Filter should be trimmed to the specific account you specified to run the service runs as.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>It's also possible to use Scope Filter = SERVICES to make the rule apply to all services that run from the specified <code>.exe </code>regardless of the user.</p>
                                    <p>
                                        <img alt="" src="../../../Resources/Images/LeastPrivilege/PolicyEditor/319_15_faq-img-15_950x467.png" style="width: 950;height: 467;" />
                                    </p>
                                    <p>video: <a href="../../Video/LeastPrivilege/BestPractices/ServiceAccountRights.html" class="MCXref xref">Reduce or specify Service Account Rights</a></p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_Stealthbits_WebsiteSkin" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="Sb-print" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Directory Manager&#160;Management Shell</title>
        <link href="../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../Introduction.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Directory Manager&#160;Management Shell</h1>
                                    <p><span class="mc-variable GroupID.Product variable">Directory Manager</span> Management Shell is a command-line interface for managing objects like users, contacts, mailboxes, groups, smart groups, dynasties and for performing other administrative tasks in an Active Directory and <span class="mc-variable GroupID.Azure_AD variable">Microsoft Entra ID</span> based identity stores.</p>
                                    <p>Built with PowerShell Core technology, <span class="mc-variable GroupID.Product variable">Directory Manager</span> Management Shell provides a platform to perform many of the tasks you can perform with <span class="mc-variable GroupID.Product variable">Directory Manager</span> as well as tasks that the console does not support.</p>
                                    <p>This documentation is a reference for the <span class="mc-variable GroupID.Product variable">Directory Manager</span> PowerShell commands. It provides detail on their function, syntax, parameters, and gives ready-to-use examples that you can modify and test in your own environment.</p>
                                    <p>The documentation is intended for advanced users familiar with the use of the Windows Command prompt and PowerShell Core. </p>
                                    <h2>Identity Store-based Model</h2>
                                    <p><span class="mc-variable GroupID.Product variable">Directory Manager</span> <span class="mc-variable GroupID.Version variable">11.1</span> has extensible identity store based model. It supports the following data stores for creating an identity store:</p>
                                    <ul>
                                        <li xmlns="http://www.w3.org/1999/xhtml">
                                            <p>Active Directory</p>
                                        </li>
                                        <li xmlns="http://www.w3.org/1999/xhtml">
                                            <p xmlns="http://www.w3.org/1999/xhtml"><span class="mc-variable GroupID.Azure_AD variable" xmlns="">Microsoft Entra ID</span>
                                            </p>
                                        </li>
                                        <li xmlns="http://www.w3.org/1999/xhtml">
                                            <p>Generic LDAP</p>
                                        </li>
                                        <li xmlns="http://www.w3.org/1999/xhtml">
                                            <p>Google Workspace</p>
                                        </li>
                                    </ul>
                                    <p class="Note-1" data-mc-autonum="NOTE: "><span class="autonumber"><span class="Note-1">NOTE: </span></span>The commandlets covered in this section are for Active Directory and <span class="mc-variable GroupID.Azure_AD variable">Microsoft Entra ID</span> based identity stores.</p>
                                    <h2>Access Directory Manager Management Shell </h2>
                                    <p>Before using <span class="mc-variable GroupID.Product variable">Directory Manager</span> Management&#160;Shell, you must connect it to an identity store. </p>
                                    <p>Follow the steps to access Management Shell.</p>
                                    <p class="Step" data-mc-autonum="Step 1 – "><span class="autonumber"><span class="Step">Step 1 – </span></span>On the Windows Start menu, search for <b><span class="mc-variable GroupID.Product variable">Directory Manager</span>Management Shell <span class="mc-variable GroupID.Version variable">11.1</span></b>. Click it to launch <span class="mc-variable GroupID.Product variable">Directory Manager</span> Management Shell <span class="mc-variable GroupID.Version variable">11.1</span>.</p>
                                    <p class="Step" data-mc-autonum="Step 2 – "><span class="autonumber"><span class="Step">Step 2 – </span></span>On the Netwrix <span class="mc-variable GroupID.CompanyName variable">Netwrix</span> <span class="mc-variable GroupID.Product variable">Directory Manager</span> Authenticate page, select an identity store to connect to.</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/GroupID/ManagementShell/Login.jpg" title="Login page" alt="Login page" style="width: 378px;height: 400px;" />
                                    </p>
                                    <p class="Note-1" data-mc-autonum="NOTE: "><span class="autonumber"><span class="Note-1">NOTE: </span></span>If your required identity store is not listed, contact the <span class="mc-variable GroupID.Product variable">Directory Manager</span> administrator.</p>
                                    <p class="Step" data-mc-autonum="Step 3 – "><span class="autonumber"><span class="Step">Step 3 – </span></span>In the <b>Username</b> and <b>Password</b> boxes, provide the user name and password of your identity store account and click <b>Sign In</b>.</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/GroupID/Portal/Login-2.jpg" title="Login page" alt="Login page" style="width: 396px;height: 510px;" />
                                    </p>
                                    <p class="Note-1" data-mc-autonum="NOTE: "><span class="autonumber"><span class="Note-1">NOTE: </span></span>Click the <b xmlns="http://www.w3.org/1999/xhtml">Edit</b> icon  if you want to select another identity store to connect to.</p>
                                    <p> The Management Shell window appears as follows:</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/GroupID/ManagementShell/Shell.jpg" title="GroupID Management Shell 11.0" alt="GroupID Management Shell 11.0" style="width: 60%;height: auto;" />
                                    </p>
                                    <p>It displays information about the connected identity store.</p>
                                    <p>You can now run <span class="mc-variable GroupID.Product variable">Directory Manager</span> Management Shell commandlets.</p>
                                    <h2>Connect Directory Manager Management Shell Remotely</h2>
                                    <p>To enable remoting on a <span class="mc-variable GroupID.Product variable">Directory Manager</span> machine, the remote machine must have one of the following Operating Systems:</p>
                                    <ul>
                                        <li>
                                            <p>Windows Server 2016 or 2019 or 2022</p>
                                        </li>
                                        <li>
                                            <p>Windows Server Nano (1809 or higher)</p>
                                        </li>
                                        <li>
                                            <p>Windows 11</p>
                                        </li>
                                        <li>
                                            <p>Windows 10 1607+</p>
                                        </li>
                                    </ul>
                                    <p>Windows network location of that machine must be Domain or Private ("Home" or "Work"). If the network location is Public, <span class="mc-variable GroupID.Product variable">Directory Manager</span> Management Shell cannot create the required firewall exception for WS-Management Communication.</p>
                                    <p>The Windows Management Shell remoting features are supported by the WS-Management protocol and the Windows Remote Management (WinRM) service that implements WS-Management in Windows.</p>
                                    <p>Also make sure the following is available at the remote machine:</p>
                                    <ul>
                                        <li>
                                            <p>Windows Powershell 7.4.6</p>
                                        </li>
                                        <li>
                                            <p>Windows Remote Management 2.0</p>
                                        </li>
                                    </ul>
                                    <p>Follow the steps to enable remoting on a <span class="mc-variable GroupID.Product variable">Directory Manager</span> machine.</p>
                                    <p class="Step-Reset" data-mc-autonum="Step 1 – "><span class="autonumber"><span class="Step">Step 1 – </span></span>Click <b>Start &gt; Windows Powershell</b>. Right-click Windows PowerShell and select <b>Run as administrator</b>.</p>
                                    <p class="Step" data-mc-autonum="Step 2 – "><span class="autonumber"><span class="Step">Step 2 – </span></span>At the command prompt, type:
                </p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PowerShell;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><span style="color: #a71d5d; font-weight: bold; ">enable-psremoting</span></code></pre>
                                        </div>
                                    </div>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/GroupID/ManagementShell/PowershellWindow.jpg" />
                                    </p>
                                    <p class="Note-1" data-mc-autonum="NOTE: "><span class="autonumber"><span class="Note-1">NOTE: </span></span>By default, on Windows Server 2016, Windows PowerShell remoting is enabled. Use this command to re-enable remoting on Windows Server 2016 if it becomes disabled.</p>
                                    <p>You have to run this command only one time on each computer that will receive commands. You do not have to run it on computers that only send commands. Because the configuration starts listeners, it is prudent to run it only where it is needed.</p>
                                    <p>To verify that remoting is configured correctly, run a test command:</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PowerShell;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><span style="color: #a71d5d; font-weight: bold; ">new-PSSession</span> –ComputerName &lt;computer name&gt;</code></pre>
                                        </div>
                                    </div>
                                    <p>This command creates a remote session on the local computer and returns an object that represents the session. The output should look as shown in the following snapshot:</p>
                                    <p style="text-align: center;">
                                        <img src="../../Resources/Images/GroupID/ManagementShell/PSSessionCommand.png" title="Management Shell Remote session" alt="Management Shell Remote session" />
                                    </p>
                                    <h3>Access Directory Manager Management Shell Remotely</h3>
                                    <p>Log on to the machine through which you want to remotely access the <span class="mc-variable GroupID.Product variable">Directory Manager</span> Management Shell and perform the following steps:</p>
                                    <p class="Step-Reset" data-mc-autonum="Step 1 – "><span class="autonumber"><span class="Step">Step 1 – </span></span>Right-click <b>Start &gt; PowerShell 7.4.6 </b> using the <b>Run as Administrator</b> command to open it with Administrator privileges.</p>
                                    <p class="Step" data-mc-autonum="Step 2 – "><span class="autonumber"><span class="Step">Step 2 – </span></span>At the prompt, type the following script. It will display the new session created for the remote machine.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PowerShell;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><span style="font-weight: bold; ">$username</span> = <span style="color: #df5000; ">"domain\username"</span><br /><span style="font-weight: bold; ">$pass</span> = <span style="color: #a71d5d; font-weight: bold; ">ConvertTo-SecureString</span> <span style="color: #df5000; ">"user password"</span> -AsPlainText -Force<br /><span style="font-weight: bold; ">$Cred</span> = <span style="color: #a71d5d; font-weight: bold; ">New-Object</span> System.Management.Automation.PSCredential (<span style="font-weight: bold; ">$username</span>, <span style="font-weight: bold; ">$pass</span>)<br /><span style="font-weight: bold; ">$s</span> = <span style="color: #a71d5d; font-weight: bold; ">New-PSSession</span> -ComputerName <span style="color: #df5000; ">"machine name"</span> -Credential <span style="font-weight: bold; ">$Cred</span> -ConfigurationName PowerShell<span style="color: #333333; ">.7</span><br /><span style="color: #a71d5d; font-weight: bold; ">Invoke-Command</span> -Session <span style="font-weight: bold; ">$s</span> -ScriptBlock {<span style="font-weight: bold; ">$srcu</span> = [reflection.assembly]::LoadFrom(<span style="color: #df5000; ">'C:\Program Files\PowerShell\7\System.Windows.Forms.dll'</span>); <span style="font-weight: bold; ">$OnAssemblyResolve</span> = [System.ResolveEventHandler] { <span style="color: #a71d5d; font-weight: bold; ">param</span>(<span style="font-weight: bold; ">$sender</span>, <span style="font-weight: bold; ">$e</span>) <span style="color: #a71d5d; font-weight: bold; ">if</span> (<span style="font-weight: bold; ">$e</span>.Name <span style="color: #795da3; ">-like</span> <span style="color: #df5000; ">"System.Windows.Forms, Version=*"</span>) { <span style="color: #a71d5d; ">return</span> <span style="font-weight: bold; ">$srcu</span> }<span style="color: #a71d5d; ">return</span> <span style="font-weight: bold; ">$null</span>;};[System.AppDomain]::CurrentDomain.add_AssemblyResolve(<span style="font-weight: bold; ">$OnAssemblyResolve</span>);<span style="font-weight: bold; ">$reg</span>=<span style="color: #a71d5d; font-weight: bold; ">Get-ItemProperty</span> -Path HKLM:SOFTWARE\Microsoft\PowerShell\<span style="color: #333333; ">1</span>\PowerShellSnapIns\Imanami.Groups.Management.PowerShell.Admin11; <span style="font-weight: bold; ">$appbase</span>=<span style="font-weight: bold; ">$reg</span>.ApplicationBase;<span style="color: #a71d5d; font-weight: bold; ">Import-Module</span> -Name <span style="font-weight: bold; ">$appbase</span>\GroupIDManagementShell\bin\Imanami.GroupID.Management.dll;<span style="color: #a71d5d; font-weight: bold; ">Set-ModulePath</span> -ModulePath <span style="font-weight: bold; ">$appbase</span>\GroupIDManagementShell\bin}<br /><span style="color: #a71d5d; font-weight: bold; ">Import-PSSession</span> -Session <span style="font-weight: bold; ">$s</span> -Type cmdlet -AllowClobber<br /><span style="color: #a71d5d; font-weight: bold; ">Connect-IdentityStore</span> -mode <span style="color: #df5000; ">"2"</span> -IdentityStoreID <span style="color: #df5000; ">"identity store id"</span> -Credential <span style="font-weight: bold; ">$Cred</span></code></pre>
                                        </div>
                                    </div>
                                    <p>Following line of the above script connects the current user to the identity store (<i>having ID 1</i>).</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: PowerShell;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><span style="color: #a71d5d; font-weight: bold; ">Connect-IdentityStore</span> -mode <span style="color: #df5000; ">"2"</span> -IdentityStoreID <span style="color: #df5000; ">"1"</span> -Credential <span style="font-weight: bold; ">$Cred</span></code></pre>
                                        </div>
                                    </div>
                                    <p>Follow the steps to get the identity store ID from <span class="mc-variable GroupID.Product variable">Directory Manager</span> SQL database in which the desired identity store exists:</p>
                                    <ol>
                                        <li value="1">
                                            <p>Login to SQL server (having <span class="mc-variable GroupID.Product variable">Directory Manager</span> database) with account having read permissions.</p>
                                        </li>
                                        <li value="2">
                                            <p>View the table “Svc.Identitystore” top 100 rows. See the following snapshot for details:</p>
                                            <p style="text-align: center;">
                                                <img src="../../Resources/Images/GroupID/ManagementShell/GroupIDDatabase.jpg" />
                                            </p>
                                        </li>
                                    </ol>
                                    <p>Once the script has run, a remote session will be created. You can now run all <span class="mc-variable GroupID.Product variable">Directory Manager</span> cmdlets through PowerShell 7.4.6 without the need of signing into the <span class="mc-variable GroupID.Product variable">Directory Manager</span> server.</p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html d1p1:tocPath="Portal|Synchronize" d1p1:medium="Sb-print" d1p1:InPreviewMode="false" d1p1:PreloadImages="false" d1p1:TargetType="WebHelp2" class="_Skins_Stealthbits_WebsiteSkin" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-runtime-file-type="Default;Topic" xmlns:d1p1="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta name="msapplication-config" content="../../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" />
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" d1p1:generated="True" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="generator" content="Adobe RoboHelp 2019" /><title>Script</title>
        <link href="../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="complementary" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="Main navigation and search" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../Introduction.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Script</h1>
                                    <p>Synchronize scripts are written in Visual Basic .NET. A script is run after having established a current source row (”object”). The script determines a single value--the ”result” value--and assigns that value to the keyword <b>DTM.Result</b>.</p>
                                    <p>The type of script determines the nature of the script result:</p>
                                    <ul>
                                        <li>
                                            <p><b>Transform scripts:</b> the script result is the value of a destination field.</p>
                                        </li>
                                        <li>
                                            <p><b>Container scripts:</b> the script result is the distinguished name of a parent container.</p>
                                        </li>
                                    </ul>
                                    <h2>Examples and Language Overview</h2>
                                    <ul>
                                        <li>
                                            <p>For examples of transform scripts, see the <a href="SampleTransformScript.htm" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="MCXref xref">Sample Transform Scripts</a> topic</p>
                                        </li>
                                        <li>
                                            <p>For examples of container scripts, see the <a href="SampleContainerScript.htm" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="MCXref xref">Sample Container Scripts</a> topic</p>
                                        </li>
                                        <li>
                                            <p>For general information, see <a href="VisualBasicNetBasic.htm" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="MCXref xref">Visual Basic .NET for Directory Manager (formerly GroupID)</a> topic</p>
                                        </li>
                                        <li>
                                            <p>For general information, see Python for GroupID topic</p>
                                        </li>
                                    </ul>
                                    <h2>DTM keywords</h2>
                                    <p>DTM keywords give you access to the data being processed.</p>
                                    <ul>
                                        <li>
                                            <p>DTM.Source(<b>&lt;fieldname&gt;</b>)</p>
                                            <p>This function has a single string argument: field name. DTM.Source returns the value of the specified field (or "attribute") for the current row  ("object")
        in the source data.</p>
                                        </li>
                                        <li>
                                            <p>DTM.Result</p>
                                            <p>This is a write-only property. This script must assign a value to DTM.Result. This type of script determines what the value signifies.</p>
                                            <ul style="list-style-type: circle;">
                                                <li>
                                                    <p>Transform script – assign to DTM.Result the desired value of the transform’s destination field.</p>
                                                </li>
                                                <li>
                                                    <p>Container script – assign to DTM.Result the distinguished name of the new object’s container.</p>
                                                </li>
                                            </ul>
                                            <p>In any script, each branch of execution must assign a value to DTM.Result. Failure to assign a value to DTM.Result causes a runtime error, and the destination row ("object") is not updated or
        created . The job still runs to completion.</p>
                                        </li>
                                        <li>
                                            <p>DTM.ExpandVariables(<b>&lt;text&gt;</b>)</p>
                                            <p>This function has a single string argument: text. It returns the valueof the specified text as a string after replacing each environment variable embedded in the text
        with its string equivalent. Environment variables are surrounded by "%" characters, as in "%now%" and "%SystemDrive%".</p>
                                        </li>
                                        <li>
                                            <p>DTM.CancelRow()</p>
                                            <p>This subroutine contains no arguments. The current destination row ("object") is not updated or created. DTM.CancelRow provides a way to bypass certain objects based on their attributes. (In general, using a filter
        query for this purpose gives better performance.)</p>
                                        </li>
                                        <li>
                                            <p>DTM.AddToContext(&lt;<b>Key</b>&gt;,&lt;<b>Value</b>&gt;)</p>
                                            <p>This function has two arguments: Key and Value. When data is to be shared across segments of code in different editors
        supported by the Synchronize job wizard, it needs to be placed in the Context. This practice prevents errors and exceptions.</p>
                                        </li>
                                        <li>
                                            <p>DTM.Context(&lt;<b>Key</b>&gt;)</p>
                                            <p>This property has a single argument: Key. An object that has been added to the Context is retrieved by passing its key (identity) to this property.</p>
                                        </li>
                                    </ul>
                                    <h2>Context</h2>
                                    <p>The Context plays a central role in the Synchronize job model. In a Synchronize job, assemblies for Synchronize PowerTools and other third-party libraries can only be referenced in the Global Script Editor, therefore, manipulating objects of these
      libraries in other code segments in a job is only possible by adding them to the Context.</p>
                                    <p>The Context is an implementation of the .NET Hashtable collection, which is an in-memory data structure that stores and retrieves objects using key/value pairs. The DTM object in the Synchronize job model provides two members, AddToContext and Context,
      for adding and retrieving objects from the Context. To learn more about these two members, please see the previous section on DTM keywords.</p>
                                    <p>Although a Context makes it possible to share objects added to it across different code segments of a Synchronize job, it is not possible to test code for each segment individually without actually running the job. For this reason, you may encounter
      one of the following situations:</p>
                                    <ul>
                                        <li>
                                            <p>You receive an exception when trying to compile the code in the Script Editor, stating that the object reference is not found.</p>
                                        </li>
                                        <li>
                                            <p>Testing your script using the built-in Script Tester with random data does not provide the expected results, even though the code handles the exception and checks are placed for null object references.</p>
                                        </li>
                                    </ul>
                                    <h2>Scripting restrictions enforced by Synchronize</h2>
                                    <p>Behind the scenes, Synchronize inserts each script into the body of a subroutine before compiling. Therefore, any Visual Basic .NET constructs that are only valid outside of a subroutine/function will fail to compile and will be disallowed.</p>
                                    <p>These restrictions apply to creating a Synchronize script:</p>
                                    <ul>
                                        <li>
                                            <p>Subroutines, functions, classes, modules, and namespaces are not allowed.</p>
                                        </li>
                                        <li>
                                            <p>Module-level statements, such as Import or Option statements, are not permitted.</p>
                                        </li>
                                        <li>
                                            <p>Shared (that is, static, and global) variables are not supported.</p>
                                        </li>
                                    </ul>
                                    <h2>Visual Basic options set by Synchronize</h2>
                                    <p>Synchronize establishes the following Option statements which apply to all scripts and cannot be overridden:</p>
                                    <ul>
                                        <li>
                                            <p>Option Explicit On – all variables must be declared before use via a Dim statement. With Visual Basic .Net, it is possible to both declare and assign variables at their first use, as follows:</p>
                                            <div xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="codeSnippet">
                                                <div style="mc-code-lang: SQL;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>Dim MyVariable <span style="color: #0086b3; ">=</span> <span style="color: #df5000; ">"Hello"</span></code></pre>
                                                </div>
                                            </div>
                                            <div xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="codeSnippet">
                                                <div style="mc-code-lang: SQL;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>Dim MyObject <span style="color: #0086b3; ">=</span> <span style="color: #a71d5d; ">New</span> <span style="color: #a71d5d; ">Object</span>()</code></pre>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <p>Option Strict Off – data types do not need to be declared for each variable. Conversions between types, when possible, are performed implicitly. (By declaring data types, unnecessary conversions can be avoided, and performance improved).</p>
                                        </li>
                                    </ul>
                                    <h2>.Net assembly references</h2>
                                    <p>Synchronize establishes certain system assembly references before compiling your scripts. These references apply to all scripts and cannot be overridden.</p>
                                    <p>These references are:</p>
                                    <ul>
                                        <li>
                                            <p>MsCorLib.dll</p>
                                        </li>
                                        <li>
                                            <p>System.dll</p>
                                        </li>
                                        <li>
                                            <p>System.Data.dll</p>
                                        </li>
                                        <li>
                                            <p>System.Xml.dll</p>
                                        </li>
                                    </ul>
                                    <p>System.DirectoryServices, in particular, is ”off-limits” to your scripts so as to prevent direct access to Active Directory and other LDAP identity providers. This restriction is desirable, as it prevents your script from acting in conflict with Synchronize,
      which, after all, has ultimate responsibility for updating these providers.</p>
                                    <h2>.Net Namespaces</h2>
                                    <p>Synchronize imports certain namespaces when compiling your scripts. These imports apply to all scripts and cannot be overridden.</p>
                                    <p>These imports are:</p>
                                    <ul>
                                        <li>
                                            <p>Imports System</p>
                                        </li>
                                        <li>
                                            <p>Imports System.Text</p>
                                        </li>
                                        <li>
                                            <p>Imports System.Text.RegularExpressions</p>
                                        </li>
                                        <li>
                                            <p>Imports System.IO</p>
                                        </li>
                                        <li>
                                            <p>Imports System.Math</p>
                                        </li>
                                    </ul>
                                    <p>.Net namespaces other than those listed here can still be accessed by specifying the fully-qualified namespace. For example, a DataSet (which belongs to the System.Data namespace) can be read from a file as follows:</p>
                                    <div xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="codeSnippet">
                                        <div style="mc-code-lang: SQL;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>&#160;Dim ds <span style="color: #0086b3; ">=</span> <span style="color: #a71d5d; ">New</span> <span style="color: #a71d5d; ">System</span>.<span style="color: #a71d5d; ">Data</span>.DataSet()<span style="color: #0086b3; ">&lt;</span>br xmlns<span style="color: #0086b3; ">=</span><span style="color: #df5000; ">"http://www.w3.org/1999/xhtml"</span> <span style="color: #0086b3; ">/&gt;</span> ds.ReadXml(<span style="color: #df5000; ">"C:\Temp\MyFile.xml"</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
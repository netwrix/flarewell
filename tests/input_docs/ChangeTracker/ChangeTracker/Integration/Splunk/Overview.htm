<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="_Skins_CSH_NPR_Skin" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="print" data-mc-toc-path="[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" /><title>Splunk</title>
        <link href="../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../Overview.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <h1>Splunk</h1>
                                    <p>Splunk is used to store logs from devices, databases and applications. Capturing changes to device configuration, from logs in Splunk, provides a form of agentless monitoring with the ability to monitor devices that are not currently supported by Change Tracker. This means anything that can reliably log it's configuration changes to Splunk can be monitored by Change Tracker, including custom applications.</p>
                                    <p>A fully customizable Search Processing Language (SPL) query, executed via the Splunk API, will return specific logs that are converted to change events in Change Tracker. From this point on, these change events will behave as if they were produced by a traditional agent.</p>
                                    <p>Permissions required for the Splunk can be found in the Authentication and Authorization section of the Splunk Documentation page. See Splunk's <a href="https://docs.splunk.com/Documentation/Splunk/9.3.2/RESTUM/RESTusing#:~:text=Splunk users must have role%2cAccess controls and click Users" target="_blank" title="REST API User Manual" alt="REST API User Manual">REST API User Manual</a> article for additional information on permissions.</p>
                                    <h2>Configure Credentials</h2>
                                    <p> Follow the steps to configure Splunk credentials.</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>From the Settings menu select <b>Credentials</b> and scroll to the Splunk Credentials section.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/SplunkCredentials.png" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Click the <b>Add</b> button and enter the details of the Splunk instance to connect to.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Click <b>Update</b>.</p>
                                    <p>The Splunk credentials are updated.</p>
                                    <h2>Policy Templates</h2>
                                    <p>Policy templates are used to configure what to monitor on the target devices. For Splunk a policy template that defines an SPL query is required. Splunk's SPL query language is similar to SQL in that it is very flexible when defining the data to query, how to filter it and what transformations are required like column aliases. </p>
                                    <h3>Create an SPL Query</h3>
                                    <p class="Recommended-1" data-mc-autonum="&lt;span style=&quot;color: #fb8000;&quot; class=&quot;mcFormatColor&quot;&gt;&lt;b&gt;&lt;i&gt;RECOMMENDED: &lt;/i&gt;&lt;/b&gt;&lt;/span&gt;"><span class="autonumber"><span class="Recommended"><span style="color: #fb8000;" class="mcFormatColor"><b><i>RECOMMENDED: </i></b></span></span></span>It is recommended to develop and test the SPL query in Splunk's Search page.</p>
                                    <p>The query must return fields with the following aliases:</p>
                                    <ul>
                                        <li>
                                            <p>device</p>
                                        </li>
                                        <li>
                                            <p>whomadethechange</p>
                                        </li>
                                        <li>
                                            <p>eventdate</p>
                                        </li>
                                        <li>
                                            <p>eventinfo</p>
                                        </li>
                                    </ul>
                                    <p>The value in the eventdate field must be formatted as YYYY-mm-ddTHH:MM:SS. The strftime function can be used to format date time fields accordingly: strftime(MyDateTimeField,"%Y-%m-%dT%H:%M:%S.%Q").</p>
                                    <p>Any further fields added will be included in the body of the events when the reach Change Tracker. Sourcetype is an example of such a field in the test query below.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/SplunkSearch.png" />
                                    </p>
                                    <p>Below is the test query used in this document. This query pulls internal Splunk data that any instance will have while meeting Change Tracker's requirements. The "head 50" clause at the end of the statement ensures that only 50 rows are returned.</p>
                                    <div class="codeSnippet">
                                        <div style="mc-code-lang: SQL;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><span style="color: #a71d5d; ">search</span> <span style="color: #a71d5d; ">index</span><span style="color: #0086b3; ">=</span>_internal event_message <span style="color: #0086b3; ">!=</span> <span style="color: #df5000; ">""</span>&#160;&#160;<span style="color: #0086b3; ">|</span> <span style="color: #a71d5d; ">rename</span> <span style="color: #a71d5d; ">host</span> <span style="color: #a71d5d; ">as</span> device <span style="color: #0086b3; ">|</span> eval&#160;&#160;whomadethechange <span style="color: #0086b3; ">=</span> <span style="color: #df5000; ">"test-user"</span> <span style="color: #0086b3; ">|</span> eval eventdate<span style="color: #0086b3; ">=</span>strftime(_time,<span style="color: #df5000; ">"%Y-%m-%dT%H:%M:%S.%Q"</span>)&#160;&#160;<span style="color: #0086b3; ">|</span> <span style="color: #a71d5d; ">rename</span> event_message <span style="color: #a71d5d; ">as</span> eventinfo <span style="color: #0086b3; ">|</span> <span style="color: #a71d5d; ">table</span> device whomadethechange eventinfo eventdate sourcetype <span style="color: #0086b3; ">|</span> head <span style="color: #005cc5; ">50</span></code></pre>
                                        </div>
                                    </div>
                                    <h3>Create the Policy Template</h3>
                                    <p>Follow the steps to create a policy template.</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>From the Settings menu, select <b>Policy Templates</b>. </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Click <b>Actions</b> and <b>Add a Blank Policy Template</b>.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/AddSplunkPolicy.png" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Name it <b>Splunk</b>, set the Usage column to <b>Tracking</b>, and click <b>update</b>.</p>
                                    <p>
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/Tracking.png" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Click the <b>tracking</b> button on the new Splunk policy and then scroll right to the Splunk Search Queries tab.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/SPLQuery.png" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Click the <b>tick box</b> to add a query and then click <b>Add a Splunk Query</b>. </p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/SPLQueryConfiguration.png" />
                                    </p>
                                    <p>Paste the query, give it a description and click Update. The query will now be listed in the policy.</p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>Ensure the desired polling frequency is set.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/TemplateComplete.png" />
                                    </p>
                                    <h3>Devices and Groups</h3>
                                    <p>Follow the steps to add a group.</p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span>From the Settings menu, select <b>Groups</b> and click <b>Add</b> to add a new group called Splunk Tracker.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Select <b>Splunk Tracker</b> in the group tree; then click the <b>Policy Templates</b> tab and click <b>Add an Existing Template</b>.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Add the Splunk policy template to the Splunk Tracker group. </p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/Group2.png" />
                                    </p>
                                    <p>Any device in this group of the type Splunk will execute the Splunk tracking policy created above.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/Group.png" />
                                    </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Ensure the Splunk Tracker group is selected and click <b>Add</b> to add a sub group to the Splunk Tracker group named Splunk devices. This group will hold the proxied devices that Splunk events will be matched to.</p>
                                    <h3>Devices</h3>
                                    <p>To direct the SPL query in the Splunk tracking policy to the target instance of Splunk, a proxied device must be created with the connection details. </p>
                                    <p>Follow the steps to manually create a proxied device to represent the target instance of Splunk.</p>
                                    <p>
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/ManualDeviceCreation.png" />
                                    </p>
                                    <p class="Step-Reset" data-mc-autonum="&lt;b&gt;Step 1 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 1 – </b></span></span> Select a device to be a proxy device and click <b>Add Proxied Device</b>. The agent on the same machine as the Hub is often a good choice for the proxy if it can communicate with the Splunk instance.</p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 2 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 2 – </b></span></span>Name the proxy device <b>Splunk</b>. </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 3 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 3 – </b></span></span>Enter the URL for the Splunk instance in the Host field. </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 4 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 4 – </b></span></span>Set the device type to <b>Splunk</b>. </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 5 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 5 – </b></span></span>Select the Splunk credentials. </p>
                                    <p class="Step" data-mc-autonum="&lt;b&gt;Step 6 – &lt;/b&gt;"><span class="autonumber"><span class="Step"><b>Step 6 – </b></span></span>Add the Splunk Tracker group to the Groups field.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/AddSplunkDevice.png" />
                                    </p>
                                    <p class="Note-1" data-mc-autonum="&lt;b&gt;NOTE: &lt;/b&gt;"><span class="autonumber"><span class="Note"><b>NOTE: </b></span></span>Change events coming into Change Tracker (from Splunk or any agentless monitoring) must match a device in Change Tracker. Events without a matching device will be ignored</p>
                                    <p>This isn't a problem with agent based monitoring as the agent registers it's device on first contact with the Hub. All types of agentless monitoring require devices to be created in Change Tracker. </p>
                                    <p>Devices can be created manually or via device discovery. Device discovery is only available when the Sync Service is configured to integrate with ServiceNow. Both will result in proxied devices registered to a proxy device with an agent.</p>
                                    <p>To discover devices to match change events from Splunk, see the <a href="../ITSM/SyncServiceAdmin.htm#Configur" target="_parent" title="Configure Device Discovery" alt="Configure Device Discovery" class="MCXref xref">Configure Device Discovery</a> section in <a href="../ITSM/SyncServiceAdmin.htm" target="_parent" title="Sync Service Administration" class="MCXref xref">Sync Service Administration</a> topic for additional information.</p>
                                    <p>To manually create proxied devices, select a device to be a proxy device (the Hub's agent is often a good choice here) and click Add Proxied Device.  Ensure the new devices are added to the Splunk Devices group.</p>
                                    <p>If the logs collected are from a custom application it may be desirable to treat the application as a device in Change Tracker instead of it's individual servers. This way change events would belong to the application and not to individual servers. This could be done by manually creating a proxied device named after the application and then ensuring the SPL query uses the same application name for it's Device column.</p>
                                    <h2>Events</h2>
                                    <p>If everything has been configured correctly and communication with the Splunk instance is possible, Splunk logs should start arriving as events. </p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/SplunkEvents.png" />
                                    </p>
                                    <p>In the body of a Splunk event it's possible to see the required firled from the SPL query. Any field in the results other than the required fields is added to the additional info section at the bottom of the event body. This flexible field can list multiple non required fields from the SPL query. This enables full control of what is logged into the events.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/SplunkEventBody.png" />
                                    </p>
                                    <p>Manual runs of the tracking policy can be executed from the Splunk device by clicking Start Tracker Poll.</p>
                                    <p style="text-align: center;">
                                        <img src="../../../Resources/Images/ChangeTracker/Integrations/Splunk/StartTrackerPoll.png" />
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
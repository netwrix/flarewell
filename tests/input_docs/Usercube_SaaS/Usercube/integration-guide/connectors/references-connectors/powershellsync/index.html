<!DOCTYPE html>
<html lang="en-us" class="js csstransforms3d _Skins_HTML5___Side_Navigation" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Home Page|Integration Guide|Connectors|References: Connectors">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../../Resources/TableStyles/Sb Table 1.css" rel="stylesheet" data-mc-stylesheet-type="table" /><title>
              
              PowerShellSync
              </title>
        <link href="../../../../../Resources/Stylesheets/StealthbitsTemplate.css" rel="stylesheet" type="text/css" />
        <script src="../../../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    </head>
    <body class="" data-url="../../../../integration-guide/connectors/references-connectors/powershellsync/">
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" aria-label="title tab bar" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1279px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../../index.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div id="mc-main-content" role="main" data-mc-content-body="True">
                                    <section id="body">
                                        <div id="body-inner">
                                            <h1>
                                                <div>
              
              PowerShellSync
              </div>
                                            </h1>
                                            <p>This connector exports data from an external system via a <a href="https://learn.microsoft.com/en-us/powershell/scripting/overview">PowerShell</a> script.</p>
                                            <p>This page is about <a href="../../references-packages/powershellsync/index.html" target="_parent" class="MCXref xref">
              
              PowerShellSync
              </a>.

</p>
                                            <p style="text-align: center;">
                                                <img src="../../../../../Resources/Images/Packages_powershellsync_V603.png" alt="Package: Custom/PowerShellSync" />
                                            </p>
                                            <h2 id="overview">Overview</h2>
                                            <p>PowerShell is a cross-platform task automation and configuration management framework, consisting of a command-line shell and scripting language. Unlike most shells which accept and return text, PowerShell is built on top of the .NET Common Language Runtime (CLR), and accepts and returns .NET objects. This fundamental change brings entirely new tools and methods for automation.</p>
                                            <p>Data can be synchronized from any managed system by writing a PowerShell script that generates the relevant CSV files for <span class="mc-variable IdentityManager.Product_Stort_Name variable">Identity Manager</span>. The PowerShellSync connector provides all the necessary tools for an easy integration of the script with <span class="mc-variable IdentityManager.Product_Stort_Name variable">Identity Manager</span>'s synchronization mechanisms.</p>
                                            <div class="notices info">
                                                <p>When <span class="mc-variable IdentityManager.Product_Stort_Name variable">Identity Manager</span>&#160;provides a native connector for a given system, for example the Active Directory connector, <span class="mc-variable IdentityManager.Product_Long_Name variable">Netwrix Identity Manager (formerly Usercube)</span>highly recommends using the native connector rather than this PowerShell connector.</p>
                                            </div>
                                            <!-- TODO: add official link -->
                                            <h2 id="prerequisites">Prerequisites</h2>
                                            <p>Implementing this connector requires:</p>
                                            <ul>
                                                <li>making sure that the command <code>powershell.exe</code>, inside the command prompt (<code>cmd.exe</code>), does execute a PowerShell terminal;</li>
                                                <li>knowledge of scripting in <u>PowerShell 5.1</u> or later, <a href="https://docs.microsoft.com/en-us/powershell/scripting/windows-powershell/install/windows-powershell-system-requirements">see here PowerShell's requirements</a>;</li>
                                                <li>making sure that the device hosting the agent has its execution policy properly configured to execute the given PowerShell script;</li>
                                                <li>checking the targeted system's requirements (environment, libraries, etc.), as this connector is meant to connect <span class="mc-variable IdentityManager.Product_Stort_Name variable">Identity Manager</span>&#160;to a PowerShell-compatible system;</li>
                                                <li>writing and testing a PowerShell script (<code>.ps1</code>) according to <span class="mc-variable IdentityManager.Product_Long_Name variable">Netwrix Identity Manager (formerly Usercube)</span>' guidelines below.</li>
                                            </ul>
                                            <h2 id="export">Export</h2>
                                            <p>This connector executes a PowerShell script that generates one or several CSV files. These files are to be used during the synchronization of the data from the managed system targeted by the PowerShellSync connector.</p>
                                            <div class="notices note">
                                                <p>The CSV files must be written to the <code>$OutputPath</code>.</p>
                                            </div>
                                            <div class="notices info">
                                                <p>The export is executed by a job from the UI, or via <code>Usercube-Export-Powershell.exe</code> in the command prompt.</p>
                                            </div>
                                            <h3 id="configuration">Configuration</h3>
                                            <p>This process is configured through a <a href="../../../toolkit/xml-configuration/connectors/connection/index.html" target="_parent" title="Connection" alt="Connection" class="MCXref xref">
              
              Connection
              </a> in the UI and/or the XML configuration, and in the <code>appsettings.agent.json &gt; Connections</code> section:</p><pre class="json" xml:space="preserve"><code><em>appsettings.agent.json</em>
{
  ...
  "Connections": {
    ...
    "<b>&lt;ConnectionIdentifier&gt;</b>": {
      ...
    }
  }
}</code></pre>
                                            <div class="notices note">
                                                <p>The identifier of the connection and thus the name of the subsection must:
<br />- be unique.
<br />- not begin with a digit.
<br />- not contain <code>&lt;</code>, <code>&gt;</code>, <code>:</code>, <code>"</code>, <code>/</code>, <code>\</code>, <code>|</code>, <code>?</code>, <code>*</code> and <code>_</code>.</p>
                                            </div>
                                            <blockquote>
                                                <p>For example:</p><pre class="json" xml:space="preserve"><code><em>appsettings.agent.json</em>
{
  ...
  "Connections": {
    ...
    "PowerShellExport": {
      "PowerShellScriptPath": "C:/UsercubeDemo/Scripts/Export-CSV.ps1",
    }
  }
}</code></pre>
                                            </blockquote>
                                            <h5 id="setting-attributes">Setting attributes</h5>
                                            <table style="mc-table-style: url('../../../../../Resources/TableStyles/Sb Table 1.css');margin-left: auto;margin-right: auto;" class="TableStyle-Sb_Table_1" cellspacing="21">
                                                <col class="TableStyle-Sb_Table_1-Column-Column1" />
                                                <col class="TableStyle-Sb_Table_1-Column-Column1" />
                                                <thead>
                                                    <tr class="TableStyle-Sb_Table_1-Head-Header1">
                                                        <th style="font-size: 11pt;" class="TableStyle-Sb_Table_1-HeadE-Column1-Header1">
                                                            <p>Name</p>
                                                        </th>
                                                        <th style="font-size: 11pt;" class="TableStyle-Sb_Table_1-HeadD-Column1-Header1">
                                                            <p>Details</p>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                        <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyB-Column1-Body1">
                                                            <p>PowerShellScriptPath<br /><span class="requiredAttribute">required</span></p>
                                                        </td>
                                                        <td style="font-size: 11pt;" class="TableStyle-Sb_Table_1-BodyA-Column1-Body1"><strong>Type</strong>
                                                            <br />String<br /><br /><strong>Description</strong><p>Path of the PowerShell script (.ps1) to be executed.</p></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <h3 id="write-a-script">Write a script</h3>
                                            <p><span class="mc-variable IdentityManager.Product_Stort_Name variable">Identity Manager</span>&#160;provides a few variables to be used in the PowerShell script.</p>
                                            <table style="mc-table-style: url('../../../../../Resources/TableStyles/Sb Table 1.css');margin-left: auto;margin-right: auto;" class="TableStyle-Sb_Table_1" cellspacing="21">
                                                <col class="TableStyle-Sb_Table_1-Column-Column1" />
                                                <col class="TableStyle-Sb_Table_1-Column-Column1" />
                                                <thead>
                                                    <tr class="TableStyle-Sb_Table_1-Head-Header1">
                                                        <th class="TableStyle-Sb_Table_1-HeadE-Column1-Header1">
                                                            <p>Name</p>
                                                        </th>
                                                        <th class="TableStyle-Sb_Table_1-HeadD-Column1-Header1">
                                                            <p>Details</p>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="TableStyle-Sb_Table_1-Body-Body1">
                                                        <td class="TableStyle-Sb_Table_1-BodyE-Column1-Body1">
                                                            <p>OutputPath</p>
                                                        </td>
                                                        <td class="TableStyle-Sb_Table_1-BodyD-Column1-Body1"><strong>Type</strong>
                                                            <br />String<br /><br /><strong>Description</strong><p>Prefix of the path of the generated CSV file.<br /><strong>Info:</strong> the synchronization process requires the generated CSV file to be located in a very specific location, with a specific name prefix. Hence the need for this predefined variable.</p><strong>Value</strong><p><a href="../../../network-configuration/agent-configuration/appsettings/index.html#tempfolderpath"><code>&lt;TempFolderPath&gt;</code></a><code>/ExportOutput/&lt;connectionIdentifier&gt;_</code></p><strong>Example</strong><p>In this example, if the temp folder is named <code>Temp</code> and the connection <code>PowerShellExport</code>, then the generated file is: <code>Temp/ExportOutput/PowerShellExport_users.csv</code>.</p><p xml:space="preserve"><code>generateCSV | Export-CSV ($OutputPath + "users.csv")</code></p><p>where <code>generateCSV</code> is a generic PowerShell method that generates CSV files.</p></td>
                                                    </tr>
                                                    <tr class="TableStyle-Sb_Table_1-Body-Body2">
                                                        <td class="TableStyle-Sb_Table_1-BodyB-Column1-Body2">
                                                            <p>IsIncremental</p>
                                                        </td>
                                                        <td class="TableStyle-Sb_Table_1-BodyA-Column1-Body2"><strong>Type</strong>
                                                            <br />Boolean<br /><br /><strong>Description</strong><p>Variable to be used to provide a different behavior for complete and incremental synchronization.</p></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <!-- TODO: add output details -->
                                            <h2 id="fulfill">Fulfill</h2>
                                            <p>There are no fulfill capabilities for this connector.</p>
                                        </div>
                                    </section>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>